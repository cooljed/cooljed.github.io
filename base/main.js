/*! CooljED/Tpb@tQuery v0.2.0 | (c) zhliner@gmail.com 2022.01.19. */
import t,{TplsPool as e,TplrName as n,tplMaps as r,DEBUG as l}from"./tpb/config.js";import{processProxy as o,processExtend as i,customGetter as s,BaseOn as a,BaseBy as u,Tpb as c,obtBuilder as f}from"./tpb/tpb.esm.js";import{HotKey as p,ObjKey as d}from"./tpb/tools/hotkey.js";import{Scripter as h,By as m,Sys as g,Tips as _,Limit as w,On as v,ROOT as y,Local as b,Cmdx as x,Fx as E,Help as T}from"../config.js";import C from"./shortcuts.js";import{Render as N}from"./tpb/tools/render.js";import{Spliter as S,UmpCaller as $,UmpString as A,UmpChars as k}from"./tpb/tools/spliter.js";import{MdLine as O}from"./hlparse/languages/mdline.js";import{Hicolor as R}from"./hlparse/main.js";import{Util as I}from"./tpb/tools/util.js";import{Templater as L}from"./tpb/tools/templater.js";import{Loader as z,TplLoader as U}from"./tpb/tools/tloader.js";
//! $ID: types.js 2020.05.09 Cooljed.Libs $
const M=100,H=101,D=105,P=107,F=200,B=201,j=202,K=203,V=204,W=205,G=206,X=208,q=300,J=301,Y=302,Q=303,Z=304,tt=305,et=306,nt=307,rt=308,lt=309,ot=310,it=311,st=312,at=313,ut=314,ct=315,ft=316,pt=317,dt=318,ht=319,mt=320,gt=321,_t=322,wt=323,vt=324,yt=325,bt=326,xt=327,Et=328,Tt=329,Ct=330,Nt=400,St=401,$t=402,At=403,kt=404,Ot=500,Rt=501,It=502,Lt=503,zt=504,Ut=505,Mt=506,Ht=507,Dt=508,Pt=509,Ft=510,Bt=511,jt=512,Kt=513,Vt=514,Wt=515,Gt=519,Xt=520,qt=521,Jt=522,Yt=523,Qt=524,Zt=525,te=526,ee=601,ne=602,re=603,le=604,oe=605,ie=606,se=610,ae=611,ue=613,ce=614,fe=615,pe=616,de=617,he=618,me=619,ge=620,_e=623,we=624,ve=625,ye=627,be=628,xe=-1,Ee=-2,Te={0:0,[H]:8210,[M]:8210,102:8210,103:8210,104:9234,[D]:9232,106:1040,[P]:8336,108:9234,109:656,110:656,[F]:646,[B]:646,[j]:646,[K]:130,204:22538,[W]:24066,[G]:14,207:6,[X]:270,[q]:8216,[J]:8216,[Y]:8216,[Q]:8216,[Z]:8216,[tt]:8216,[et]:8216,[nt]:8216,[rt]:8216,[lt]:8216,[ot]:8216,[it]:8216,[st]:8216,[at]:8216,[ut]:8216,[ct]:8216,[ft]:8216,[pt]:8216,[dt]:8216,[ht]:8216,[mt]:8216,[gt]:8216,[_t]:8216,[wt]:8216,[vt]:280,[yt]:280,[bt]:1424,[xt]:1296,[Et]:1298,[Tt]:280,[Ct]:1296,[Nt]:40,[St]:40,[$t]:40,[kt]:40,[At]:40,[Ot]:2122,[Rt]:2122,[It]:14,[Lt]:2122,[zt]:6218,[Ut]:14,[Mt]:2122,[Ht]:78,[Dt]:2126,[Pt]:2382,[Ft]:14,[Bt]:14,[jt]:14,[Kt]:10,[Vt]:10,[Wt]:6,517:2,516:70,518:70,[Gt]:6,[Xt]:1030,[qt]:14,[Jt]:6218,[Yt]:6218,[Qt]:1030,[Zt]:1030,[te]:1030,527:7170,600:2146,[ie]:2146,607:3170,609:34,608:34,[se]:2146,[ae]:4194,612:98,[ee]:34,[ne]:34,[re]:34,[le]:34,[oe]:34,[ue]:34,[ce]:34,[fe]:34,[pe]:34,[de]:34,[he]:34,[me]:34,[ge]:34,621:34,622:34,[_e]:34,[we]:34,[ve]:34,626:34,[ye]:290,[be]:160,629:1056,[xe]:13,[Ee]:13},Ce=[M,H,102,103,D,P,108],Ne=[J,Y,tt,et,rt,lt,104,ot,it,st,at,ut,ct,ft,pt,dt,ht,_t,nt,wt],Se=[Q,Z,mt,gt],$e=[109,110,106],Ae=[yt,bt,xt,Tt,Ct,Et],ke=[...Ne,...Se,...$e],Oe=[...Se,...$e,lt],Re=[...Ce,...Ne,...Se,...$e,vt,...Ae],Ie=[_e,we,ce,fe,ye],Le=[Nt,St,$t,At,ce,fe,pe,de,he,me,ge,621,622,_e,we,ve,626,629,ye],ze={0:null,[M]:[0,B,F],[H]:[0,B,F],102:[j,K],103:[207],104:[0,204,W],[D]:[0],106:null,[P]:null,108:[P,103,G],109:null,110:null,[F]:null,[B]:null,[j]:null,[K]:null,204:[0],[W]:[0],[G]:[0,q,...ke],207:[207],[X]:[0],[q]:[0,...ke,P,103],[J]:[0,q,...ke],[Y]:[0,...Oe],[Q]:[0,q,...ke],[Z]:[0,q,...ke],[tt]:[0,Y,...Oe],[et]:[0,q,...ke],[nt]:[0,q,...ke],[rt]:[0,...Oe],[lt]:[0,xe,Ee,mt],[ot]:[0,q,...ke],[it]:[0,q,...ke],[st]:[0,q,...ke],[at]:[0,q,...ke],[ut]:[0,...Oe],[ct]:[0,...Oe],[ft]:[0,...ke],[pt]:[0],[dt]:[0,...Oe,q],[ht]:[0,...Oe],[mt]:[0,q,...ke],[gt]:[0,q,...ke],[_t]:[0,...Oe],[wt]:[0,...Oe],[vt]:[0,ot,it,...Ae,xe,Ee],[yt]:[0,ot,it,...Oe],[bt]:null,[xt]:[0],[Et]:[0,X],[Tt]:[0,ot,it,...Oe],[Ct]:[0],[Nt]:[0,q,...Re,xe,Ee],[St]:[0,q,...Re,xe,Ee],[$t]:[0,q,...Re,xe,Ee],[At]:[0,q,...ke],[kt]:[0,q,...Re,xe,Ee],[Ot]:[0,q,...ke,103,P,Ee],[Rt]:[0,q,...ke,103,P,Ee],[It]:[0,q,...ke,103,P,Ee],[Lt]:[0,q,...ke,103,P,Ee],[zt]:[0,q,...ke,103,P,Ee],[Ut]:[0,q,...ke,103,P,Ee],[Mt]:[0,q,...ke,Ee],[Ht]:[0,q,...ke,Ee],[Dt]:[0,q,...ke,Ee],[Pt]:[0,q],[Bt]:[0,q,...ke,103,P,Ee],[Ft]:[0,Ut,q,...Re],[jt]:[0,q,...Re],[Kt]:[0,q,...Re],[Vt]:[0,q,...Re],[Wt]:[Kt,Vt],516:[Wt],517:[Wt],518:[Wt],[Gt]:[P,103,108],[Xt]:[lt],[qt]:[q],[Jt]:[q],[Yt]:[q],[Qt]:[Lt,ce],[Zt]:[Lt,fe],[te]:[Yt,fe],527:[qt,te],600:[Ot,It],[ie]:[Lt,Nt,...Ie],607:[Jt,Lt,be,527],608:[Lt,fe],609:[Lt,ce],[se]:[Lt,Nt,$t,St,...Ie,de,he],[ae]:[Lt,Nt,$t,St,...Ie,kt],[ce]:[Ft,qt],[fe]:[Ft,qt],[pe]:[Xt],[de]:[Ft,qt,Qt,Zt],[he]:[Ft,qt,Qt,Zt],[me]:[Ft,qt,Zt,te],[ge]:[Bt,jt],621:[Dt,516,517,518],622:[Ht,108,P,103,Gt,Nt,fe,ce],[_e]:[Lt,Nt,...Ie,621],[we]:[Lt,Nt,...Ie,621],[ve]:[Mt,Nt,...Ie,621],626:[lt],[ye]:[Pt,Nt,ce,fe,vt,xt],[be]:null,629:null,[xe]:[0,q],[Ee]:[0,q],[-10]:[Ot,600,ie,607,612,608,609,ae]};t.each(ze,((t,e,n)=>n[e]=t&&new Set(t)));const Ue={612:[se,ae,be,ee],[ee]:[Rt,se,ae,be,ne],[ne]:[Rt,se,ae,be,re],[re]:[Rt,se,ae,be,le],[le]:[Rt,se,ae,be,oe],[oe]:[Rt,se,ae,be,ue],[ue]:[Rt,se,ae,be,ue]};function Me(t){return 0===t}function He(t){return!!(128&Te[t])}function De(t){return!!(256&Te[t])}function Pe(t){return!!(64&Te[t])}function Fe(t){return!!(512&Te[t])}function Be(t){return!!(2048&Te[t])}function je(t){return!!(4096&Te[t])}function Ke(t){return!!(2048&Te[t]&&4096&Te[t])}function Ve(t){return!!(1024&Te[t])}function We(t){return!!(32&Te[t])}function Ge(t){return!!(16&Te[t])}function Xe(t){return!!(8192&Te[t])}function qe(t){return!!(8&Te[t])}function Je(t){return!!(4&Te[t])}function Ye(t){return!!(16384&Te[t])}function Qe(t){return!!(1&Te[t])}function Ze(t){let e=ze[t];return!!e&&1===e.size&&e.has(0)}function tn(e){let n=t.not(t.children(e),"h2,header,footer,hr"),r=t.filter(n,"section");return n.length?r.length?n.length===r.length?2:3:1:0}function en(t,e){switch(tn(t)){case 1:return e.slice(0,-1).concat(Le);case 2:return e}return e.concat(Le)}var nn=Object.freeze({__proto__:null,$TEXT:0,AUDIO:M,VIDEO:H,PICTURE:102,SVG:103,RUBY:104,METER:D,SPACE:106,IMG:P,IMAGE:108,BR:109,WBR:110,TRACK:F,SOURCE1:B,SOURCE2:j,PIMG:K,RT:204,RP:W,EXPLAIN:G,SVGITEM:207,OPTION:X,A:q,Q:J,ABBR:Y,DEL:Q,INS:Z,DFN:tt,BDO:et,BDI:nt,TIME:rt,CODE:lt,STRONG:ot,EM:it,CITE:st,SMALL:at,SUB:ut,SUP:ct,MARK:ft,ORZ:pt,SAMP:dt,KBD:ht,S:mt,U:gt,VAR:_t,CRUMB:wt,LABEL:vt,BUTTON:yt,INPUT:bt,TEXTAREA:xt,SELECT:Et,OUTPUT:Tt,PROGRESS:Ct,P:Nt,NOTE:St,TIPS:$t,PRE:At,ADDRESS:kt,H1:Ot,H2:Rt,H3:It,H4:Lt,H5:zt,H6:Ut,SUMMARY:Mt,FIGCAPTION:Ht,CAPTION:Dt,LEGEND:Pt,LI:Ft,DT:Bt,DD:jt,TH:Kt,TD:Vt,TR:Wt,THEAD:516,TBODY:517,TFOOT:518,FCONA:Gt,CODELI:Xt,ALI:qt,AH4:Jt,AH5:Yt,XH5LI:Qt,XOLH5LI:Zt,XOLAH5LI:te,TOCCASCADE:527,HGROUP:600,S1:ee,S2:ne,S3:re,S4:le,S5:oe,ABSTRACT:ie,TOC:607,REFERENCE:608,SEEALSO:609,HEADER:se,FOOTER:ae,ARTICLE:612,SECTION:ue,UL:ce,OL:fe,CODELIST:pe,ULX:de,OLX:he,CASCADE:me,DL:ge,TABLE:621,FIGURE:622,BLOCKQUOTE:_e,ASIDE:we,DETAILS:ve,CODEBLOCK:626,FIELDSET:ye,HR:be,BLANK:629,B:xe,I:Ee,MAIN:-10,ChildTypes:ze,ChildTypesX:Ue,isText:Me,isEmpty:He,isFormCtrl:De,isSingle:Pe,isCovert:Fe,isFixed1:Be,isFixed2:je,isFixed:Ke,isFixedAny:function(t){return!!(2048&Te[t]||4096&Te[t])},isSealed:Ve,isBlocks:We,isInlines:Ge,isRangeX:Xe,isContent:qe,isStruct:function(t){return!!(2&Te[t])},isStructX:Je,isKeepline:Ye,isSpecial:Qe,onlyText:Ze,sectionState:tn,sectionSubs:en});
//! $ID: base.js 2020.05.10 Cooljed.Libs $
const rn=Symbol("type-value"),ln=new WeakMap,on=new Set(["abstract","toc","seealso","reference","s1","s2","s3","s4","s5","codelist","ulx","olx","cascade","codeblock","note","tips","blank","orz","space","explain","image","crumb"]),sn=new Set([516,518,Ot,Mt,ie,607,527,608,612,G,K]),an={LI(e,n){let r=e.firstElementChild;return e.childElementCount<=1?n&&function(e,n){if(!e||t.siblingNodes(e,!1,!0).length)return;if("A"===e.tagName)return qt;return"CODE"===e.tagName&&"OL"===n.tagName&&xn(n)===pe&&Xt}(r,n)||Ft:2===e.childElementCount&&"H5"===r.tagName?vn(r):Ft},H5:t=>yn(t,"A")?Yt:zt,IMG:(t,e)=>102===(e&&xn(e))?K:P,SOURCE(t,e){if(!e)throw new Error(`<source>'s parent is ${e}`);return"PICTURE"===e.tagName?j:B},A:(t,e)=>e&&622===xn(e)?Gt:q},un={LI:[{type:Xt,check:t=>yn(t,"CODE")},{type:qt,check:t=>yn(t,"A")},{type:te,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&vn(e)===te}},{type:Zt,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&vn(e)===Zt}},{type:Qt,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&vn(e)===Qt}},{type:Ft,check:()=>!0}],SPAN:[{type:106,check:t=>0===t.childNodes.length},{type:108,check:()=>!0},{type:wt,check:()=>!0}],A:[{type:Gt,check:t=>yn(t,"IMG")||yn(t,"svg")},{type:q,check:()=>!0}],IMG:[K,P],SOURCE:[B,j]},cn=Symbol("normal-list"),fn=Symbol("small-block"),pn=Symbol("blockcode-item"),dn={[se]:fn,[ae]:fn,[_e]:fn,[we]:fn,[ve]:fn,[Xt]:pn,626:pn,[ce]:cn,[fe]:cn,[de]:cn,[he]:cn,[me]:cn};function hn(t,e){if(3===t.nodeType)return 0;if("http://www.w3.org/2000/svg"===t.namespaceURI)return"svg"===t.tagName?103:207;let n=an[t.tagName];return n?n(t,e):function(t){let e=+nn[t];return isNaN(e)?null:e}(function(t){let e=t.getAttribute("role");return(on.has(e)?e:t.tagName).toUpperCase()}(t))}function mn(t,e){if(t===e)return null;let n=xn(t);return Ge(n)?mn(t.parentElement):qe(n)?t:gn(t,e)}function gn(t,e){return t===e?null:function(t){let e=xn(t);return We(e)||Ge(e)}(t)?t:gn(t.parentElement)}function _n(e,n){return 3===e.nodeType||t.find("*",e,!0).every((t=>n.has(xn(t))))}function wn(e){return 3==e.nodeType?null:kn(e)?e:t.children(e).map((t=>wn(t))).flat()}function vn(t){switch(t.nextElementSibling.tagName){case"UL":return Qt;case"OL":return yn(t,"A")?te:Zt}return Ft}function yn(e,n){let r=e.firstElementChild;return 1===e.childElementCount&&!t.siblingNodes(r,!1,!0).length&&r.tagName===n}function bn(t,e){let n="inlEntity";De(t)?n="inlCtrl":qe(t)&&(n="inlText"),e.get(n).push(t)}function xn(t,e=t.parentElement){if(3===t.nodeType)return 0;if(1!==t.nodeType)return null;let n=t[rn];return void 0===n&&En(t,n=hn(t,e)),n}function En(t,e){return Reflect.defineProperty(t,rn,{value:e,enumerable:!1,configurable:!0}),t}function Tn(t,e){let n=Cn(t);return!!n&&n.has(e)}function Cn(t){if("number"==typeof t)return ze[t];let e=xn(t),n=Ue[e];return n?new Set(en(t,n)):ze[e]||""}function Nn(e){let n=t.clone(e,!0,!0,!0),r=t.find("*",e);return t.find("*",n).forEach(((t,e)=>En(t,xn(r[e])))),En(n,xn(e))}function Sn(e){return An(e)?[e]:t.contents(e).map((t=>1===t.nodeType?Sn(t):t)).flat()}function $n(t){return Fe(xn(t))}function An(t){return Ge(xn(t))}function kn(t){return qe(xn(t))||0===t.childElementCount&&t.innerText&&t.innerText.trim()}function On(t){return Be(xn(t))}function Rn(t){return je(xn(t))}function In(t){return Ke(xn(t))}function Ln(t){let e=xn(t);return e>=ee&&e<=oe}function zn(t){return sn.has(xn(t))}function Un(e,n){return n?ln.set(e,n)&&null:(n=ln.get(e)||ln.set(e,new t.Table(e)).get(e)).checkCols()}function Mn(e){let n=wn(e);return n?t.isArray(n)?n:[n]:[]}function Hn(t,e){return An(t)?mn(t.parentElement,e):gn(t.parentElement,e)}function Dn(e){let n=t.attr(e,"role");return n?+n.substring(1):e.parentElement?t.parentsUntil(e,"section[role=s5]").length+6:6}function Pn(e,n){let r=(n+=Dn(e))<6?`s${n}`:null;if(0===n)return!1;Reflect.deleteProperty(t.attr(e,"role",r),rn)}function Fn(t,e){let n=dn[xn(t)];if(void 0===n)return function(t,e){let n=xn(t);for(const t of e)if(n!==xn(t))return t;return null}(t,e);for(const t of e)if(n!==dn[xn(t)])return t;return null}function Bn(t,e){let n=un[t.tagName];return n?n.some((n=>function(t,e,n){return"number"==typeof n?e.has(n)&&!!En(t,n):e.has(n.type)&&n.check(t)&&!!En(t,n.type)}(t,e,n))):e.has(xn(t))}
//! $ID: common.js 2019.09.07 Cooljed.Libs $
const jn=new S(";",new $,new A),Kn=new O;class Vn extends Set{constructor(t){super(),this._cls=t,this._n2=null,this._p2=null}add(e){return super.add(t.addClass(e,this._cls)),e}delete(e){return super.delete(t.removeClass(e,this._cls)),e===this._n2&&(this._n2=null),e===this._p2&&(this._p2=null),e}clear(){return this.forEach((e=>t.removeClass(e,this._cls))),super.clear(),this._n2=null,this._p2=null,this}index(t){return[...this].indexOf(t)}first(){for(const t of this)return t}next(t){let e=[...this],n=this._next(e,t)||this._n2||e[0];return this._n2=this._next(e,n),this._p2=this._prev(e,n),n}prev(t){let e=[...this],n=this._prev(e,t)||this._p2||e[e.length-1];return this._p2=this._prev(e,n),this._n2=this._next(e,n),n}pushes(t){return t.forEach((t=>this.add(t))),this}removes(t){return t.forEach((t=>this.delete(t))),this}cruise(t){if(void 0===t)return[this._p2,this._n2];[this._p2,this._n2]=t||[null,null]}_next(t,e){let n=t.indexOf(e);return n<0?null:t[n+1]}_prev(t,e){let n=t.indexOf(e);return n<0?null:t[n-1]}}class Wn extends Map{add(t,e){super.set(e,t)}top(){let t;for(t of this);return t?t[1]:null}}class Gn{constructor(t=""){this._fix=t}get(t){return window.localStorage.getItem(this._fix+t)}set(t,e){return window.localStorage.setItem(this._fix+t,e),this}del(t){window.localStorage.removeItem(this._fix+t)}has(t){return!!window.localStorage.getItem(this._fix+t)}clear(){window.localStorage.clear()}keys(){let t=Object.keys(window.localStorage),e=this._fix.length;return t.filter((t=>t.startsWith(this._fix))).map((t=>t.substring(e)))}}class Xn{constructor(t,e){this._max=t,this._buf=[],this._idx=-1,this._hist=e}push(...t){if(!t.length)return;return this._buf.length=++this._idx,this._buf.push(t)-this._max>0&&this._shift()}pop(){let t=this._buf.pop();this._idx--,t.slice().reverse().forEach((t=>t.undo()))}undo(){if(this._idx<0)return Zn("[undo] overflow.");let t=this._buf[this._idx];this._confirm(t)&&(this._idx--,t.slice().reverse().forEach((t=>t.undo())))}redo(){if(this._idx>=this._buf.length-1)return Zn("[redo] overflow.");this._buf[++this._idx].forEach((t=>t.redo()))}clear(){this._buf.length=0,this._idx=-1,this._hist.clear()}canUndo(){return this._idx>=0}canRedo(){return this._idx<this._buf.length-1}_confirm(t){let e=!0;for(const n of t)if(n.warn&&n.warn()&&(e=window.confirm(n.warn()),!e))break;return e}_shift(){let t=this._buf.shift();this._idx--,t.forEach((t=>t.count&&this._hist.prune(t.count)))}}class qn{constructor(t,e){this._data=t,this._size=e,this._idx=0}next(){let t=this.pages()-1;return this._idx<t?this.page(this._idx+1):null}prev(){return this._idx>0?this.page(this._idx-1):null}first(){return this.page(0)}last(){return this.page(this.pages()-1)}page(t){let e=t*this._size;return this._idx=t,this._data.slice(e,e+this._size)}index(t){if(void 0===t)return this._idx;this._idx=t}reset(t){return this._idx=0,this._data=t,this}pages(){return Math.ceil(this._data.length/this._size)}}class Jn{constructor(t){this._tpl=t,this._pool=[]}page(t,e){return this._pool[t]||this._render(t,this._clone(this._tpl),e)}reset(){return this._pool.length=0,this}_render(t,e,n){return this._pool[t]=N.update(e,n)}_clone(e){return N.clone(e,t.clone(e,!0,!0,!0))}}class Yn extends Set{constructor(t){super(),this._make=t}pick(...t){return this._pick()||this._make(...t)}_pick(){let t;for(t of this)break;return void 0!==t&&this.delete(t),t}}const Qn=new Yn(h);function Zn(t,e){window.console.warn(t,e||"")}function tr(e,n,r,l){let o=e.tagName.toLowerCase(),i=`<${o}${function(t,e,n){let r="",l=new Map([["on"],["by"],["to"]]);for(let e=0;e<t.length;e++){let n=t[e];l.has(n.name)?l.set(n.name,n.value):r+=` ${n.name}`+(""===n.value?"":`="${er(n.value)}"`)}return r+function(t,e,n){let r=[];n=`${n}${e}`;for(const[l,o]of t)o&&r.push(`${l}="${nr(o,e,n)}"`);return r.length?`\n${n}`+r.join(`\n${n}`):""}(l,e,n)}(e.attributes,r,l)}`,s="";if(function(t){return He(xn(t))}(e))return i+" />";i+=">";for(const t of e.childNodes)s+=sr(t,n,r,l+r);return i+s+function(e,n){let r=xn(e);return 3===e.nodeType||Ge(r)||qe(r)||function(e){let n=t.contents(e,-1,!1,!0);return!n||3===n.nodeType||An(n)}(e)?"":"\n"+n}(e,l)+`</${o}>`}function er(t){return t.replace(/"/g,"&quot;")}function nr(t,e,n){return jn.reset(),[...jn.split(t)].map((t=>er(t.trim()))).join(`;\n${n}${e}`)}function rr(t){let e=Qn.pick();return new Promise((n=>{e.onmessage=t=>{if(e.onmessage=null,Qn.add(e),t.data.error)throw t.data.error;n(t.data.result)},e.postMessage(`return ${t}`)}))}function lr(e,n=1){let r=t.prevNodes(e,!1,!0),l=0;for(;l<r.length;l++){let t=r[l];if(--n<0||On(t))break}return r[l-1]||null}function or(e,n=1){let r=t.nextNodes(e,!1,!0),l=0;for(;l<r.length;l++){let t=r[l];if(--n<0||Rn(t))break}return r[l-1]||null}function ir(e,n){let r=n.parentNode,l=n.previousSibling;return t.replace(e,n),l?t.after(l,e):t.prepend(r,e)}function sr(e,n,r,l=""){let o=e.nodeType,i=function(t,e){let n=xn(t);return 3===t.nodeType||1===t.nodeType&&(Ge(n)||Ye(n))?"":"\n"+e}(e,l);return 1===o?i+(function(e){let n=e.nodeName;return"CODE"==n||"PRE"==n?t.prop(e,"outerHTML"):""}(e)||tr(e,n,r,l)):3===o?e.textContent.trim()&&t.html(n?function(t){let e=t.textContent.replace(/\s+/g," ");return t.nextSibling||(e=e.trimEnd()),t.previousSibling||(e=e.trimStart()),e}(e):e.textContent):8===o?i+`\x3c!--${e.data}--\x3e`:e.outerHTML||e+""}function ar(t){return Kn.parse(t).map((t=>{return e=t.type,n=t.text,e?`<${e}>${n}</${e}>`:n;var e,n})).join("")}function ur(e){let n=[];for(const t of e.childNodes){let e=t.nodeType;3===e||"svg"===t.tagName?n.push(t):1===e&&n.push(ur(t))}return n.length&&t.fill(e,n),function(t){let e=xn(t);return null!==e&&(!!Ge(e)||!!Qe(e)&&!!t.parentElement&&Tn(t.parentElement,e))}(e)?e:e.textContent}
//! $ID: coding.js 2020.02.07 Cooljed.Libs $
const cr=new Set("ೠൕ൘൙൚൛൜൝൞ൟൠ൧൨൩൪൫൬൭൮൯൰൱൲൳൴൵൶൷൸൹ൺൻർൽൾൿᳩᳪᳫ⁇※‱℃".split(""));function fr(t){let e=t.indexOf("\t");return e<0?[t]:[t.substring(0,e),t.substring(e+1)||!0]}function pr(t,e,n){let r=t.innerText||t.textContent,l=r.lastIndexOf(n,e-1);return l<0?[r.substring(0,e)]:[r.substring(l+1,e),!0]}function dr(t,e,n){let r=t.innerText||t.textContent,l=r.indexOf(n,e);return l<0?[r]:[r.substring(e,l),!0]}function hr(t,e,n){let r=[];for(;t;){let[l,o]=pr(t,e,n);if(r.push(l),e=1/0,o)break;t=t.previousSibling}return[r.reverse().join(""),!!t]}function mr(t,e,n){let r=[];for(;t;){let[l,o]=dr(t,e,n);if(r.push(l),e=0,o)break;t=t.nextSibling}return[r.join(""),!!t]}function gr(t,e){let n=0;for(;n<e&&/[ \t]/.test(t[n]);n++);return n}function _r(t){let e=0;for(const n of t)e+="\t"!==n?n.codePointAt(0)>=8527||cr.has(n)?2:1:8-e%8;return e}function wr(e,n,r){let l=e.startContainer,o=e.startOffset;return l===r&&(l=t.contents(l,o)),n?hr(l,o,"\n")[0]:!1===n?mr(l,o,"\n")[0]:hr(l,o,"\n")[0]+mr(l,o,"\n")[0]}function vr(e,n,r){return r>0&&(e=e.map((t=>function(t,e=4){let n=[],r="",l=t;for(;l;)[r,l]=fr(l),l&&(r+=" ".repeat(e-_r(r)%e),!0===l&&(l=null)),n.push(r);return n.join("")}(t,r)))),e=e.join("\n"),n?new R(e,n).effect():[{text:t.html(e)}]}
//! $ID: create.js 2019.09.07 Cooljed.Libs $
const yr={[M]:"audio",[H]:"video",102:"picture",103:"svg",104:"ruby",[D]:"meter",106:"span\\space",[P]:"img",108:"span\\image",109:"br",110:"wbr",207:null,[F]:"track",[B]:"source",[j]:"source",[K]:"img",204:"rt",[W]:"rp",[Gt]:"a",[G]:"i\\explain",[X]:"option",[q]:"a",[ot]:"strong",[it]:"em",[J]:"q",[Y]:"abbr",[st]:"cite",[rt]:"time",[at]:"small",[Q]:"del",[Z]:"ins",[ut]:"sub",[ct]:"sup",[ft]:"mark",[lt]:"code",[pt]:"code\\orz",[tt]:"dfn",[dt]:"samp",[ht]:"kbd",[mt]:"s",[gt]:"u",[_t]:"var",[et]:"bdo",[nt]:"bdi",[wt]:"span\\crumb",[vt]:"label",[yt]:"button",[bt]:"input",[xt]:"textarea",[Et]:"select",[Tt]:"output",[Ct]:"progress",[Nt]:"p",[St]:"p\\note",[$t]:"p\\tips",[kt]:"address",[At]:"pre",[Ot]:"h1",[Rt]:"h2",[It]:"h3",[Lt]:"h4",[zt]:"h5",[Ut]:"h6",[Mt]:"summary",[Ht]:"figcaption",[Dt]:"caption",[Pt]:"legend",[Ft]:"li",[Bt]:"dt",[jt]:"dd",[Wt]:"tr",[Kt]:"th",[Vt]:"td",517:"tbody",516:"thead",518:"tfoot",[Xt]:"li",[qt]:"li",[Jt]:"h4",[Yt]:"h5",[Qt]:"li",[Zt]:"li",[te]:"li",527:"ol\\cascade",600:"hgroup",[ie]:"header\\abstract",607:"nav\\toc",608:"nav\\reference",609:"aside\\seealso",[se]:"header",[ae]:"footer",612:"article",[ee]:"section\\s1",[ne]:"section\\s2",[re]:"section\\s3",[le]:"section\\s4",[oe]:"section\\s5",[ue]:"section",[ce]:"ul",[fe]:"ol",[pe]:"ol\\codelist",[de]:"ul\\ulx",[he]:"ol\\olx",[me]:"ol\\cascade",[ge]:"dl",621:"table",622:"figure",[_e]:"blockquote",[we]:"aside",[ve]:"details",626:"pre\\codeblock",[ye]:"fieldset",[be]:"hr",629:"div\\blank",[xe]:"b",[Ee]:"i"},br={[M]:function(){return t.elem("audio","Sorry, your browser doesn't support embedded audios.")},[H]:function(){return t.elem("video","Sorry, your browser doesn't support embedded videos.")},103:function(){return t.svg()},207:function(){return t.fragment("","svg")}},xr={103:function(t,e,n,r){return Vr(null,Dr(t,e,r),!0)},207:function(t,e,n,r){return Vr(null,Dr(t,e,r),!0)},108:function(e,n,{explain:r,fix:l},o){let[i,s]=Or(e,n,o,(()=>Gr(P)));return"string"==typeof r&&(r=function(e,n){let r=n;t.isArray(n)||(r=[n]);if(r.some((t=>!Tn(e,xn(t)))))return null;return t.append(e,n)}(n,Jr(G,{fix:l},r))),Vr(r,i,s)},104:function(e,n,{rt:r,rpl:l,rpr:o},i){return t.append(n,function(e,n,r,l){let o=[t.Text(l)];n&&o.push(Gr(W,e||g.rpLeft),Gr(V,n),Gr(W,r||g.rpRight));return o}(l,r,o,Mr(i))),Vr(null,n,!0)},[lt]:function(e,n,r,l){return l&&(l="string"==typeof l?t.fragment(l,!1):function(e){let n=Cn(lt);return t.isArray(e)?e.every((t=>_n(t,n))):_n(e,n)}(l)?l:Mr(l),t.append(n,l)),Vr(null,n,!0)},[Wt]:function(e,n,{tsec:r},l){let o=t(n.cells);return 0===o.length&&(o=t(function(e,n){let r=Un((n=n||e.parentElement).parentElement);return t.append(e,r.newTR("THEAD"===n.tagName).children)}(n,r))),l&&l.nodeType?(o.append(Mn(l).map((e=>t.contents(e)))),Vr(null,o,!0)):Vr(null,o)},517:function(t,e,n,r){let{th0:l,head:o,foot:i}=n,s=Un(e.parentElement||n.table),[a,u]=Ir(t,s,e,r);return l&&s.rows()>0&&s.insertColumn(s.newColumn(!0),0),o&&function(t,e,n){Ar(t,kr(t,e,!0),n)}(s,o,s.head()),i&&function(t,e,n){Ar(t,kr(t,e),n)}(s,i,s.foot()),Fr(n,"th0","head","foot"),Vr(null,a,u)},516:function(t,e,n,r){let[l,o]=Ir(t,Un(e.parentElement||n.table),e,r,!0);return Vr(null,l,o)},518:function(t,e,n,r){let[l,o]=Ir(t,Un(e.parentElement||n.table),e,r);return Vr(null,l,o)},[Qt]:function(e,n,{h5:r},l){if(!l)return Vr(null,l,!0);let o=t.empty(n),[i,s]=Or(e,n,l,(()=>Gr(ce)));return Vr(Sr(n,zt,r||o),i,s)},[Zt]:function(e,n,{h5:r},l){let o=t.empty(n),[i,s]=Or(e,n,l,(()=>Gr(fe)));return Vr(Sr(n,zt,r||o),i,s)},[te]:function(t,e,{h5a:n},r){let[l,o]=Or(t,e,r,(()=>Gr(fe)));return Vr(n&&Sr(e,Yt,n),l,o)},527:function(e,n,r,l){let o=t.children(l,"section");return Vr(null,t.append(n,Ur(o)),!0)},[Gt]:function(t,e,n,r){let[l,o]=Or(t,e,r,(()=>Gr(P)));return Vr(null,l,o)},600:function(t,e,n,r){let{h1:l}=n,[o,i]=Or(t,e,r,(()=>Gr(It)));return Fr(n,"h1"),Vr(l&&Sr(e,Ot,l),o,i)},607:function(e,n,{h4a:r},l){let[o,i]=Or(e,n,l,(()=>Gr(527)));return r&&t.prepend(n,Gr(be)),Vr(r&&Sr(n,Jt,r),o,i)},608:function(t,e,{h4:n},r){let[l,o]=Or(t,e,r,(()=>Gr(fe)));return Vr(n&&Sr(e,Lt,n),l,o)},609:function(t,e,{h4:n},r){let[l,o]=Or(t,e,r,(()=>Gr(ce)));return Vr(n&&Sr(e,Lt,n),l,o)},612:function(t,e,n,r){let{header:l}=n,[o]=Or(t,e,r,zr(t,e,r));return Fr(n,"header"),Vr(l&&$r(e,l),o,!0)},[pe]:function(t,e,n,r){let[l,o]=Or(t,e,r,(()=>Gr(Xt)));return Vr(null,l,o)},626:function(t,e,n,r){let[l,o]=Or(t,e,r,(()=>Gr(lt)));return Vr(null,l,o)},[ye]:function(t,e,{legend:n},r){let[l,o]=Or(t,e,r,(()=>Gr(Nt)));return Vr(n&&Sr(e,Pt,n),l,o)},[ge]:function(t,e,n,r){let{dt:l}=n,[o,i]=Or(t,e,r,(()=>Gr(jt)));return Fr(n,"dt"),Vr(l&&Rr(o||t,e,Gr(Bt,l)),o,i)},621:function(t,e,n,r){let l,o=Un(e),i=[];return function(t,e,n){if(!e)return t.caption(null);n.push(t.caption(e))}(o,n.caption,i),function(t,e){null===e&&t.head(null);e&&t.head(!0)}(o,n.head),function(t,e){null===e&&t.foot(null);e&&t.foot(!0)}(o,n.foot),r&&"TBODY"===r.tagName&&(l=o.bodies(0,r)),Fr(n,"caption"),Vr(i,l||o.body(!0),!!l)},622:function(t,e,n,r){let{figcaption:l}=n,[o,i]=Or(t,e,r,(()=>Gr(108)));return Fr(n,"figcaption"),Vr(l&&Sr(e,Ht,l),o,i)},[ve]:function(t,e,n,r){let{summary:l}=n,[o,i]=Or(t,e,r,(()=>Gr(Nt)));return Fr(n,"summary"),Vr(l&&Sr(e,Mt,l),o,i)},102:function(e,n,r,l){return l&&("IMG"===l.tagName&&En(l,K),Tn(n,xn(l))&&t.append(n,l)),Vr(null,n,!0)}};[M,H].forEach((function(e){xr[e]=function(e,n,r,l){return l&&Tn(n,xn(l))&&t.append(n,l),Vr(null,n,!0)}})),[[Xt,lt],[qt,q],[Jt,q],[Yt,q]].forEach((function(t){xr[t[0]]=function(e,n,r,l){if(n.childElementCount>0)return Vr(null,n.firstElementChild);let[o,i]=Or(null,n,l,(()=>Gr(t[1])));return Vr(null,o,i)}})),[ie,se,ae,_e,we].forEach((function(t){xr[t]=function(t,e,n,r){let{h4:l}=n,[o,i]=Or(t,e,r,(()=>Gr(Nt)));return Fr(n,"h4"),Vr(l&&Sr(e,Lt,l),o,i)}})),[ce,fe,de,he,me].forEach((function(t){xr[t]=function(t,e,n,r){let[l,o]=Or(t,e,r,(()=>Gr(Ft)));return Vr(null,l,o)}})),[ee,ne,re,le,oe,ue].forEach((function(t){xr[t]=function(t,e,n,r){let{h2:l,header:o}=n,i=[l&&Sr(e,Rt,l),o&&$r(e,o)],[s]=Or(t,e,r,zr(t,e,r));return Fr(n,"h2","header"),Vr(i.filter((t=>t)),s,!0)}})),[D,G,q,J,Y,Q,Z,tt,et,nt,rt,ot,it,st,at,ut,ct,ft,pt,dt,ht,mt,gt,_t,wt,vt,yt,xt,Tt,X,xe,Ee,Nt,St,$t,At,kt,Ot,Rt,It,Lt,zt,Ut,Mt,Ht,Dt,Pt,Ft,Bt,jt,Kt,Vt].forEach((function(e){xr[e]=function(e,n,r,l){return l=t.isArray(l)?t.map(l,(t=>Pr(n,t))).flat():Pr(n,l),Rr(e,n,l),Vr(null,l,!0)}}));const Er={103:function(e,n){return t.attribute(e,n)},[rt]:function(e,{date:n,time:r}){return t.attr(e,"datetime",Hr(n,r))},[Q]:function(e,{date:n,time:r,cite:l}){return t.attribute(e,"datetime cite",[Hr(n,r),l||null])},[Z]:function(e,{date:n,time:r,cite:l}){return t.attribute(e,"datetime cite",[Hr(n,r),l||null])},106:function(e,{width:n}){return n&&t.css(e,"width",n),e},[be]:function(e,{role:n,thick:r,length:l,space:o}){return n&&t.attr(e,"role",n),t.cssSets(e,"borderWidth width height",[r,l,o])},621:function(e,{cols:n,border:r}){let l=new t.Table(e,n);return r&&t.attr(e,"border",r),Un(e,l)||e}};[[M,["src","autoplay","loop","controls"]],[H,["src","autoplay","loop","controls","poster","width","height"]],[P,["src","alt","width","height"]],[K,["src","alt","width","height"]],[B,["src","type"]],[j,["srcset","media"]],[F,["kind","src","srclang","label","default"]],[D,["value","max","min","high","low","optimum"]],[Ft,["value"]],[Xt,["value"]],[qt,["value"]],[Qt,["value"]],[Zt,["value"]],[te,["value"]],[_e,["cite"]],[ve,["open"]],[ye,["id","name"]],[q,["href","target","title"]],[Gt,["href","target","title"]],[J,["cite"]],[Y,["title"]],[tt,["title"]],[et,["dir"]],[yt,["name","type"]],[bt,["name","type","value","max","min","checked"]],[xt,["name","rows","cols"]],[Et,["name","size"]],[Tt,["name","id"]],[Ct,["name","max","value"]],[X,["value"]],[pe,["lang:-lang","start"]],[lt,["lang:-lang"]],[G,["fix:-pba"]]].forEach((function(e){Er[e[0]]=(n,r)=>t.attribute(n,function(t,e){let n={};for(const r of e){let[e,l]=r.split(":");void 0!==t[e]&&(n[l||e]=t[e])}return n}(r,e[1]))}));const Tr={[J]:function(e,n={}){return n.cite=t.attr(e,"cite"),[n,t.Text(e)]},[Y]:Br,[Q]:jr,[Z]:jr,[tt]:Br,[et]:function(e,n={}){return n.dir=t.attr(e,"dir"),[n,t.Text(e)]},[rt]:jr};[q,lt,ot,it,st,at,ut,ct,ft,pt,dt,ht,mt,gt,_t,nt,wt,xe,Ee].forEach((function(e){Tr[e]=(e,n)=>[n||{},t.Text(e)]}));const Cr={[_e]:Kr,[we]:Kr,[ve]:function(e,n={}){let r=t.get("summary",e),l=t.children(e);return r&&(n.h4=r.textContent,l.splice(l.indexOf(r),1)),n.open=!0,[n,l.map(Nn)]}};[ce,fe,de,he,me,ge].forEach((function(e){Cr[e]=function(e,n={}){return n.open=!0,[n,t.children(e).map(Nn)]}}));const Nr={};function Sr(e,n,r){let l=e.firstElementChild;return l===r?l:(l&&xn(l)===n||(l=t.prepend(e,Gr(n))),r.nodeType&&xn(r)===n?t.replace(l,r):(t.fill(l,r.nodeType?t.contents(r):r),l))}function $r(e,n){let r=t.get(">header",e);if(r)return r===n?r:t.replace(r,n);let l=t.get(">h2",e);return l?t.after(l,n):t.prepend(e,n)}function Ar(t,e,n){return e.forEach((e=>t.insertTR(e,null,n))),n}function kr(e,n,r){let l=[];for(const o of n)l.push(e.newTR(r)),t("th,td",l[l.length-1]).fill(o);return l}function Or(t,e,n,r){if(!n)return[null,!0];let l=n.nodeType?xn(n):0;return Tn(e,l)&&!Pe(l)?[Rr(t,e,n),!0]:[Rr(t,e,r()),!1]}function Rr(e,n,r){return e?t.before(e,r):t.append(n,r)}function Ir(t,e,n,r,l){if(!r)return[null,!0];let o=t?e.trIndex(t,n):null;return"TR"!==r.tagName||!function(t,e){return function(t){return[...t.cells].reduce(((t,e)=>t+e.colSpan),0)}(t)===e.cols()}(r,e)||l&&![...r.cells].every((t=>"TH"===t.tagName))?[e.insertTR(e.newTR(l),o,n),!1]:[e.insertTR(r,o,n),!0]}function Lr(e,n,r){if("SECTION"!==r.tagName)throw new Error(`<${r.tagName}> not a SECTION`);Rr(e,n,function(e,n){return t.find("section",e,!0).forEach((t=>Pn(t,n))),e}(r,("ARTICLE"===n.tagName?0:Dn(n))-Dn(r)+1))}function zr(t,e,n){switch(tn(e)){case 0:case 1:return()=>Jr(Nt,null,n);case 2:return()=>Lr(t,e,n)}return null}function Ur(e){return e.map((e=>function(e){let n=t.get(">h2",e),r=t.children(e,"section");n||function(t,e){e&&window.console.info(e);throw new Error(t)}("<H2> is missed...!!",e);if(!r.length)return l=n,Xr(Gr(qt),{href:l.id?`#${l.id}`:null},l.innerText);var l;let o=function(t){let e=Xr(Gr(q),{href:t.id?`#${t.id}`:null},t.innerText);return Xr(Gr(te),{h5a:[e]},Gr(fe))}(n);return t.append(o.lastElementChild,Ur(r)),o}(e)))}function Mr(e){return t.isArray(e)?e.map((t=>t.textContent)).join(""):e.nodeType?e.textContent:e+""}function Hr(t,e){return e&&(t=t?`${t} ${e}`:`${e}`),t||null}function Dr(e,n,r){return"string"==typeof r&&(r=function(e){return t.find("*",e).forEach((t=>En(t,207))),e}(t.fragment(r,"svg"))),Rr(e,n,r)}function Pr(e,n){return!n||n.nodeType>1?n||null:"string"==typeof n?t.Text(n,!0):Ze(xn(e))?t.Text(n):Sn(n).map((n=>Tn(e,xn(n))?n:t.Text(n)))}function Fr(t,...e){e.forEach((e=>delete t[e]))}function Br(e,n={}){return n.title=t.attr(e,"title"),[n,t.Text(e)]}function jr(e,n={}){let r=t.attr(e,"datetime");return r&&([n.date,n.time]=r.split(/\s+/)),n.cite=t.attr(e,"cite"),n.datetime=r,[n,t.Text(e)]}function Kr(e,n={}){let r=t.get("h4",e),l=t.children(e);return r&&(n.h4=r.textContent,n.summary=r.textContent,l.splice(l.indexOf(r),1)),n.open=!0,[n,t(l).clone()]}function Vr(t,e,n=!1){return{head:t||null,body:e,end:n}}function Wr(e,n){return e?(t.isArray(e)?e:[e]).concat(n):t.isArray(n)?n:[n]}function Gr(e,n){let r=br[e],l=r?r():function(e,n){let r=t.elem(e);return n&&r.setAttribute("role",n)||r}(...yr[e].split("\\"));return n&&t.append(l,n),En(l,e)}function Xr(t,e,n,r){let l=xn(t),o=Er[l];return o&&(t=o(t,e)),xr[l]&&function(t,e,n,r){if(r)return n.forEach((n=>qr(null,t,e,n)));qr(null,t,e,n)}(t,e,n,r),t}function qr(e,n,r,l){let o=xn(n),i=xr[o](e,n,r,l);return i.end?Wr(i.head,i.body):t.isArray(i.body)?Wr(i.head,i.body.map(((e,n)=>Xr(e,r,function(e,n){return t.isArray(e)?e[n]:e}(l,n))))):Wr(i.head,Xr(i.body,r,l))}function Jr(t,e,n,r){if("string"==typeof t&&(t=nn[t.toUpperCase()]),null==t)throw new Error("invalid target name.");return Xr(Gr(t),e||{},n||"",r)}function Yr(t){let e=xn(t);return Cr[e]?g.convBlocks:Nr[e]?g.convLines:Tr[e]&&!function(t){let e=xn(t.parentElement);return 626===e||e===Xt}(t)?g.convInlines:null}function Qr(t){let e=xn(t),n=Tr[e]||Nr[e]||Cr[e];if(!n)throw new Error(`[${t}] convert is not supported.`);return n(t)}[Nt,St,$t,At,kt].forEach((function(t){Nr[t]=(t,e={})=>[(e.open=!0,e),Nn(t)]})),o(m,"New",(function(t){let e=nn[t.toUpperCase()];if(null==e)throw new Error("invalid target name.");return(t,n,r)=>Xr(Gr(e),n||{},t.data,r)}),1),o(m,"New2",(function(t){let e=nn[t.toUpperCase()];if(null==e)throw new Error("invalid target name.");return(t,n)=>t.data.map((t=>Xr(Gr(e),n||{},t)))}),1);
//! $ID: templates.js 2020.05.09 Cooljed.Config $
const Zr={0:"option:text",[M]:"option:audio",[H]:"option:video",102:"option:picture",103:"option:svg",104:"option:ruby",[D]:"option:meter",106:"option:space",[P]:"option:img",108:"option:image",109:"option:br",110:"option:wbr",[F]:"option:track",[B]:"option:source1",[j]:"option:source2",[K]:"option:pimg",[G]:"option:explain",207:"option:svgitem",[q]:"option:a",[J]:"option:q",[Y]:"option:abbr",[Q]:"option:del",[Z]:"option:ins",[tt]:"option:dfn",[et]:"option:bdo",[nt]:"option:bdi",[rt]:"option:times",[lt]:"option:code",[ot]:"option:strong",[it]:"option:em",[st]:"option:cite",[at]:"option:small",[ut]:"option:sub",[ct]:"option:sup",[ft]:"option:mark",[pt]:"option:orz",[dt]:"option:samp",[ht]:"option:kbd",[mt]:"option:s",[gt]:"option:u",[_t]:"option:var",[wt]:"option:crumb",[vt]:"option:label",[yt]:"option:button",[bt]:"option:input",[xt]:"option:textarea",[Et]:"option:select",[Tt]:"option:output",[Ct]:"option:progress",[X]:"option:option",[Nt]:"option:p",[St]:"option:note",[$t]:"option:tips",[At]:"option:pre",[kt]:"option:address",[Ot]:"option:h1",[Rt]:"option:h2",[It]:"option:h3",[Lt]:"option:h4",[zt]:"option:h5",[Ut]:"option:h6",[Mt]:"option:summary",[Ht]:"option:figcaption",[Dt]:"option:caption",[Pt]:"option:legend",[Ft]:"option:li",[Bt]:"option:dt",[jt]:"option:dd",[Wt]:"option:tr",516:"option:thead",517:"option:tbody",518:"option:tfoot",[Xt]:"option:codeli",[qt]:"option:ali",[Yt]:"option:ah5",[Qt]:"option:xh5li",[Zt]:"option:xolh5li",[te]:"option:xolah5li",600:"option:hgroup",612:"option:article",[ee]:"option:s1",[ne]:"option:s2",[re]:"option:s3",[le]:"option:s4",[oe]:"option:s5",[ie]:"option:abstract",609:"option:seealso",608:"option:reference",[se]:"option:header",[ae]:"option:footer",[ue]:"option:section",[ce]:"option:ul",[fe]:"option:ol",[pe]:"option:codelist",[de]:"option:ulx",[he]:"option:olx",[me]:"option:cascade",[ge]:"option:dl",621:"option:table",622:"option:figure",[_e]:"option:blockquote",[we]:"option:aside",[ve]:"option:details",626:"option:codeblock",[ye]:"option:fieldset",[be]:"option:hr",629:"option:blank"},tl={[M]:"property:audio",[H]:"property:video",102:"property:picture",[P]:"property:img",[K]:"property:img",103:"property:svg",104:"property:ruby",[rt]:"property:times",[D]:"property:meter",106:"property:space",[q]:"property:a",[Gt]:"property:a",[J]:"property:q",[Y]:"property:abbr",[Q]:"property:del",[Z]:"property:ins",[lt]:"property:code",[tt]:"property:dfn",[et]:"property:bdo",[_e]:"property:blockquote",[ve]:"property:details",[pe]:"property:codelist",[fe]:"property:ol",[he]:"property:olx",[Ft]:"property:li",[Xt]:"property:li",[qt]:"property:li",[Qt]:"property:li",[Zt]:"property:li",[te]:"property:li",621:"property:table",[be]:"property:hr",629:"property:blank",[G]:"property:explain",[Ot]:"property:h1",[Rt]:"property:h2",[It]:"property:h3",[Lt]:"property:h4",[zt]:"property:h5",[Ut]:"property:h6"},el=new Set([V,W,Kt,Vt,K,110,-10]);function nl(t){let e=new Map;for(const[n,r]of function(t){let e=new Map([["inlEntity",[]],["inlText",[]],["inlCtrl",[]]]);for(const n of t)bn(n,e);return e}(t))e.set(_[n],r.map((t=>Zr[t])));return e}function rl(t){let e=function(t){let e=t.shift();if(!e||"TABLE"===e.tagName&&t.length>0)return[];let n=[...Cn(e)];return t.length>0&&(n=n.filter((e=>t.every((t=>Tn(t,e)))))),n.filter((t=>!el.has(t)))}(t);return e.length?Me(e[0])||Ge(e[0])?nl(e):e.map((t=>Zr[t])):[]}
//! $ID: shedit.js 2021.04.08 Cooljed.Libs $
const ll=new t.Fx.History,ol=new Gn(`${g.nameEditor}_${g.scriptList}`),il=new Xn(w.shEdits,ll),sl=Symbol("sh:dpage"),al=Symbol("sh:pager");let ul=null,cl=null,fl=!1;class pl{constructor(e){this.$els=t(e),this.count=null,this.redo()}undo(){this.count>0&&ll.back(this.count)}redo(){let t=ll.size();this.$els.remove(),this.count=ll.size()-t}}class dl{constructor(t){this._sid=t,this._old=ol.get(t),this.redo()}undo(){ol.set(this._sid,this._old)}redo(){ol.del(this._sid)}}class hl{constructor(t,e){let n=t[sl];this._idx=n.index();let r=_l(n[e]()),l=n.index();this._nav=t,this._new=t[al].page(l,r),this._pgn=l+1,this._pgs=n.pages(),this.count=null,this.redo()}undo(){this.count>0&&ll.back(this.count),this._nav[sl].index(this._idx)}redo(){let t=ll.size();wl(this._nav,"page",this._new,"state",this._pgn,this._pgs),this.count=ll.size()-t}}function ml(...e){t.trigger(cl,"state",!0),il.push(...e.filter((t=>t)))}function gl(t){let e=ol.get(t);return e?JSON.parse(e):null}function _l(e){return(e=t.map(e,gl)).edit=fl,e.cmax=w.shCodelen,e}function wl(e,n,r,l,o,i){var s,a;t.trigger(e,n,r),t.trigger(e,l,[[o,i],(s=o,a=i,a<=1?[!0,!0,!0,!0]:[1===s,1===s,s===a,s===a])])}function vl(t,e){let n=t.index();return e.page(n,_l(t.page(n)))}function yl(t,e=0){let n=Date.now()+e;return t.has(n)?yl(t,parseInt(240*Math.random()*3600*1e3)):n}function bl(t){if(!t||function(t){return ol.keys().some((e=>gl(e).code===t))}(t))return;let e=yl(ol),n={shid:e,code:t,time:Date.now()};ol.set(e,JSON.stringify(n))}const xl={spinit(t){ul=t.data},__spinit:1,shUndo:()=>(il.undo(),!il.canUndo()),shRedo:()=>(il.redo(),!il.canRedo()),shinit(t,e,n,r,l){cl=t.data,r[sl]=new qn(null,w.shListTop),r[al]=new Jn(e),l[sl]=new qn(null,w.shListAll),l[al]=new Jn(n)},__shinit:1,delsh(t,e){fl&&ml(new pl(t.data),new dl(e))},__delsh:1,topsh(t){let e=gl(t.data);return e&&(e.top=!0,ol.set(t.data,JSON.stringify(e))),e&&t.data},__topsh:1,untop(t){let e=gl(t.data);return e&&(e.top=!1,ol.set(t.data,JSON.stringify(e))),e&&t.data},__untop:1,shlabel(t,e){let n=gl(t.data);return n&&(n.name=e,ol.set(t.data,JSON.stringify(n))),n&&[e,t.data]},__shlabel:1,shpage(t,e){let n=new hl(t.data,e);fl&&ml(n)},__shpage:1,shtops(t){let e=t.data,n=e[sl].reset(function(){let t=[];for(const e of ol.keys()){let n=gl(e);n&&n.top&&n.code&&t.push({id:n.shid,tm:n.time})}return t.sort(((t,e)=>e.tm-t.tm)).map((t=>t.id))}()),r=vl(n,e[al].reset());wl(e,"page",r,"state",n.index()+1,n.pages())},__shtops:1,shIndex:t=>(fl=!0,t.data.map((t=>vl(t[sl],t[al].reset())))),__shIndex:1,shEdin(e){il.clear(),t.on(e.data,"nodeok emptied detach",null,ll),t.on(e.data,"attrdone","nav >b",ll)},__shEdin:1,shEdok(e){fl=!1,il.clear(),t.off(e.data,"nodeok emptied detach attrdone",!1,ll)},__shEdok:1,sh2panel(e,n,r,l,o){let i=t.outerHeight(r,!0)+t.outerHeight(l,!0),s=t.outerHeight(o,!0)-t.height(o);return[t.height(r)+e.data,t.height(n)-(i+s+e.data)]},__sh2panel:1,shsearch(t,e){let n=e[sl].reset(function(t){let e=function(...t){return e=>t.some((t=>t.every((t=>e.includes(t)))))}(...t.split(",").map((t=>t.trim().split(/\s+/)))),n=[];for(const t of ol.keys().reverse()){let r=gl(t);r&&r.code&&e(r.code)&&n.push({id:r.shid,tm:r.time})}return n.sort(((t,e)=>e.tm-t.tm)).map((t=>t.id))}(t.data)),r=vl(n,e[al].reset());wl(e,"page",r,"state",n.index()+1,n.pages())},__shsearch:1,shcode(e){t.trigger(ul,"shcode",e.data)},__shcode:1,shsave(t){bl(t.data)},__shsave:1};i(m,"Kit",xl,["spinit","shUndo","shRedo","shinit","delsh","topsh","untop","shlabel","shpage","shtops","shEdin","shEdok","shIndex","sh2panel","shsearch","shcode","shsave"]);
//! $ID: highlight.js 2020.02.07 Cooljed.Libs $
const El={keyword:"kw",literal:"lit",number:"num",function:"fn",operator:"op",builtin:"bin",datatype:"dt",xmltag:"tag",attribute:"atn",regex:"re",selector:"slr",rgba:"rgb",unit:"un",important:"imp",doctype:"doc",error:"err",comments:null};function Tl(t,e){return null==e?t:"string"==e?`<s>${t}</s>`:"comments"==e?`<i>${t}</i>`:`<b role="${El[e]||"non"}">${t}</b>`}function Cl(e,n,r){return t.html(e,Tl(n,r),"append"),e}function Nl(t){return t.map((t=>"string"==typeof t?t:Tl(t.text,t.type))).join("")}function Sl(t){let e=t[0],n=t[t.length-1];return e.text&&e.text.startsWith("\n")&&(e.text=e.text.substring(1)),n.text&&n.text.endsWith("\n")&&(n.text=n.text.slice(0,-1)),t}function $l(e,n){let{text:r,type:l}=e;return t.isArray(r)&&(r=Nl(r)),[Cl(n,r,l)]}function Al(e,n){let{text:r,type:l}=e,o=(t.isArray(r)?Nl(r):r).split("\n");return[Cl(n,o.shift(),l),...o.map((t=>Cl(n.cloneNode(),t,l)))]}function kl(t,e,n,r=!0){let l=[],o=Jr(lt,{lang:t});for(const i of e)void 0===i.text?(l.push(...kl(i.lang,r?Sl(i.data):i.data,n)),o=Jr(lt,{lang:t})):(l.push(...n(i,o)),o=l[l.length-1]);return[...new Set(l)].filter((t=>!t.normalize()))}
//! $ID: property.js 2021.06.16 Cooljed.Libs $
const Ol=/\s+/g,Rl=t([g.rpLeft,g.rpRight]).elem("rp"),Il={[M]:function(e,n,r,l){t.attribute(e,r),void 0!==l&&Bl(e,"source",l)},[H]:function(e,n,r,l,o){t.attribute(e,r),void 0!==l&&Bl(e,"source",l);void 0!==o&&Bl(e,"track",o)},102:function(e,n,r,l){let o=t.get("img",e);void 0!==l&&(t.fill(e,l),t.append(e,o));t.attribute(o,r)},[P]:Ml,[K]:Ml,103:Ml,104:function(e,n,r,l,o,i){let s=t("rp",e),a=t.get("rt",e);void 0!==l&&(t.fill(e,l),a&&t.append(e,[s[0],a,s[1]]));if(void 0===r)return;a?t.fill(a,r):t.append(e,[o,t.elem("rt",r),i])},[D]:Ml,106:Ul,[q]:Ml,[Gt]:Ml,[Q]:Ml,[Z]:Ml,[lt]:function(e,n,r,l){void 0!==r&&t.attr(e,"-lang",function(e,n){let r=e.parentElement.parentElement;if(xn(r)!==pe)return n;return t.attr(r,"-lang")===n?null:n}(e,r));void 0!==l&&t.fill(e,l)},[pe]:function(e,n,r,l){t.attribute(e,r),void 0!==l&&t.fill(e,t(l).elem("li"))},[fe]:Ml,[he]:Ml,[Ft]:Ml,[Xt]:Ml,[qt]:Ml,[Qt]:Ml,[Zt]:Ml,[te]:Ml,621:function(e,n,r,l,o){let i=new t.Table(e);void 0!==r&&t.attr(e,"border",r);void 0!==l&&Fl(i,l,0);void 0!==o&&Fl(i,o,null)},[be]:function(e,n,r,l){t.cssSets(e,n,r),t.attr(e,"role",l)},629:Ul,[G]:function(e,n,r){t.attr(e,n,r),t.cssSets(e,"top right bottom left",null)}},Ll={[M]:function(t,e,n,r){return e.autoplay=n[0],e.loop=n[1],e.controls=n[2],[Kl(e,"",null),r]},[H]:function(t,e,n,[r,l]){return e.autoplay=n[0],e.loop=n[1],e.controls=n[2],[Kl(e,"",null),r,l]},102:function(t,e,n){return[Kl(e,"",null),n]},104:function(e,n,r){let l=t.get("rt",e);return t([n,r]).Text().concat(l?[]:Rl.clone())},621:jl,[rt]:Hl,[Q]:Hl,[Z]:Hl,[lt]:Pl,[pe]:function(e,n,r,l){let o={"-lang":n,start:r},i=t.attr(e,"-lang")||"";if(Kl(o,"",null),!l&&n===i)return[o];return[o,Gl(e,n)]}},zl={[M]:function(e,n,r,l){let o=l&&t(l);return n.autoplay=r[0],n.loop=r[1],n.controls=r[2],Kl(n,"",void 0),Kl(n,null,void 0),e.map((()=>[n,o?o.clone():void 0]))},[H]:function(e,n,r,[l,o]){let i=l&&t(l),s=o&&t(o);return n.autoplay=r[0],n.loop=r[1],n.controls=r[2],Kl(n,"",void 0),Kl(n,null,void 0),e.map((()=>[n,i?i.clone():void 0,s?s.clone():void 0]))},102:function(e,n,r){let l=r&&t(r);return Kl(n,"",void 0),e.map((()=>[n,l?l.clone():void 0]))},104:function(e,n,r){let l=[void 0,void 0];n&&(l[0]=t.Text(n));r&&(l[1]=t.Text(r));return e.map((e=>l.concat(t.get("rt",e)?[]:Rl.clone())))},621:function(t,e,n,r){return t.map((t=>jl(t,e,n,r)))},[rt]:Dl,[Q]:Dl,[Z]:Dl,[lt]:function(t,e){return t.map((t=>Pl(t,e)))},[pe]:function(e,n,r){return e.map((e=>function(e,n,r){let l={"-lang":n,start:r},o=t.attr(e,"-lang")||"";if(Kl(l,"",void 0),Kl(l,null,void 0),n===o||null===n)return[l];return[l,Gl(e,n)]}(e,n,r)))}};function Ul(e,n,...r){t.cssSets(e,n,r)}function Ml(e,n,...r){t.attribute(e,n,r)}function Hl(t,e,n,r){return n&&(e=e?`${e} ${n}`:`${n}`),[e||null,r||null]}function Dl(t,e,n,r){return n&&(e=e?`${e} ${n}`:`${n}`),Vl(t,[e||void 0,r||void 0])}function Pl(e,n){let r=e.textContent;if(""===n)return[null,t.Text(r)];let l=kl(null,vr([r],n),$l,!1);return[n,(o=l,o.map((t=>[...t.childNodes])).flat())];var o}function Fl(t,e,n){let r=t.hasVth(null==n);e?r||t.insertColumn(e,n):r&&t.removeColumn(null==n?-1:n)}function Bl(e,n,r){t.find(n,e).forEach((e=>t.remove(e))),t.append(e,r)}function jl(e,n,r,l){let o=new t.Table(e),i=o.hasVth(),s=o.hasVth(!0);return[n,r?i||o.newColumn(!0):null===r?void 0:null,l?s||o.newColumn(!0):null===l?void 0:null]}function Kl(t,e,n){for(const r of Object.keys(t))t[r]===e&&(t[r]=n);return t}function Vl(t,e){return new Array(t.length).fill(e)}function Wl(t,e){let n=t.map((t=>t.hasVth(!!e)));return 1===n.length||1===new Set(n).size?[n[0],!1]:[null,!0]}function Gl(e,n){let r=t.children(e).map((t=>t.textContent));return""===n?t(r).elem("code"):kl(null,vr(r,n),Al)}const Xl={vals1:t=>1===t.data.length||1===new Set(t.data).size?t.data[0]||"":null,__vals1:1,vals2:t=>1===t.data.length||1===new Set(t.data).size?[t.data[0],!1]:[null,!0],__vals2:1,tableVth(e){let n=e.data.map((e=>new t.Table(e)));return[Wl(n),Wl(n,!0)]},__tableVth:1,attrVal:(e,n)=>n.split(Ol).map((n=>function(e,n){let r=e.map((e=>t.attr(e,n)));return 1===r.length||1===new Set(r).size?r[0]||"":null}(e.data,n))),__attrVal:1,attrBool:(e,n)=>n.split(Ol).map((n=>function(e,n){let r=e.map((e=>t.attr(e,n)));return 1===r.length||1===new Set(r).size?[null!==r[0],!1]:[null,!0]}(e.data,n))),__attrBool:1};s(v,"p",Xl,Object.keys(Xl).filter((t=>"_"!==t[0])));
//! $ID: plugins.js 2021.09.23 Cooljed.Plugins $
const ql=Object.create(a),Jl=Object.create(u),Yl=new z(y),Ql=new Map,Zl=new Map,to=new WeakMap;function eo(e,n=b.plugConf){return Yl.json(`${e}/${n}`).then((n=>function(e,n){if(n.style)return t.style({href:`${y}${e}/${n.style}`}).then((t=>Zl.set(e,t)&&n));return n}(e,n))).then((t=>function(t,e){if(!e.extend)return e;return import(`${y}${t}/${e.extend}`).then((t=>function(t,e){return t.on=e.On||null,t.by=e.By||null,t}(e,t)))}(e,t))).then((t=>function(t,e){if(!e.root)return null;let n=new L(f(e.on,e.by),new U(t,Yl));return n.config(e.maps).then((()=>Yl.node(`${t}/${e.root}`))).then((t=>n.build(t,e.root)))}(e,t)))}function no(e,n=null){if(Ql.has(e))return Promise.resolve(null);let r=`${b.plugRoot}/${e}`,l=t.Element("img",{src:`${y}${r}/${b.plugLogo}`}),o=t.wrap(l,t.Element("button",{title:n}));return eo(r).then((t=>Ql.set(e,o)&&c.templater(e,t)||to.set(o,e)&&o))}
//! $ID: cmdline.js 2021.08.08 Cooljed.Libs $
const ro=/^\(\s*\/(.*)\/([imsu]*)\s*\)$/,lo=/^\(([^]*?)\)$/,oo=/^\[([\d:,\s]*)\]$/,io=/\s*:\s*/,so=/^\{(.*)\}$/,ao=/^\/(.*)\/([imsugy]*)$/,uo=/^(['"`])(.*)\1$/,co=new S("|",new $,new k("[","]"),new k("{","}"));let fo=null,po=null;class ho{constructor(t,e){this._set=t,this._ctx=e}exec(t,e){let n=[...co.reset().split(t.trim())],r=n.shift();return Eo(n,this._set.size>0?this._finds(r,e,[...this._set]):this._find(r,e,this._ctx))}_find(t,e,n){return I.find(t,e,!1,n)}_finds(t,e,n){return n.map((n=>I.find(t,e,!1,n))).flat()}}class mo{constructor(t){this._set=t}exec(e){return Eo([...co.reset().split(e.trim())],t(this._set))}execOne(e,n){return this._handle(e.trim())(t(n))}_handle(t){return ro.test(t)?this._texter(t):lo.test(t)?this._exclude(t.match(lo)[1]):oo.test(t)?this._number(t.match(oo)[1]):so.test(t)?this._filter(t.match(so)[1]):e=>e.filter(t)}_exclude(e){return n=>n.filter((n=>!t.is(n,e)))}_number(t){let e=t.split(io);return e.length>1?this._range(e):(e=JSON.parse(`[${t}]`),t=>e.map((e=>t[e])).filter((t=>t)))}_range([t,e]){return t=Math.trunc(t)||0,e=e.trim()?Math.trunc(e):void 0,n=>n.slice(t,e)}_texter(t){return e=>e.filter(new RegExp(...t.match(ro).slice(1)))}_filter(t){let e=new Function("v","i","c",`return ${t};`);return t=>t.filter(e)}}class go{constructor(t){this._ctx=t,this._doc=t.ownerDocument}exec(t,e){return t=ao.test(t)?this._regexp(t):To(t),e.map((e=>this._ranges(e,t))).flat()}_ranges(t,e){let n=[],r=0,l=0;for(;[r,l]=this._search(t.textContent,e,r),!(r<0||0===l);)n.push(this._range(t,r,l)),r+=l;return n}_search(t,e,n){if("string"==typeof e)return[t.indexOf(e,n),e.length];let r=t.substring(n),l=r&&r.match(e);return l?[n+l.index,l[0].length]:[-1,0]}_range(t,e,n){let r=this._doc.createRange();return r.setStart(t,e),r.setEnd(t,e+n),r}_regexp(t){let[e,n]=t.match(ao).slice(1);return n&&(n=n.split("").filter((t=>"g"!==t)).join("")),new RegExp(e,n)}}class _o{constructor(t){this._cmds=new Map([["plug-ins",this._plugIns],["plug-del",this._plugDel],["help",this._help],["config",this._config],["replace",this._replace.bind(this)]]),this._eset=t}exec(t){let[e,n]=this._cmdArgs(t),r=this._cmds.get(e);if(!e)return _.commandInvalid;try{return r(...n)||""}catch(t){return`[${t.name}]: ${t.message}`}}_cmdArgs(t){for(const e of this._cmds.keys())if(t===e||t.startsWith(e+" "))return[e,this._args(t.substring(e.length+1))];return[]}_args(e){return t.split(e," ",1/0,!0).filter((t=>t)).map(To)}_help(e){t.trigger(fo,"open"),t.trigger(fo,"help",e)}_plugIns(e,n){t.trigger(po,g.plugIns,no(e,n))}_plugDel(e){t.trigger(po,g.plugDel,function(e){let n=Ql.get(e),r=`${b.plugRoot}/${e}`,l=Zl.get(r);return n&&(Ql.delete(e),c.templater(e,null)),l&&(t.remove(l),Zl.delete(r)),n||null}(e))}_config(t,e){if(void 0===e)return w[t].toString()||_.configNothing;if(void 0===E[t])throw new Error(`${t} option is not supported`);return`Fx.${t}=${E[t]=e&&JSON.parse(e)}`}_replace(...t){return t.length?this._eset.size?[new xo([...this._eset],...t)]:_.selectNone:_.missContent}}class wo{constructor(t,e){this._set=t,this._ctx=e}exec(e,n){let r=new Function("$$","$","_",`return ${e};`),l=null;try{l=r(t(this._set),n,this._ctx)}catch(t){l=`[${t.name}]: ${t.message}`}return""+l}}class vo{constructor(){this._buf=[]}add(t){this._buf[this._buf.length-1]!==t&&this._buf.push(t)}find(t){let e=this._buf.slice().reverse(),n=[],r=0;for(;r>=0;)r=this._indexOf(t,e,r),r>=0&&n.push(e[r++]);return n}size(){return this._buf.length}_indexOf(t,e,n=0){for(;n<e.length;n++)if(e[n].startsWith(t))return n;return-1}}class yo{constructor(t){this._buf=t,this._idx=0}next(){let t=this.size()-1;return this._idx<t?this._buf[++this._idx]:null}prev(){return this._idx>0?this._buf[--this._idx]:null}first(){return this._idx=0,this._buf[0]||null}last(){return this._idx=this._buf.length-1,this._buf[this._idx]||null}reset(){return this._idx=0,this}size(){return this._buf.length}}const bo={[x.select]:new vo,[x.filter]:new vo,[x.search]:new vo,[x.command]:new vo,[x.calcuate]:new vo};class xo{constructor(e,n,r){if(!this._checks(e))throw new Error(_.needContent);void 0===r?[n,r]=[/[^]+/,n]:n=this._regstr(n),this._tts=t(e).map((t=>t.textContent.replace(n,r))).Text(),this._els=e,this._old=e.map(((t,e)=>this._fill(t,this._tts[e])))}undo(){this._els.forEach(((t,e)=>this._fill(t,this._old[e])))}redo(){this._els.forEach(((t,e)=>this._fill(t,this._tts[e])))}_checks(t){return t.every((t=>kn(t)))}_regstr(t){return ao.test(t)?new RegExp(...t.match(ao).slice(1)):t}_fill(e,n){let r=[...e.childNodes];return e.textContent="",e.append(...t.isArray(n)?n:[n]),r}}function Eo(t,e){return t.reduce(((t,e)=>(new mo).execOne(e,t)),e)}function To(t){return uo.test(t)?t.match(uo)[2]:t}function Co(e,n){fo=e,po=n,t.trigger(n,g.plugInit,b.plugList.reduce(((t,e)=>t.then((t=>no(e[0],e[1]).then((e=>t.push(e)&&t))))),Promise.resolve([])))}function No(t){return bo[t]}
//! $ID: edit.js 2019.09.07 Cooljed.Libs $
const So=t.Fx.History.Normalize,$o=`${g.selectedClass} ${g.focusClass} ${g.hoverClass} ${g.pointClass}`,Ao=`.${g.selectedClass}, .${g.focusClass}, .${g.hoverClass}, .${g.pointClass}`,ko=Symbol(),Oo=/\s+/g,Ro=/\n\s*\n/,Io=/(\s)\s*/g,Lo=/\r\n|\n|\r/,zo=/section|article/i,Uo=/\sclass="[\w\s]+"/,Mo=/^\|\[:?\s(.*)\s\]$/,Ho=/\s:?\]\[\s/,Do={[Bt]:["dd",ge],[Mt]:["p",ve],[It]:["p",ie],[It]:["p",se],[It]:["p",ae],[It]:["p",_e],[It]:["p",we]},Po=new Set([Ft,Bt,jt,Nt,$t,St,kt]),Fo={minied:"miniedIn",toup:"indentReduce",todown:"indentIncrease",delete:"deletes",range:"elementRange",property:"properties"},Bo={children:Ss,siblings:function(t){return Ss([...Cs(t)])}},jo=new Set(["a","ruby","bdo","fcona"]),Ko=new Set(["on","by","to","on by to"]),Vo=new Vn(g.selectedClass),Wo=new class{constructor(t){this._cls=t,this._its=null}set(t){let e=this._its;return e!==t&&this._set(t),e}get(){return this._its||null}is(t){return!!t&&t===this._its}cancel(){return this._its&&t.removeClass(this._its,this._cls),this._its=null}_set(e){if(null==e)return this.cancel();this._its&&t.removeClass(this._its,this._cls),this._its=t.addClass(e,this._cls)}}(g.focusClass),Go=new class{constructor(t){this._set=t,this._np2=null,this._tmp=null}pickback(t){return this._tmp?this._restore():this._pick(t)}cando(t){return!!(this._tmp||this._set.size>1)||1===this._set.size&&!this._set.has(t)}reset(){this._tmp=null,this._np2=null}_pick(t){return this._tmp=[...this._set],this._np2=this._set.cruise(),this._set.clear().add(t)}_restore(){return this._set.clear().pushes(this._tmp.filter((t=>t.isConnected))),this._set.cruise(this._np2.map((t=>t&&t.isConnected?t:null))),this._np2=null,this._tmp=null,[...this._set]}}(Vo),Xo=new class{constructor(e="_cursor_"){let n=e+(Date.now()%4294967295).toString(16);this._cel=t.attr(t.elem("i"),n,""),this._slr=`[${n}]`}cursor(e,n){let r=n.commonAncestorContainer,l=t.contains(e,r);return l&&(3===r.nodeType&&0===n.endOffset&&n.setEnd(n.endContainer,1),n.collapse(!1),n.insertNode(this._cel)),n.detach(),l&&e}active(e){let n=t.get(this._slr,e),r=document.createRange();return n?(r.selectNode(n),r.deleteContents(),e.normalize()):r.selectNodeContents(e),this._active(r,e)}active2(e,n=!1){let r=t.get(this._slr,e),l=document.createRange();return r&&(r.remove(),e.normalize()),l.selectNodeContents(e),l.collapse(n),this._active(l,e)}clean(e){let n=t.get(this._slr,e);return n&&(n.remove(),e.normalize()),n&&e}_active(t,e){let n=window.getSelection();return n.removeAllRanges(),n.addRange(t),t.detach(),e.focus(),e}},qo=new t.Fx.History,Jo=new Gn(`${g.nameEditor}_`),Yo=new S(";",new $,new A);class Qo{constructor(t,...e){this._fun=t,this._vals=e,this.count=null,this.redo()}undo(){this.count>0&&qo.back(this.count)}redo(){let t=qo.size();this._fun(...this._vals),this.count=qo.size()-t}changed(){return this.count>0}}class Zo{constructor(t,...e){this._fun=t,this._args=e,this.count=null,this._beg,this._data,this.redo()}undo(){this.count>0&&qo.back(this.count)}redo(){this._beg=qo.size(),this._data=this._fun(...this._args),this.count=qo.size()-this._beg}changed(){return this.count>0}hasNodes(){return qo.hasNode(this._beg,this.count)}result(){return this._data}warn(t){if(void 0===t)return this._msg;this._msg=t}}class ti{constructor(t,e){this._nds=t,this._old=t.map((t=>t.textContent)),this._tts=this._old.map(e),this.redo()}undo(){this._nds.forEach(((t,e)=>t.textContent=this._old[e]))}redo(){this._nds.forEach(((t,e)=>t.textContent=this._tts[e]))}}class ei{constructor(t){this._box=t.parentElement,this.redo()}undo(){this._op.back()}redo(){this._op=new So(this._box)}}class ni{constructor(t,...e){this._fun=t,this._vals=e,this._old=[...Vo],this._np2=Vo.cruise(),this._newsel()}undo(){Vo.clear().pushes(this._old),Vo.cruise(this._np2),Ns(xi,g.evnFollow)}redo(){Vo.cruise(null),this._newsel()}_newsel(){this._fun(...this._vals),Ns(xi,g.evnFollow)}}class ri{constructor(t){this._old=[...Vo],this._np2=Vo.cruise(),this._new=ui.pickBack(t)}undo(){Vo.clear().pushes(this._old),Vo.cruise(this._np2),Go.reset(),Ns(xi,g.evnFollow)}redo(){Vo.cruise(null),Vo.clear().pushes(Ks(this._new)),Ns(xi,g.evnFollow)}}class li{constructor(t=Wo.get()){this._hot=t,this._old=$i(t)}undo(){$i(this._old)}redo(){$i(this._hot)}}class oi{constructor(t){t&&this.redo()}undo(){Ns(xi,g.evnFollow)}redo(){Ns(xi,g.evnFollow)}}class ii{constructor(t,e){this._el=Jr(e,...this._optData(e,t)),this._old=[...t.extractContents().childNodes],t.insertNode(this._el),t.collapse(),t.detach(),this._tmp=null}undo(){let t=this._el.parentElement;this._el.replaceWith(...this._old),this._tmp=new So(t)}redo(){this._tmp.back(),this._old.slice(1).forEach((t=>t.remove())),this._old[0].replaceWith(this._el)}elem(){return this._el}completed(){return this._whole}_optData(t,e){let n=this[`_${t}`],r=e.cloneContents();return n?n(this,e.toString(),r):[null,r]}_a(t,e,n){return t._whole=ii.url.test(e.trim()),[t._whole&&{href:e},n]}_fcona(e,n,r){return[{},t.contents(r,null,!1,!0),!0]}_ruby(t,e,n){let r=e.trim().match(ii.ruby),l=r?r[2]:g.rtHolder,o=r?r[1]:n;return t._whole=r,[{rt:l},o]}}ii.url=/^(?:http|https|ftp|email):\/\/\w[\w.-]+\/\S+$/i,ii.ruby=RegExp(`^([\\S\\x20]+)\\${g.rpLeft}([\\w\\u00c0-\\u017e\\u3105-\\u312d ]+)\\${g.rpRight}$`,"i");class si{constructor(e){this._el=t.attr(t.elem("mark",e.toString()),"role","tmp"),this._old=[...e.extractContents().childNodes],e.insertNode(this._el),e.detach(),this._tmp=null}undo(){let t=this._el.parentElement;this._el.replaceWith(...this._old),this._tmp=new So(t)}redo(){this._tmp.back(),this._old.slice(1).forEach((t=>t.remove())),this._old[0].replaceWith(this._el)}elem(){return this._el}}class ai{constructor(t,e){this._cp=this._clone(t,e),this._el=t,t.replaceWith(this._cp),this._cp.setAttribute("contenteditable",!0)}active(){Xo.active(this._cp)}activeEnd(){Xo.active2(this._cp,!1)}done(){let e=this._clean(t.clone(this._cp),xn(this._cp));Xs((()=>t.fill(t.removeAttr(this._cp,"contenteditable"),e)))}elem(){return this._cp}original(){return this._el}undo(){this._cp.replaceWith(this._el)}redo(){this._el.replaceWith(this._cp)}_clone(e,n){Xo.cursor(e,n);let r=t.clone(e,!0,!0,!0);return Xo.clean(e),r}_clean(e,n){return ur(t.normalize(e)),n===At?t("br",e).replace("\n"):n===lt&&this._codeparse(e),[...t.normalize(e).childNodes]}_codeparse(e){let n=t.attr(e,"-lang");if(!n)return t("br",e).replace("\n");t.html(e,kl(null,vr([e.textContent],n),$l,!1).map((t=>t.innerHTML)).join(""))}}class ui{only(t){if(1==Vo.size&&Vo.has(t))return!1;Vo.clear(),Vo.add(t)}turn(t){Vo.has(t)?Vo.delete(t):this.clean(t).add(t)}reverse(t){for(const e of t)Vo.has(e)?Vo.delete(e):this._parentAdd(e)}expand(t,e){return Vo.has(e)?this.adds(t):this.removes(t)}adds(t){t.forEach((t=>Vo.has(t)||this._parentAdd(t)))}removes(t){t.forEach((t=>Vo.has(t)&&Vo.delete(t)))}empty(){if(0==Vo.size)return!1;Vo.clear()}add(t){Vo.has(t)||this.clean(t).add(t)}safeAdd(t){Vo.has(t)||Vo.add(t)}safeAdds(t){Vo.pushes(t)}delete(t){return Vo.has(t)&&Vo.delete(t)}unshift(t){let e=[...Vo];e.length&&Vo.clear(),this.adds(t.concat(e))}cleanUp(t){let e=this._parentItem(t);return!!e&&(Vo.delete(e),Vo)}cleanDown(t){let e=this._contains(t);return!!e.length&&(e.forEach((t=>Vo.delete(t))),Vo)}clean(t){return this.cleanUp(t)||this.cleanDown(t)||Vo}_parentAdd(t){this.cleanDown(t),Vo.add(t)}_parentItem(e){for(const n of Vo)if(t.contains(n,e,!0))return n;return null}_contains(e){let n=[];return Vo.forEach((r=>t.contains(e,r,!0)&&n.push(r))),n}}ui.pickBack=Go.pickback.bind(Go);const ci=new ui,fi=new class{toText(t){t.text(t.text())}unWrap(e){let n=new Set;e.forEach((t=>n.add(t.parentElement))),e.unwrap(),t(n).normalize()}newAfter(e,n){t.after(e,n)}newBefore(e,n){t.before(e,n)}newPrepend(e,n){t.prepend(e,n)}newAppend(e,n){t.append(e,n)}cloneAfter(e,n){e.forEach(((e,r)=>t.after(e,n[r])))}appends(e,n){e.forEach((e=>t.append(e,n)))}fills(e,n){e.forEach((e=>t.fill(e,n)))}replaces(e,n){e.forEach(((e,r)=>t.replace(e,n[r])))}replacex(e,n){t.replace(e[0],n),e.slice(1).forEach((e=>t.remove(e)))}insert(e,n,r){e?t.before(e,r):t.append(n,r)}alignInsert(e,n,r){e.forEach(((e,l)=>t[n](e,r[l])))}reverses(t){for(const e of t){let t=e.length-1;for(let n=0;n<parseInt(e.length/2);n++)ir(e[n],e[t-n])}}merges(e,n,r){t.append(e,n),r.filter(vs).remove()}movePrev(e,n){for(const r of e)0===n?t.before(lr(r[0],1/0),r):r.forEach((e=>t.before(lr(e,n),e)))}moveNext(e,n){for(const r of e)0===n?t.after(or(Ws(r),1/0),r):r.reverse().forEach((e=>t.after(or(e,n),e)))}sectionsUp(e){e.forEach((e=>function(e){let n=e.parentElement;if("s1"===t.attr(e,"role"))return Js(_.sectionNotUp,e);t.after(n,function(e){return t.find("section",e).forEach((t=>Pn(t,-1))),Pn(e,-1)}(e)||e)}(e))),Ai()}sectionsDown(e){e.forEach((e=>{return n=e[0],r=e[1],function(e){t.find("section",e).forEach((t=>Pn(t,1))),Pn(e,1)}(n),void t.append(t.replace(n,r),n);var n,r})),Ai()}styles(e,n,r){for(const l of e)t.cssSets(l,n,r)}attrs(e,n,r){for(const l of e)t.attribute(l,n,r)}},pi=new Xn(w.history,qo);let di=null,hi=null,mi=null,gi=null,_i=null,wi=null,vi=null,yi=null,bi=null,xi=null,Ei=null,Ti=null;function Ci(...t){Ni(),Gs(null),pi.push(...t.filter((t=>t)))}function Ni(){t.trigger(di,g.redoEvent,!1,!0)}function Si(t,e){return void 0===e?t[ko]:(t[ko]=e,t)}function $i(e){try{return null==e?t.empty(mi):(t.intoView(e,0),t.fill(mi,function(e,n){return[e].concat(t.parentsUntil(e,(t=>t===n))).reverse().map((e=>Si(t.elem("b",function(t){let e=t.tagName.toLowerCase();return t.hasAttribute("role")&&(e+=":"+t.getAttribute("role")),e}(e)),e)))}(e,di))),Wo.set(e)}finally{!function(e){t.trigger(hi,g.covert,e&&$n(e)&&Os(e)||"")}(e)}}function Ai(){let t=Wo.get();Vo.has(t)&&$i(t)}function ki(t,e){ci.cleanUp(e),ci.expand(t,e)}function Oi(t,e){t.forEach((t=>ci.cleanUp(t))),ci.expand(t,e)}function Ri(t,e){t.forEach((t=>ci.cleanUp(t))),ci[e](t)}function Ii(t,e,n){n&&ci.cleanUp(t),ci[e](t)}function Li(t,e){return[new ni(Ii,t,e),new li(t)]}function zi(t,e){for(const n of t)ci.clean(n),ci.adds(e(n))}function Ui(t){ci.empty(),ci.safeAdds(t)}function Mi(t){ci.empty(),t.forEach((t=>ci.add(t)))}function Hi(t){ci.cleanUp(t),ci.reverse(t.parentElement.children)}function Di(){return Vo.size>0&&new ni((()=>Vo.clear()))}function Pi(t){return(t=Ks(t)).length>0&&new ni((()=>Vo.pushes(t)))}function Fi(e,n){let r=Wo.get();return r&&e.length?e.some((e=>t.contains(e,r,!n)))&&new li(null):null}function Bi(e,n){if(0!==e.length)return n&&!e.every(vs)?(Gs("has_cannot_del",fs(e)),null):new Qo((()=>t(e).remove()))}function ji(t,e,n){return t.length>0&&new Qo(fi[n],t,e)}function Ki(e,n,r,l){if(!xs(n))return Gs("cannot_append",n);if(!e.every(vs))return Gs("has_cannot_del",fs(e));let o=Gi(r,n,e.clone(!0,!0,!0)),i=Di(),s=l&&new Qo((()=>t.empty(n)));return[new li,i,s,new Qo((()=>e.remove())),o.length&&new Qo(fi.insert,r,n,o),...Wi(n,o)]}function Vi(e,n,r,l){if(!xs(n))return Gs("cannot_append",n);let o=Gi(r,n,e),i=Di(),s=l&&new Qo((()=>t.empty(n)));return[new li,i,s,o.length&&new Qo(fi.insert,r,n,o),...Wi(n,o)]}function Wi(t,e){return kn(t)?[new ni((()=>Vo.add(t)))]:[Pi(e),new li(e[0])]}function Gi(e,n,r){try{return Xs((()=>r.map((t=>qr(e,n,{},t))).flat().map((e=>e&&t.remove(e))).filter((t=>t))))}catch(t){throw Js(t,n)}}function Xi(e,n,r){if(n=isNaN(n)?1:n||1/0,!e||n<0)return;let l=t.prevAll(e,((t,e)=>e<=n));return l.length&&r(l,e)}function qi(e,n,r){if(n=isNaN(n)?1:n||1/0,!e||n<0)return;let l=t.nextAll(e,((t,e)=>e<=n));return l.length&&r(l,e)}function Ji(e,n,r){if(n=isNaN(n)?1:n,!e||n<=0)return;let l=t.closest(e,((t,e)=>e==n||t===di));return l&&l!==di&&r(l)}function Yi(e,n,r){if(n=n||0,!e||n<0)return;let l=t.children(e,n);return l&&r(l)}function Qi(t,e){let n=Hn(t,di);return n&&e(n)}function Zi(e,n){return e.size===n.length&&t.every(e,((t,e)=>n[e]===t))}function ts(t,e,n){if(!t.length||t.some(ns))return;return new Qo(fi.styles,t,e,(t=>`${(parseFloat(t)||0)+n}px`))}function es(t,e){return new Qo(fi.styles,t,e,"auto")}function ns(e){return 207===xn(e)||"absolute"!==t.css(e,"position")}function rs(e){let n=new li(null),r=null,l=new Qo((()=>t.normalize(e)));return Vo.has(e)&&(r=new ni(ci.delete,e)),Ei=new ai(e,window.getSelection().getRangeAt(0)),t.trigger(di,g.medIn,null,!0),t.trigger(vi,"hide"),t.trigger(bi,g.insType,g.miniedTpl),[n,r,l,Ei,new li(Ei.elem())]}function ls(e){let n=t.attr(t.elem(e.tagName),"role",t.attr(e,"role"));return[new Qo(fi.newAfter,e,n),...rs(n)]}function os(e,n){let r=xn(n),l=Do[r];return ss(e,C.Keys.miniedSameLine)?Po.has(r)&&ls(n):!!ss(e,C.Keys.miniedLogicLine)&&(function(t,e){return t&&t[1]===xn(e.parentElement)}(l,n)?function(e,n){let r=t.elem(n);return[new Qo(fi.newAfter,e,r),...rs(r)]}(n,l[0]):Po.has(r)&&ls(n))}const is={[g.levelName1]:[fi.newAfter,fi.newBefore],[g.levelName2]:[fi.newAppend,fi.newPrepend]};function ss(t,e){let n=e.split(Oo);return n.length===t.size&&n.every((e=>t.has(e.toLowerCase())))}function as(t){let e=new Map;for(const n of t){let t=n.parentElement;(e.get(t)||e.set(t,[]).get(t)).push(n)}return[...e.values()]}function us(e){let n=Wo.get(),r=t.contains(e,n);try{return r&&Wo.cancel(),Nn(e)}finally{r&&Wo.set(n)}}function cs(t,e){return e=isNaN(e)?1:e,new Array(e).fill().map((()=>Nn(t)))}function fs(t){for(const e of t)if(!vs(e))return e}function ps(t){for(const e of t)if(zn(e))return e}function ds(e,n,r){let l=n.cellIndex(e);return t.isArray(l)?function(t,[e,n],r){let l=new Set;for(let o=e;o<n;o++)t.column(o,r).forEach((t=>l.add(t)));return[...l]}(n,l,r):n.column(l,r)}function hs(e,n){if(!e)return;let r=e.parentElement;if(!t.contains(r,n,!0))return null;for(;n.parentElement!==r;)n=n.parentElement;return n}function ms(t){return(t=t.parentElement)!==di&&t}function gs(t){let e=new Set,n=0;for(const[r,l]of t.entries()){let t=l.parentElement;if(n+=t.childElementCount,e.add(t).size===r)throw Js(_.repeatSibling,l)}if(n===t.size)throw Js(_.aloneSibling,null)}function _s(t,e){return e=e||t[0].tagName,t.every((t=>t.tagName===e))}function ws(e){return t.isArray(e)?e.map((e=>t.fragment(ar(e)))):t.fragment(ar(e))}function vs(t){let e=xn(t);return We(e)||Ge(e)||Je(e)}function ys(t){let e=xn(t);return qe(e)||Ge(e)&&!He(e)}function bs(t){let e=xn(t);return kn(t.parentElement)&&qe(e)||e===Gt}function xs(t){let e=xn(t);return!He(e)&&!Ve(e)}function Es(t,e){return xs({prepend:t,append:t,fill:t,before:t.parentElement,after:t.parentElement,replace:t.parentElement}[e])}function Ts(t){return t.reduce(((t,e)=>t.add(xn(e))),new Set)}function Cs(t){let e=new Set;for(const n of t)n.parentElement&&e.add(n.parentElement);return e}function Ns(e,n,r=1,...l){setTimeout((()=>e.isConnected&&t.trigger(e,n,...l)),r)}function Ss(t){return rl(t.filter((t=>!Ve(xn(t)))))}function $s(e,n,r="text"){return e?t("tr",e).find(n)[r]():null}function As(t,e){return t&&rr(t).then((t=>t?Ks(t).map((t=>Jr(e,t))):[]))}function ks(t){let e=t.commonAncestorContainer;return 3===e.nodeType?e.parentElement:e}function Os(t){let e=[...t.attributes].map((t=>`${t.name}="${t.value}"`)).join(" ");return e?`<${t.tagName} ${e}>`:`<${t.tagName}>`}function Rs(t){return Is(t).outerHTML}function Is(e){let n=t.clone(e);return t.find(Ao,n,!0).forEach((e=>t.removeClass(e,$o))),n}function Ls(t,e,n,r){let l=[...t];return l.length||(l=[...di.children]),n&&(e.TEXT=l.map((t=>t.textContent))),r&&(e.HTML=l.map(Rs)),e}function zs(t,e){let n,r=new Function("$$","$","_",t);try{n=r(e,Us,di)}catch(t){return{type:"error",data:t}}return void 0===n?null:{type:"value",data:n,code:t}}const Us=new Proxy(t,{apply:(t,e,n)=>t(n[0],n[1]||di)});function Ms(t,e){return e.some((e=>""!==t.style[e]))}function Hs(t,e){let n=t[0].style[e];for(const r of t.slice(1))if(r.style[e]!==n)return null;return n}function Ds(e,n){let r=Cn(e),l=[];for(const t of n)(3!==t.nodeType||t.textContent.trim())&&(Bn(t,r)||l.push(t));return l.length?l:function(e){for(const n of e){if(1!==n.nodeType)continue;let e=Ds(n,t.contents(n));if(e)return e}}(n)}function Ps(t){return 3===t.nodeType?t.textContent:t.cloneNode().outerHTML.replace(RegExp(`</${t.tagName}>$`,"i"),"")}function Fs(t,...e){for(const n of e)[n[t],n[t-1]]=[n[t-1],n[t]]}function Bs(t){return Yo.reset(),[...Yo.split(t)].join(" ").trim()}function js(t,e="-"){let n=t.length;for(;n--&&(!t[n]||t[n]===e););return n+1}function Ks(e){return t.isArray(e)?e:[e]}function Vs(t){for(const e of t.values())return e}function Ws(t){return t[t.length-1]}function Gs(e,n=null){if(null===e)return t.trigger(gi,"off");let[r,l]=T[e];t.trigger(Si(gi,n),"on"),t.trigger(t.get("a",gi),"setv",[r,l,l]),E.beeptip&&Ti.play()}function Xs(e){let n=t.config({varyevent:!1,bindevent:!1});try{return e()}finally{t.config(n)}}function qs(t){Ns(_i,g.info,10,t)}function Js(e,n){return t.trigger(Si(gi,n),"on"),t.trigger(t.get("a",gi),"setv",[null,e,e]),E.beeptip&&Ti.play(),new Error(e)}const Ys={[x.select]:null,[x.filter]:null,[x.search]:null,[x.command]:null,[x.calcuate]:null},Qs={[x.select]:function(t,e){if(!t.exec(e,Wo.get()).length)return _.selectNone;return Zs([],t.exec(e,Wo.get()))},[x.filter]:function(t,e){return Zs([],t.exec(e))},[x.search]:function(e,n){let r=(Vo.size?t(Vo):t(di.children)).textNodes(!0,!0).flat(),l=r.length&&e.exec(n,r);if(!l.length)return`${_.searchNothing} ${n}`;let o=l.map((t=>new si(t)));return Zs(o,o.map((t=>t.elem())))},[x.command]:function(t,e){return t.exec(e)},[x.calcuate]:function(t,e){let n=t.exec.bind(t),r=new Zo(n,e,Wo.get());r.changed()&&(Ci(r),r.hasNodes()&&r.warn(_.undoWarn));return r.result()}};function Zs(t,e){return t.concat(Di(),Pi(e),new li(e[0]))}function ta(e){let n={},r=[];for(const l of e){let[e,o]=Qr(l);r.push(o),t.assign(n,e)}return[n,r]}function ea(e,n){let r=function(t){let e=nn[t.toUpperCase()];return Cr[e]?g.convBlocks:Nr[e]?g.convLines:Tr[e]?g.convInlines:null}(e);switch(r){case g.convInlines:return function(t,e){let[n,r]=ta(e),l=r.map((e=>Jr(t,n,e)));return[new Qo(fi.replaces,e,l),l]}(e,n);case g.convLines:return function(e,n){let[r,l]=ta(n),o=l.map((n=>t.isArray(n)?n.map((t=>Jr(e,r,t))):Jr(e,r,n)));return[new Qo(fi.replaces,n,o),o.flat()]}(e,n);case g.convBlocks:return function(t,e){let[n,r]=ta(e),l=null;return Yr(e[0])===g.convLines?(l=Jr(t,n,r,!0),[new Qo(fi.replacex,e,l),[l]]):(l=r.map((e=>Jr(t,n,e,!0))),[new Qo(fi.replaces,e,l),l])}(e,n)}throw new Error(`[${e}] convert is not supported.`)}const na={[Ot]:{self:">h1, >hgroup",prev:null},600:{self:">h1, >hgroup",prev:null},[ie]:{self:">header[role=abstract]",prev:[Ot]},607:{self:">nav[role=toc]",prev:[ie,Ot]},612:{self:">article",prev:[607,ie,Ot]},608:{self:">nav[role=reference]",prev:[612,607,ie,Ot]},609:{self:">aside[role=seealso]",prev:[608,612,607,ie,Ot]},[ae]:{self:">footer",prev:[609,608,612,607,ie,Ot]}},ra={[Ot]:{self:">h1",prev:null},[Rt]:{self:">h2",prev:null},[Lt]:{self:">h4",prev:null},[Yt]:{self:">h5",prev:null},[Mt]:{self:">summary",prev:null},[Ht]:{self:">figcaption",prev:null},[Pt]:{self:">legend",prev:null},[Dt]:{self:">caption",prev:null},516:{self:">thead",prev:[Dt]},517:{self:">tbody:last-of-type",prev:[516,Dt]},518:{self:">tfoot",prev:[517,516,Dt]},[se]:{self:">header",prev:[Rt]},[ae]:{self:">footer",prev:["LastChild"]},[K]:{self:">img",prev:["LastChild"]},LastChild:{self:">:last-child",prev:null}};function la(e,n,r){let l=null;if(!n)return l;for(const o of n)if(l=t.get(r[o].self,e),l)break;return l}function oa(e,n,r){let l=r[xn(n)],o=t.get(l.self,e);return o?new Qo((()=>t.replace(o,n))):(o=la(e,l.prev,r),new Qo(o?()=>t.after(o,n):()=>t.prepend(e,n)))}function ia(e,n,r=di){let l=na[e],o=t.get(l.self,r);if(o)return t.replace(o,n);let i=la(r,l.prev,na);return i?t.after(i,n):t.prepend(r,n)}function sa(){pi.clear(),t.trigger(di,g.undoEvent,!1,!0),t.trigger(di,g.redoEvent,!1,!0)}function aa(t){return _s(t,"SECTION")&&t.some((t=>xn(t)!==ee))}function ua(t){return _s(t,"SECTION")}function ca(t){return 1===t.length&&Xe(xn(t[0]))}function fa(t){let e=[...Ts(t)];return e.length>1||e[0]===Ft&&"OL"!==t[0].parentElement.tagName?null:tl[e[0]]||null}const pa=[function(t){return kn(t[0])},function(){return null!==Ea.convtype()},aa,ua,function(t){return t.every(vs)},ca,fa],da={[ee]:_a,[ne]:_a,[re]:_a,[le]:_a,[oe]:_a,[ue]:_a,621:function(t){return wa(t,">caption, >thead, >tfoot")},[Wt]:null,[se]:ga,[ae]:ga,[_e]:ga,[we]:ga,[ve]:function(t){return wa(t,">summary")}};function ha(t){let e=da[t];return null===e?null:e||ma}function ma(e){return t.children(e)}function ga(t){return wa(t,">h4")}function _a(t){return wa(t,">h2")}function wa(e,n){let r=t.children(e);for(const l of t.find(n,e)){let t=r.indexOf(l);t>=0&&r.splice(t,1)}return r}function va(e,n){let r=xn(e);if(qe(r))return!Ke(r)&&n.every(kn)&&t(n).contents().flat();let l=[...Ts(n)];return 621===r?1===l.length&&621===l[0]&&function(t,e){let n=Un(t).cols();return e.every((t=>n===Un(t).cols()))}(e,n)&&ya(n):function(t,e){let n=dn[t];return void 0===n?!He(t)&&!Ve(t)&&e.every((e=>e===t)):e.every((t=>n===dn[t]))}(r,l)&&ya(n)}function ya(t){let e=[];for(const n of t){let t=ha(xn(n));t&&e.push(...t(n))}return e}function ba(t,e){let n=xn(t);return qe(n)?Ke(n)?t:function(t){for(const e of t)if(!kn(e))return e}(e):621===n?function(t,e){let n=Un(t).cols();for(const t of e)if("TABLE"!==t.tagName||n!==Un(t).cols())return t;return null}(t,e):He(n)||Ve(n)?t:Fn(t,e)}const xa={focusPrevious(t){Xi(Wo.get(),t,(t=>$i(Ws(t))))},focusNext(t){qi(Wo.get(),t,(t=>$i(Ws(t))))},focusParent(t){Ji(Wo.get(),t,(t=>$i(t)))},focusChild(t){Yi(Wo.get(),t,(t=>$i(t)))},focusItemTop(){Qi(Wo.get(),(t=>$i(t)))},focusSetNext(){let t=Wo.get(),e=Vo.next(t);e&&e!==t&&($i(e),qs(`${Vo.index(e)+1}/${Vo.size}`))},focusSetPrev(){let t=Wo.get(),e=Vo.prev(t);e&&e!==t&&($i(e),qs(`${Vo.index(e)+1}/${Vo.size}`))},focusPick2(){let t=Wo.get();t&&Go.cando(t)&&Ci(new li(null),new ri(t),new li(t))},click(e,n){let r=Wo.get(),l=e.data;if(ss(n,C.Keys.elemFocus))return $i(l);if(ss(n,C.Keys.acrossSelect)){let e=hs(r,l),n=e&&((o=r)===(i=e)?[]:[o,...t.next(o,i,!0)?t.nextUntil(o,i):t.prevUntil(o,i),i]);return e&&n.length&&Ci(new ni(ki,n,r),new li(e))}var o,i;if(ss(n,C.Keys.smartSelect)){let t=hs(r,l);return t&&Ci(...Li(t,"turn"))}if(ss(n,C.Keys.parentFocus)){let t=ms(l);return t&&$i(t)}if(ss(n,C.Keys.parentSelect)){let t=ms(l);return t&&Ci(...Li(t,"turn"))}if(ss(n,C.Keys.turnSelect))return Ci(...Li(l,"turn"));ss(n,C.Keys.onlyParent)&&(l=ms(l)),Vo.has(l)&&r===l&&1===Vo.size||Ci(...Li(l,"only"))},__click:1,pathTo(e,n){if(t.intoView(e.data,0),!ss(n,C.Keys.elemFocus))return ss(n,C.Keys.turnSelect)?Ci(...Li(e.data,"turn")):void(Vo.has(e.data)||Ci(...Li(e.data,"add")));Wo.set(e.data)},__pathTo:1,turn(){let t=Wo.get();t&&Ci(...Li(t,"turn"))},only(){let t=Wo.get();!t||1===Vo.size&&Vo.first()===t||Ci(...Li(t,"only"))},reverse(){let t=Wo.get();t&&Ci(new ni(Hi,t))},siblings(){let e=Wo.get();if(!e)return;let n=t.siblings(e);n.length&&Ci(new ni(ki,n,e))},tagsame(){let e=Wo.get();if(!e)return;let n=t.siblings(e,e.tagName);n.length&&Ci(new ni(ki,n,e))},tagsame2(){let e=Wo.get();if(!e)return;let n=t.find(`>* >${e.tagName}`,e.parentElement.parentElement);n.splice(n.indexOf(e),1),n.length&&Ci(new ni(Oi,n,e))},tagsame2x(){let e=Wo.get();if(!e)return;let n=e.parentElement,r=null;if("TR"===n.tagName){let t=n.parentElement;r=ds(e,Un(t.parentElement),t)}else r=t.find(">* >"+`${(l=e).tagName}:nth-child(${t.prevAll(l).length+1})`,n.parentElement);var l;r.splice(r.indexOf(e),1),r.length&&Ci(new ni(Oi,r,e))},cleanSiblings(){let e=Wo.get();if(!e||1===Vo.size&&Vo.has(e))return;let n=t.children(e.parentElement).filter((t=>Vo.has(t)));Ci(new ni(ci.removes,n),new ni(Li,e,"add"))},cleanOthers(){let t=Wo.get();!t||1===Vo.size&&Vo.has(t)||Ci(new ni(ci.empty),new ni(Li,t,"safeAdd"))},contentBoxes(){let t=Wo.get();if(!t)return;let e=Mn(t);e.some((t=>!Vo.has(t)))&&Ci(new ni(Ri,e,"adds"),new li(e[0]))},contentBoxesStart(){let t=Wo.get();if(!t)return;let e=Mn(t);e.some((t=>!Vo.has(t)))&&Ci(new ni(Ri,e,"unshift"),new li(e[0]))},previous(t){Xi(Wo.get(),t,((t,e)=>Ci(new ni(ki,t,e),new li(Ws(t)))))},next(t){qi(Wo.get(),t,((t,e)=>Ci(new ni(ki,t,e),new li(Ws(t)))))},parent:t=>Ji(Wo.get(),t,(t=>Vo.has(t)||Ci(...Li(t,"add")))),child:t=>Yi(Wo.get(),t,(t=>Vo.has(t)||Ci(new ni(Ii,t,"safeAdd",!0),new li(t)))),itemTop(){Qi(Wo.get(),(t=>Vo.has(t)||Ci(...Li(t,"add"))))},onlyPrevious(t){Xi(Wo.get(),t,(t=>Ci(...Li(Ws(t),"only"))))},onlyNext(t){qi(Wo.get(),t,(t=>Ci(...Li(Ws(t),"only"))))},onlyParent(t){Ji(Wo.get(),t,(t=>Ci(...Li(t,"only"))))},onlyChild(t){Yi(Wo.get(),t,(t=>Ci(...Li(t,"only"))))},onlyItemTop(){Qi(Wo.get(),(t=>Ci(...Li(t,"only"))))},siblingsVF(){let e=[...Vo];gs(e),Ci(new ni(zi,e,(e=>t.siblings(e))))},tagsameVF(){let e=[...Vo];gs(e),Ci(new ni(zi,e,(e=>t.find(`>${e.tagName}`,e.parentElement))))},previousVF(e){let n=[...Vo];gs(n),(e=isNaN(e)?1:e||1/0)>0&&Ci(new ni(zi,n,(n=>t.prevAll(n,((t,n)=>n<=e)))))},nextVF(e){let n=[...Vo];gs(n),e=isNaN(e)?1:e||1/0,Ci(new ni(zi,n,(n=>t.nextAll(n,((t,n)=>n<=e)))))},contentBoxesVF(){let t=[...Vo].map((t=>Mn(t))).flat();Zi(Vo,t)||Ci(new ni(Ui,t),new li(t[0]))},childVF(e){e=e||0;let n=t.map(Vo,(n=>t.children(n,e)));Zi(Vo,n)||Ci(new ni(Ui,n),new li(n[0]))},parentVF(t){let e=new Set;for(const n of Vo)Ji(n,t,(t=>e.add(t)));e=[...e],Zi(Vo,e)||Ci(new ni(Mi,e),new li(e[0]))},itemTopVF(){let t=new Set;for(const e of Vo)Qi(e,(e=>t.add(e)));t=[...t],Zi(Vo,t)||Ci(new ni(Mi,t),new li(t[0]))},selectSort(){let e=t(Vo).sort().item();e.length<2||Ci(new ni(Ui,e),new li(e[0]))||qs(_.sortCompleted)},selectReverse(){let e=t(Vo).sort().item().reverse();e.length<2||Ci(new ni(Ui,e),new li(e[0]))||qs(_.sortCompleted)},toText(){let e=t(Vo);if(0!==e.length&&function(t){for(const e of t)if(e.childElementCount>0)return!0;return!1}(e))return e.every(ys)?void Ci(Fi(e),new Qo(fi.toText,e)):Gs("need_conelem",function(t){for(const e of t)if(!ys(e))return e}(e))},__toText:null,unWrap(){let e=t(Vo);if(0!==e.length)return e.every(bs)?void Ci(Fi(e,!0),Di(),new Qo(fi.unWrap,e)):Gs("both_conelem",function(t){for(const e of t)if(!bs(e))return e}(e))},__unWrap:null,deletes(){let e=t(Vo),n=Bi(e,!0);return n&&Ci(Fi(e,!0),Di(),n),!!n},deleteForce(){let e=t(Vo),n=Bi(e);n&&Ci(Fi(e,!0),Di(),n)},deleteContents(){let e=t(Vo).map((t=>Mn(t))).flat(),n=function(e){if(0!==e.length)return new Qo((()=>t(e).empty()))}(e);n&&Ci(Di(),Fi(e),n,Pi(e))},elementCloneSelf(e){let n=t(Vo);if(!n.length)return;if(n.some(zn))return Gs("only_child",ps(n));let r=n.map((t=>us(t)));1===r.length&&(r=[cs(r[0],e)]),Ci(new li,Fi(n,!0),Di(),new Qo(fi.cloneAfter,n,r),Pi(r.flat()))},elementCloneTeam(e){let n=t(Vo);if(!n.length)return;if(n.some(zn))return Gs("only_child",ps(n));let r=function(t){let e=[t.shift()],n=[e];for(const r of t)r.previousElementSibling===Ws(e)?e.push(r):n.push(e=[r]);return n}(n.sort()),l=r.map((t=>Ws(t))),o=r.map((t=>t.map((t=>us(t)))));1===o.length&&1===o[0].length&&(o[0]=cs(o[0][0],e)),Ci(new li,Di(),new Qo(fi.cloneAfter,l,o),Pi(o.flat()))},toUpperCase(){if(!Vo.size)return;let e=t(Vo).textNodes(!0,!0).flat();e.length&&Ci(new ti(e,(t=>t.toUpperCase())))},toUpperCase1(){if(!Vo.size)return;let e=t(Vo).textNodes(!0,!0).map((t=>t[0]));e.length&&Ci(new ti(e,(t=>t.replace(/[a-z]/,(t=>t.toUpperCase())))))},toLowerCase(){if(!Vo.size)return;let e=t(Vo).textNodes(!0,!0).flat();e.length&&Ci(new ti(e,(t=>t.toLowerCase())))},elementFill(){let e=Wo.get();if(!e||!Vo.size)return;if(Vo.has(e))return Gs("cannot_selected",e);let n=Ki(t(Vo),e,null,!0);n&&Ci(...n)},elementCloneFill(){let e=Wo.get();if(!e||!Vo.size)return;if(1===Vo.size&&Vo.has(e))return;let n=Vi(t(Vo).clone(),e,null,!0);n&&Ci(...n)},elementAppend(){let e=Wo.get();if(!e||!Vo.size)return;if(Vo.has(e))return Gs("cannot_selected",e);let n=Ki(t(Vo),e);n&&Ci(...n)},elementCloneAppend(){let e=Wo.get();if(!e||!Vo.size)return;let n=Vi(t(Vo).clone(),e);n&&Ci(...n)},elementBefore(){let e=Wo.get();if(!e||!Vo.size)return;if(Vo.has(e))return Gs("cannot_selected",e);let n=Ki(t(Vo),e.parentElement,e);n&&Ci(...n)},elementCloneBefore(){let e=Wo.get();if(!e||!Vo.size)return;let n=Vi(t(Vo).clone(),e.parentElement,e);n&&Ci(...n)},elementAfter(){let e=Wo.get();if(!e||!Vo.size)return;if(Vo.has(e))return Gs("cannot_selected",e);let n=Ki(t(Vo),e.parentElement,t.nextNode(e));n&&Ci(...n)},elementCloneAfter(){let e=Wo.get();if(!e||!Vo.size)return;let n=Vi(t(Vo).clone(),e.parentElement,t.nextNode(e));n&&Ci(...n)},movePrevious(e){let n=t(Vo).sort(),r=n[0];if(!((e=isNaN(e)?1:e)<0||!n.length||function(e){let n=t.prevNode(e,!1,!0);return!n||On(n)}(r)))return n.some(Rn)?Gs("has_fixed2",function(t){for(const e of t)if(Rn(e))return e}(n)):void Ci(new Qo(fi.movePrev,as(n),e))},moveNext(e){let n=t(Vo).sort(),r=Ws(n);if(!((e=isNaN(e)?1:e)<0||!n.length||function(e){let n=t.nextNode(e,!1,!0);return!n||Rn(n)}(r)))return n.some(On)?Gs("has_fixed1",function(t){for(const e of t)if(On(e))return e}(n)):void Ci(new Qo(fi.moveNext,as(n),e))},moveToStart(){this.movePrevious(0)},moveToEnd(){this.moveNext(0)},indentReduce(){let e=t(Vo);if(e.length)return aa(e)?void Ci(new Qo(fi.sectionsUp,e)):Gs("only_section_up",function(e){for(const n of e)if(!Ln(n)||"s1"===t.attr(n,"role"))return n}(e))},indentIncrease(){let e=t(Vo);if(!e.length)return;if(!ua(e))return Gs("only_section",function(t){for(const e of t)if(!Ln(e))return e}(e));let n=function(t){let e=[];for(const n of t){let t=xn(n);e.push([n,Jr(t,{h2:_.sectionH2})])}return!!e.length&&e}(e);Ci(new Qo(fi.sectionsDown,n))},reversePlaces(){let e=t(Vo).sort(),n=as(e);if(!(e.length<2||n.every((t=>t.length<2))))return e.some(In)?Gs("has_fixed",function(t){for(const e of t)if(In(e))return e}(e)):void Ci(new Qo(fi.reverses,n))},contentsMerge(){let e=t(Vo),n=e.shift();if(!e.length)return;let r=va(n,e);if(!r)return Gs("merge_types",ba(n,e));Ci(Fi(e,!0),Di(),new Qo(fi.merges,n,r,e),...Li(n,"safeAdd"))},normalize(){let e=new Qo((()=>t.normalize(di)));e.changed()&&Ci(e)},moveToLeft(){let t=[...Vo],e=ts(t,"left",-1);e&&Ci(e,es(t,"right"),new oi(!0))},moveToLeftTen(){let t=[...Vo],e=ts(t,"left",-10);e&&Ci(e,es(t,"right"),new oi(!0))},moveToRight(){let t=[...Vo],e=ts(t,"left",1);e&&Ci(e,es(t,"right"),new oi(!0))},moveToRightTen(){let t=[...Vo],e=ts(t,"left",10);e&&Ci(e,es(t,"right"),new oi(!0))},moveToUp(){let t=[...Vo],e=ts(t,"top",-1);e&&Ci(e,es(t,"bottom"),new oi(!0))},moveToUpTen(){let t=[...Vo],e=ts(t,"top",-10);e&&Ci(e,es(t,"bottom"),new oi(!0))},moveToDown(){let t=[...Vo],e=ts(t,"top",1);e&&Ci(e,es(t,"bottom"),new oi(!0))},moveToDownTen(){let t=[...Vo],e=ts(t,"top",10);e&&Ci(e,es(t,"bottom"),new oi(!0))},paste(t,e){let n=[...Vo].map((t=>Mn(t))),r=n.flat(),l=e?"appends":"fills";r.length&&Ci(Fi(r),...function(t,e,n){return 1===t.length?[ji(t[0],e.join("\n"),n)]:(1===e.length&&(e=new Array(t.length).fill(e[0])),t.map(((t,r)=>ji(t,e[r],n))))}(n,t.data,l))},__paste:1,setStyle(e,n,r){(function(e,n,r){return t.isArray(n)?e.some((t=>n.some((e=>t.style[e]!==r)))):e.some((t=>t.style[n]!==r))})(e.data,n,r)&&Ci(new Qo(fi.styles,e.data,n,r),new oi)},__setStyle:1,eraseStyle(t,e){let n=null;e=e.split(Oo);for(const r of t.data)if(Ms(r,e)){n=!0;break}n&&Ci(new Qo(fi.styles,t.data,e,null),new oi)},__eraseStyle:1,brushStyle(e){let n=e.data,r=t.attr(n,"style"),l=Vo.size,o=null;!r||!l||1===l&&Vo.has(n)||(Vo.has(n)&&(o=new ni(ci.delete,n)),Ci(o,new Qo(fi.attrs,[...Vo],"style",r),new oi))},__brushStyle:1,clearStyle(e){let n=null;for(const r of e.data)if(null!==t.attr(r,"style")){n=!0;break}n&&Ci(new Qo(fi.styles,e.data,null),new oi)},__clearStyle:1,attrUpdate(t,e){1===Vo.size&&Ci(new Qo(fi.attrs,[...Vo],e,t.data),new oi)},__attrUpdate:1,deleteAttr(t){Ci(new Qo(fi.attrs,[...Vo],t.data,null),new oi)},__deleteAttr:1,htmlUpdate(e){if(1!==Vo.size||!e.data.length)return;let n=[...Vo],r=function(e){let n=t.fragment(e);for(const e of t.find(Ao,n))t.removeClass(e,$o);return t.contents(n)}(e.data);Ci(Fi(n,!0),Di(),new Qo((()=>t.replace(n[0],r))))},__htmlUpdate:1,runScript(e,n,r,l){let o=e.data.trim();if(!o)return null;if("editor"===n){let e=new Zo(zs,o,t(Vo));return e.changed()&&(Ci(e),e.hasNodes()&&e.warn(_.undoWarn)),e.result()||bl(o)||null}return function(t){let e=Qn.pick();return new Promise(((n,r)=>{e.onmessage=t=>{e.onmessage=null,Qn.add(e),t.data.error?r(t.data.error):n(t.data.result)},e.postMessage(t)}))}(Ls(Vo,{code:o},r,l)).then((t=>({type:"value",data:t,code:o}))).catch((t=>({type:"error",data:t,code:""})))},__runScript:1,insResult(e,n,r){let l=e.data.trim(),o=[...Vo];if(!o.length||!r||!l)return;let i=function(t,e){for(const n of t)if(!Es(n,e))return n;return null}(o,r);if(i)return Gs("cannot_append",i);let s=function(e,n){switch(e){case"text":return t(t.Text(n,!0));case"html":return t(t.fragment(n).children)}throw new Error("can't to here.")}(n,l),a=Di(),u=o.map((t=>function(t,e,n){return Gi(...{prepend:[null,t],append:[null,t],fill:[null,t],before:[t,t.parentElement],after:[t,t.parentElement],replace:[t,t.parentElement]}[e],n)}(t,r,s.clone())));Ci(new li,a,new Qo(fi.alignInsert,o,r,u))},__insResult:1,propUpdate(e,...n){let r=[...Vo],l=(o=xn(r[0]),Il[o]||((e,n,r)=>t.attr(e,n,r)));var o;if(1===r.length)return Ci(new Qo(l,r[0],e.data,...function(t,...e){let n=Ll[xn(t)];return n?n(t,...e):function(t){return t.map((t=>""===t?null:t))}(e)}(r[0],...n)),new oi(!0));let i=function(t,...e){let n=xn(t[0]),r=zl[n];return r?r(t,...e):Vl(t,function(t){return t.map((t=>""===t||null===t?void 0:t))}(e))}(r,...n);Ci(...r.map(((t,n)=>new Qo(l,t,e.data,...i[n]))))},__propUpdate:1,cmdRun(e,n){let r=e.data,l=r.trim()&&Qs[n](Ys[n],r);return No(n).add(e.data),t.isArray(l)?(Ns(di,"focus.content",1,null,!0),Ci(...l)||null):l},__cmdRun:1,pluginsRun(r){let l=(i=r.data,to.get(i)||null),o=t.attr(r.data,"title")||"";var i;if(!l)throw new Error("not found the plugins.");return function(t,e){let n=new Worker(t);return new Promise(((t,r)=>{n.onmessage=e=>{n.terminate(),e.data.error?r(e.data.error):t(e.data)},n.postMessage(e)}))}(`${y}${b.plugRoot}/${l}/${b.plugMain}`,Ls(Vo,{INFO:{}},!0,!0)).then((t=>function(t,r,l){let o=e.get(r);return l=t.title||l,t.node&&!t.error?[t.result,o.node(t.node),l]:(o=e.get(n),[t.error||t.result,o.node(b.plugResult),l])}(t,l,o)))},__pluginsRun:1,editUndo(){t.trigger(di,g.undoEvent,Ei?(document.execCommand("undo"),document.queryCommandEnabled("undo")):(pi.undo(),pi.canUndo()),!0)},editRedo(){t.trigger(di,g.redoEvent,Ei?(document.execCommand("redo"),document.queryCommandEnabled("redo")):(pi.redo(),pi.canRedo()),!0)},miniedIn(){let t=Vo.first();if(t){if(!kn(t))return $i(t),Gs("need_conelem",t);Ci(...rs(t)),Ei.active()}},miniedInEnd(){let t=Vo.first();if(t){if(!kn(t))return $i(t),Gs("need_conelem",t);Ci(...rs(t)),Ei.activeEnd()}},properties(){let r=t(Vo),l=fa(r);if(!l)return Gs("not_property",r[0]);!function(r){e.get(n).get(g.modalProp).then((e=>t.trigger(yi,"open",[r,e])))}(l)},elementRange(){let e=[...Vo];if(!ca(e))return Gs("not_elrange",e[0]);t.select(e[0],!0),Ns(e[0],"_mouseup",10,null,!0)}},Ea={undo(){xa.editUndo()},redo(){xa.editRedo()},sels:()=>t(Vo),esize:()=>Vo.size,sel0:()=>Vs(Vo)||null,efocus:()=>Wo.get(),tobj:()=>Vo.size?Un(function(t){switch(t.tagName){case"TR":return t.parentElement.parentElement;case"TBODY":case"THEAD":case"TFOOT":case"CAPTION":return t.parentElement;case"TH":case"TD":return t.parentElement.parentElement.parentElement;case"TABLE":return t}throw new Error("not in table element.")}(Vo.first())):null,trbox(){let t=Vo.first();return"TR"===t.tagName?t.parentElement:t},tsecbox(){let t=Vo.first();return"TABLE"===t.tagName?t:t.parentElement},codebox(){let t=Vo.first();if(!t)return null;switch(xn(t)){case 626:return t.firstElementChild;case lt:case pe:return t;case Xt:return t.parentElement}throw new Error("bad type of element.")},attrns:t=>[...t.data.attributes].map((t=>t.name)),__attrns:1,obtname(e){let n=e.data,r=t=>Ko.has(t)?"on by to":t.replace(Oo,"");return t.isArray(n)?[...new Set(n.map(r))]:r(n)},__obtname:1,obtsplit:t=>(Yo.reset(),t.data.map((t=>t?[...Yo.split(t)].map((t=>t.trim())):[]))),__obtsplit:1,obtval:t=>function([t,e,n]){return e.length=js(e),n.length=js(n),t.length=Math.max(js(t),e.length,n.length),[t,e,n]}(t.data.map((t=>t.map(Bs).map((t=>t||"-"))))).map((t=>t.join(";\n")||null)),__obtval:1,source:t=>Si(t.data),__source:1,rngok(t){let e=xn(ks(t.data));return t.data.detach(),qe(e)||622===e&&!t.data.collapsed&&!t.data.toString()},__rngok:1,menupos(e,n,[r,l]){let o=t.outerWidth(e.data),i=t.offset(n),s=t.innerWidth(n),a=l-i.top+t.scrollTop(n)+w.popupGapTop;return r+o<s+i.left?[r-i.left+"px",`${a}px`]:[s-o-w.popupGapRight+"px",`${a}px`]},__menupos:1,submenu(e){let n=t.parent(e.data),r=t.outerWidth(n)-1+"px",l=t.children(e.data,-1),o=parseFloat(t.css(n,"right"));return t.outerWidth(l)>o?{left:"auto",right:r}:{left:r,right:"auto"}},__submenu:1,convtype(){let t=new Set;for(const e of Vo)t.add(Yr(e));if(t.size>1)return null;let e=Vs(t);return e===g.convLines?g.convBlocks:e},__convtype:null,roleinfo(e,n){let r=t.attr(e.data,"role");return r?`${n}:${r}`:n},__roleinfo:1,elemSelf(t){let e=t.data;return e?Os(e).replace(Uo,""):null},__elemSelf:1,cmable(e){let n=[...Vo];return 0===n.length?[]:t.map(pa,((t,r)=>t(n)?e.data[r]:null))},__cmable:1,inlable(e,n,r){let l=[...r.cloneContents().childNodes];return 0===l.length?[]:e.data.filter((e=>function(t,e,n){"a"===t&&622===xn(n)&&(t="fcona");let r=Jr(t),l=xn(r,n),o=Cn(l);return e.every((t=>o.has(xn(t,r))))&&Tn(n,l)}(t.attr(e,n),l,ks(r))))},__inlable:1,inslist(r,l){if(!r.data.length)return null;let o=Bo[l](r.data),i=e.get(n);return t.isArray(o)?o.map((t=>i.node(t))):function(e,n){let r=[];for(const[l,o]of e){if(!o.length)continue;let e=t.attr(t.elem("optgroup"),"label",l);t.fill(e,o.map((t=>n.node(t)))),r.push(e)}return r}(o,i)},__inslist:1,ismixed:t=>(t.data===g.levelName1?[...Cs(Vo)]:[...Vo]).some((t=>zo.test(t.tagName)&&3===tn(t))),__ismixed:1,pretreat2(t,e,n){let r=t.data;return r=n?r.trim().split(Ro):[r],e?r.map((t=>t.trim().replace(Io,"$1"))):r},__pretreat2:1,pretreat1(e,n){let r=e.data;return t.isArray(r)?n?r.map((t=>t.replace(Io,"$1"))):r:n?r.trim().replace(Io,"$1"):r},__pretreat1:1,trfmt(e,n){if(!n)return[E.mdline?ws(e.data):e.data];let r=function(t){for(const e of t)if(!Mo.test(e))return e;return null}(e.data);if(r)throw Js(`${_.trfmtError}${r}`,null);let l=E.mdline?e=>t.fragment(ar(e)):t=>t;return e.data.map((t=>t.match(Mo)[1].split(Ho).map(l)))},__trfmt:1,splitx:(t,e)=>t.data.trim().split(e?Ro:Lo),__splitx:1,k3edit(e,n,r,l,o){let i=wr(r,!0,e.data),s=l&&+t.val(l);switch(n){case"Enter":return`\n${a=i,a.substring(0,gr(a,1/0))||" "}`;case"Tab":return function(t,e){return e>0?" ".repeat(e-_r(t)%e):"\t"}(i,s)}var a;return s>0&&!r.toString()&&i.endsWith(" ".repeat(s))&&(o&&(s=i.length),r.setStart(r.endContainer,r.endOffset-s),r.setEnd(r.endContainer,r.endOffset)),null},__k3edit:1,indentcut(t,e){if(e)return t.data;let n=t.data.split(Lo).filter((t=>!!t)),r=function(t){let e=1/0;for(const n of t)if(e=gr(n,e),!e)return 0;return e}(n);return r?n.map((t=>t.substring(r))).join("\n"):t.data},__indentcut:1,hlcode:(t,e,n)=>vr(t.data.split(Lo),n,e),__hlcode:1,codels:t=>kl(null,t.data,Al),__codels:1,codeblo:(t,{lang:e})=>kl(e,t.data,$l),__codeblo:1,image3:(e,n)=>"svg"===n?t.svg({html:e.data}):rr(e.data).then((t=>Jr(P,function(t){let[e,n]=t;return"string"!=typeof e&&([n,e]=[e,n]),Object.assign({src:e},n)}(t)))),__image3:1,mediasubs(t,e){let n=As(t.data.trim(),B);return void 0===e?n:Promise.all([n,As(e.trim(),F)])},__mediasubs:1,picsubs:t=>As(t.data.trim(),j),__picsubs:1,cbstate(t,e,n){if(!t.data.length)return null;let r=t.data[0].style[e]===n;for(const l of t.data.slice(1)){if(l.style[e]===n!==r)return[!1,!0]}return[r,!1]},__cbstate:1,styVal:(e,n)=>e.data.length?t.isArray(n)?n.map((t=>Hs(e.data,t))):Hs(e.data,n):null,__styVal:1,unitVal(t){let e=t.data[0].value,n=t.data[1].value;return isNaN(parseFloat(e)-e)?e:e+n},__unitVal:1,styName:(t,e)=>t.data.length?e.split(Oo).filter((e=>function(t,e){return t.every((t=>""!==t.style[e]))}(t.data,e))):null,__styName:1,styKey:(t,e)=>t.data.length?e.split(Oo).filter((e=>function(t,e){return e+=":",t.every((t=>t.style.cssText.includes(e)))}(t.data,e))):null,__styKey:1,cleanHTML:t=>Rs(t.data),__cleanHTML:1,inlineHTML(e){let n=t.fragment(e.data);return t("*",n).removeAttr("style"),Sn(n).map(ur).map((t=>t.nodeType?t.outerHTML:t)).join("").trim().replaceAll("&nbsp;"," ").replace(/(\s)\s+/g,"$1")},__inlineHTML:1,mdline:t=>E.mdline&&t.data?ws(t.data):t.data,__mdline:1,cmdclear(){this.cmdNavTemp=null},ecancel(){(Vo.size||Wo.get())&&Ci(new li(null),new ni(ci.empty))},puthtml(e){let n=t.fragment(e.data);Ci(new li(null),Di(),new Qo((e=>t.fill(di,e)),[...n.childNodes]))},__puthtml:1,heading(e){if(di.childElementCount>0)return;Ci(new Qo((e=>t.prepend(di,e)),t.elem("h1",e.data)))},__heading:1,errmsg(t,e){ss(e,C.Keys.elemFocus)&&$i(t.data)},__errmsg:1,chapter(e){let n=e.data,r=1===n.length&&0==n[0]?di.firstElementChild:t.get(n.map((t=>`>section:nth-of-type(${t})`)).join(" ")+" >h2",t.get("article",di));r&&t.intoView(r,1,1)},__chapter:1,save(e){let n=t(e.data.children).map(Rs).join("");return g.saver(n)||Jo.set(g.storeMain,n),_.localStoreDone},__save:1,export:e=>(e.data.length?e.data:t.children(di)).map(Rs).join(""),__export:1,export2(e){let n=Is(di),r=t.get("article",n),l=Jr(Jt,null,e.data);return ia(607,Jr(607,{h4a:l},r),n),t.html(n)},__export2:1,nicehtml(e,n,r){let l=isNaN(n)?"\t":" ".repeat(n),o=[...t.fragment(e.data).children];try{return o.map((t=>sr(t,r,l))).join("").trim()}catch(e){t.trigger(t.get(`#${b.sourceTips}`),"show")}},__nicehtml:1,blankline(t,e,n){if(!e)return;let r=wr(n,!0,t.data);r.length>1||" "!==r[0]||(n.setStart(n.endContainer,n.endOffset-1),n.setEnd(n.endContainer,n.endOffset))},__blankline:1,toclist:e=>Ur(t.find(">section",e.data)),__toclist:1,medpass(e,n){let r=function(){Ei.done();let e=Ei.elem();return Ni(),"H2"===e.tagName&&t.trigger(wi,g.medOk,e),t.trigger(di,g.medOk,null,!0),t.trigger(vi,"show"),t.trigger(bi,g.insType,g.normalTpl),Ns(xi,g.evnFollow),Ei=null,e}();if("Tab"===e.data)return xa.miniedIn();let l=os(n,r);l&&(Ci(...l),Ei.active())},__medpass:1,medcancel(){pi.pop(),Ni(),Ei=null,t.trigger(vi,"show"),t.trigger(bi,g.insType,g.normalTpl)},__medcancel:null,rngelem(t,e){"a"===e&&622===xn(ks(t.data))&&(e="fcona");let n=Di(),r=new li(null),l=new ii(t.data,e),o=l.elem();Ci(n,r,l,new ni(Ii,o,"safeAdd"),new li(o)),function(t,e){return jo.has(t)&&!e.completed()}(e,l)&&xa.properties()},__rngelem:1,cmenudo(t){let e=Fo[t.data];e&&xa[e]()},__cmenudo:1,convert(t){if(!Vo.size)return;let e=[...Vo],n=Fi(e,!0),r=Di(),[l,o]=ea(t.data,e);Ci(n,r,l,Pi(o)),jo.has(t.data)&&xa.properties()},__convert:1,croptr(e,n){if(n<=0)return;let r=e.data,l=n-r.rows.length;l&&function(e,n,r){if(n<0)return e.removes(n,null,r);e.inserts(n,null,r).map((t=>[...t.children])).flat().forEach((e=>t.attr(e,"contenteditable",!0)))}(t.table(r.parentElement),l,r)},__croptr:1,colcrop(e,n){if(n<=0)return;let r=t.table(e.data),l=n-r.cols()+1;l&&function(e,n){if(n<0)for(;n++<0;)e.removeColumn(-1);else(function(t,e){let n=[];for(;e-- >0;)n.push(t.insertColumn(t.newColumn()));return n})(e,n).flat().forEach((e=>t.attr(e,"contenteditable",!0)))}(r,l)},__colcrop:1,inserts(e,n,r){let l=[...Vo],o=function(e,n){if(n<2)return[e];if(e.length>1)return e;let r=e[0];for(let l=1;l<n;l++)e.push(t.clone(r));return e}(t(e.data),l.length),i=Di(),s=function(t,e,n,r){let l=[];for(const[o,i]of t.entries()){let t=e[o];null!=t&&(l.push(new Qo(is[r][+n],i,t)),(3===t.nodeType||1===t.length&&3===t[0].nodeType)&&l.push(new ei(t[0]||t)))}return l}(l,o,n,r),a=o.flat().filter((t=>1===t.nodeType&&!$n(t)));Ci(i,...s,Pi(a),a[0]&&new li(a[0]))},__inserts:1,topinsert(t,e){let n=Vo.first(),r=e===g.levelName1?n.parentElement:n;Ci(Di(),oa(r,t.data,na),...Li(t.data,"safeAdd"))},__topinsert:1,fixinsert(e,n){let r=n===g.levelName1?[...Cs(Vo)]:[...Vo],l=function(e,n){if(e=Ks(e),n<2||e.length>1)return e;let r=e[0];for(let l=0;l<n-1;l++)e.push(t.clone(r));return e}(e.data,r.length);Ci(Fi(r),Di(),...function(t,e){let n=[];return t.forEach(((t,r)=>null!=e[r]&&n.push(oa(t,e[r],ra)))),n}(r,l),Pi(l),new li(l[0]))},__fixinsert:1,instbody(e,n,r){let l=e.data,o=Vo.first(),i=r===g.levelName1?o.parentElement:o,s=Un(i),a=Fi([i]),u=Di(),c=null;n?("TBODY"!==o.tagName&&(o=s.body(!0)),c=new Qo(fi.newAppend,o,t.children(l)),l=null):("TBODY"!==o.tagName&&(o=t.get("tbody:last-of-type",i)),c=new Qo(fi.newAfter,o,l)),Ci(a,u,c,...Li(l||o,"safeAdd"))},__instbody:1,table(t,e,[n,r,l,o]){let i=t.data,s=l?"":":not(:first-child)",a=l?"th,td":"td",u=$s(r&&i.tHead,`th${s}`),c=$s(i.tBodies[0],a),f=$s(o&&i.tFoot,a);return Jr("table",{cols:c[0].length-!!l,border:n,caption:e,th0:l=!!l,head:u,foot:f},c,!0)},__table:1,codelang(e,n,r){let l=e.data;if(n===t.attr(r,"-lang"))return l;for(const e of l)t.attr(e,"-lang")||t.attr(e,"-lang",n);return l},__codelang:1,checkhtml(e,n){let r=t.fragment(n),l=Ds(e.data.parentElement,t.contents(r));return l?l.map(Ps):null},__checkhtml:1,attrlist(e,n){let r=new Set(n);for(const n of e.data){let e=t.prop(n,"value");r.has(e)?r.delete(e):t.remove(n)}return[...r]},__attrlist:1,obtline(e,n,r,l){let o=t.siblingNth(e.data);return o<n.length&&n.splice(o,0,""),o<r.length&&r.splice(o,0,""),o<l.length&&l.splice(o,0,""),t.prop(t.clone(e.data),"text",null)},__obtline:1,obtdel(e,n,r,l){let o=t.siblingNth(e.data)-1;return n.splice(o,1),r.splice(o,1),l.splice(o,1),e.data},__obtdel:1,obtswap(e,n,[r,l,o]){let i=e.data;return"ArrowUp"===n?function(e,n,r,l){let o=t.prev(e);return o?(Fs(t.siblingNth(o),n,r,l),[o,"after"]):null}(i,r,l,o):function(e,n,r,l){let o=t.next(e);return o?(Fs(t.siblingNth(e),n,r,l),[o,"before"]):null}(i,r,l,o)},__obtswap:1,cmdlast(e,n,r){let l=n.selectionStart,o=No(e.data).find(n.value.substring(0,l));this.cmdNavTemp=new yo(o);let i=r?this.cmdNavTemp.last():this.cmdNavTemp.first();i&&t.val(n,i).setSelectionRange(l,i.length)},__cmdlast:1,cmdnext(e){let n=e.data,r=n.selectionStart,l=this.cmdNavTemp&&this.cmdNavTemp.next();l&&t.val(n,l).setSelectionRange(r,l.length)},__cmdnext:1,cmdprev(e){let n=e.data,r=n.selectionStart,l=this.cmdNavTemp&&this.cmdNavTemp.prev();l&&t.val(n,l).setSelectionRange(r,l.length)},__cmdprev:1,cmdNavTemp:null};
//! $ID: api.js 2021.10.21 Cooljed.Base $
let Ta;i(m,"Ed",xa,["click","pathTo","toText","unWrap","setStyle","eraseStyle","brushStyle","clearStyle","attrUpdate","deleteAttr","htmlUpdate","runScript","insResult","propUpdate","cmdRun","pluginsRun","deletes","paste"]),i(m,"Kit",Ea,["ecancel","puthtml","heading","errmsg","chapter","save","export","export2","nicehtml","blankline","toclist","medpass","medcancel","rngelem","cmenudo","convert","croptr","colcrop","inserts","topinsert","fixinsert","instbody","table","codelang","checkhtml","attrlist","obtline","obtdel","obtswap","cmdlast","cmdnext","cmdprev"]),s(v,null,Ea,["sels","esize","sel0","efocus","elemSelf","tobj","trbox","tsecbox","codebox","attrns","obtname","obtsplit","obtval","source","rngok","menupos","submenu","convtype","roleinfo","cmable","inlable","inslist","ismixed","pretreat2","pretreat1","trfmt","splitx","k3edit","indentcut","hlcode","codels","codeblo","image3","mediasubs","picsubs","cbstate","styVal","unitVal","styName","styKey","cleanHTML","inlineHTML","mdline","cmdclear"]),s(v,"focusPick",xa.focusPick2),window.ESet=Vo,window.History=pi;const Ca={init(t){Ta=t},heading(e){let n=t.get("h1",Ta);if(void 0===e)return n&&t.html(n);sa(),n||(n=t.prepend(t.get("hgroup",Ta)||Ta,t.elem("h1"))),t.html(n,e)},subtitle(e,n){let r=t.get("hgroup",Ta),l=r?t.find(">h3",r):[];if(void 0===e)return l.map((e=>t.html(e)));sa(),r||(r=t.prepend(Ta,t.elem("hgroup"))),n||l.forEach((e=>t.remove(e))),t.append(r,t(Na(e)).Element("h3"))},abstract(e,n){let r=t.get(">header[role=abstract]",Ta);if(void 0===e&&void 0===n)return r&&Sa(r);sa(),$a(e,n,r,ie)},article(e){let n=t.get("article",Ta);if(void 0===e)return n&&t.html(n);sa(),ia(612,t.Element("article",e))},seealso(e,n){let r=t.get(">aside[role=seealso]",Ta);if(void 0===e&&void 0===n)return r&&Aa(r,"ul");sa(),ka(e,n,r,"ul",609)},reference(e,n){let r=t.get(">nav[role=reference]",Ta);if(void 0===e&&void 0===n)return r&&Aa(r,"ol");sa(),ka(e,n,r,"ol",608)},footer(e,n){let r=t.get(">footer",Ta);if(void 0===e&&void 0===n)return r&&Sa(r);sa(),$a(e,n,r,ae)},content(e){if(void 0===e)return t.html(Ta);sa(),t.html(Ta,e)},toc:(e=_.tocLabel)=>Jr(607,{h4:e},t.get("article",Ta)).outerHTML,theme(e){let n=t.get(`#${b.styleTheme}`);return void 0===e?n.href:Oa(n,e)},style(e){let n=t.get(`#${b.styleMain}`);return void 0===e?n.href:Oa(n,e)},codes(e){let n=t.get(`#${b.styleCodes}`);return void 0===e?n.href:Oa(n,e)},savedhtml:function(){return Jo.get(g.storeMain)}};function Na(e){return t.isArray(e)?e:[e]}function Sa(e){let n=t.get("h4",e);return[n&&t.html(n),t(">*",e).not("h4").prop("outerHTML").join("")]}function $a(e,n,r,l){let o=r&&t.get("h4",r),i=r&&t(">*",r).not("h4");ia(l,Jr(l,{h4:e||o&&t.text(o)},n?[...t.fragment(n).children]:i,!0))}function Aa(e,n){let r=t.get("h4",e),l=t.get(`>${n}`,e);return[r&&t.html(r),l&&t.children(l).map((e=>t.html(e)))]}function ka(e,n,r,l,o){let i=r&&t.get("h4",r),s=r&&t.get(`>${l}`,r);n&&(s=t.elem(l),t.append(s,t(Na(n)).wrap("<li>"))),ia(o,Jr(o,{h4:e||i&&t.text(i)},s))}function Oa(e,n){return t.style({id:e.id,href:n},e).then((()=>t.remove(e)))}
//! $ID: main.js 2019.11.16 Cooljed.User $
window.GHK=(new p).config(C.Global),window.SHK=(new p).config(C.Slave),window.DHK=(new p).config(C.Modal),window.CHK=new d(xa).config(C.Content),window.Sys=g,window.Kit=Ea,window.KM=C.Keys,window.edInit=function(r,l,o,i,s,a,u,c,f,p,d){di=t.get(r),hi=t.get(l),xi=t.get(o),mi=t.get(i),gi=t.get(s),_i=t.get(a),wi=t.get(u),vi=t.get(c),yi=t.get(f),bi=t.get(p),Ti=t.get(d),Object.assign(Ys,{[x.select]:new ho(Vo,di),[x.filter]:new mo(Vo),[x.search]:new go(di),[x.command]:new _o(Vo),[x.calcuate]:new wo(Vo,di)}),Co(t.get("#x-help"),e.get(n).node(g.modalPlug)),t.on(di,"attrdone styledone nodesdone emptied detach normalize propdone",null,qo)},window.Api=Ca,window.ESC=new Wn,t.config({varyevent:!0}),c.init(v,m).config(r).then((t=>t.build(document))).then((()=>t.trigger(document.body,"finish"))).then((()=>Ca.init(t.get("main.content")))).then((()=>g.contenter())).then((e=>null!=e&&t.html(t.get("main.content"),e))).then((()=>g.readyCall())).catch((t=>g.failCall(t))),l&&(window.On=v,window.By=m,window.Tpls=e.get(n));export{Jl as PlugBy,ql as PlugOn};
