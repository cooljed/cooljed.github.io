/*! Coolj/Tpb@tQuery v0.2.0 | (c) zhliner@gmail.com 2022.01.19. */
import t,{OBTA as e,TplsPool as n,TplrName as r,tplMaps as l,DEBUG as o}from"./tpb/config.js";import{processProxy as i,processExtend as s,customGetter as a,BaseOn as u,BaseBy as c,Tpb as f,obtBuilder as d}from"./tpb/tpb.esm.js";import{HotKey as p,ObjKey as h}from"./tpb/tools/hotkey.js";import{Scripter as m,By as g,Sys as _,Limit as w,On as v,ROOT as y,Local as b,Cmdx as x,Tips as E,Fx as T,Help as C}from"../config.js";import N from"./shortcuts.js";import{Render as S}from"./tpb/tools/render.js";import{Spliter as $,UmpCaller as A,UmpString as k,UmpChars as O}from"./tpb/tools/spliter.js";import{MdLine as R}from"./hlparse/languages/mdline.js";import{Hicolor as I}from"./hlparse/main.js";import{Util as z}from"./tpb/tools/util.js";import{Templater as L}from"./tpb/tools/templater.js";import{Loader as U,TplLoader as D}from"./tpb/tools/tloader.js";
//! $ID: types.js 2020.05.09 Cooljed.Libs $
const H=1,M=2,F=6,P=8,j=100,B=101,K=102,V=103,W=104,G=105,X=106,q=107,J=200,Y=201,Q=202,Z=203,tt=204,et=205,nt=206,rt=207,lt=208,ot=209,it=210,st=211,at=212,ut=213,ct=214,ft=215,dt=216,pt=217,ht=218,mt=219,gt=220,_t=221,wt=300,vt=301,yt=302,bt=303,xt=304,Et=400,Tt=401,Ct=402,Nt=403,St=404,$t=405,At=406,kt=407,Ot=408,Rt=409,It=410,zt=411,Lt=412,Ut=413,Dt=414,Ht=418,Mt=419,Ft=420,Pt=421,jt=422,Bt=423,Kt=501,Vt=502,Wt=503,Gt=504,Xt=505,qt=506,Jt=510,Yt=511,Qt=513,Zt=514,te=515,ee=516,ne=517,re=518,le=519,oe=520,ie=523,se=524,ae=525,ue=527,ce=-1,fe=-2,de={0:0,[M]:4114,[H]:4114,3:4114,4:4114,5:4626,[F]:4624,7:528,[P]:4240,9:400,10:400,108:6,[j]:390,[B]:390,[K]:390,[V]:130,[X]:6,[q]:14,104:3082,[G]:3842,[J]:4120,[Y]:4120,[Q]:4120,[Z]:4120,[tt]:4120,[et]:4120,[nt]:4120,[rt]:4120,[lt]:4120,[ot]:4120,[it]:4120,[st]:4120,[at]:4120,[ut]:4120,[ct]:4120,[ft]:4120,[dt]:4120,[pt]:4120,[ht]:4120,[mt]:4120,[gt]:4120,[_t]:4120,[wt]:40,[vt]:40,[yt]:40,[xt]:40,[bt]:40,[Et]:1098,[Tt]:1098,[Ct]:14,[Nt]:1098,[St]:3146,[$t]:14,[At]:1098,[kt]:78,[Ot]:1102,[Rt]:14,[It]:14,[zt]:14,[Lt]:10,[Ut]:10,[Dt]:6,416:2,415:70,417:70,[Ht]:518,[Mt]:14,[Ft]:3146,[Pt]:518,[jt]:518,[Bt]:518,424:3586,425:6,500:1122,[qt]:1122,507:1634,509:34,508:34,[Jt]:1122,[Yt]:2146,512:98,[Kt]:34,[Vt]:34,[Wt]:34,[Gt]:34,[Xt]:34,[Qt]:34,[Zt]:34,[te]:34,[ee]:34,[ne]:34,[re]:34,[le]:34,[oe]:34,521:34,522:34,[ie]:34,[se]:34,[ae]:34,526:34,[ue]:160,528:544,[ce]:13,[fe]:13},pe=[Y,Q,et,nt,rt,lt,5,ot,it,st,at,ut,ct,ft,dt,pt,ht,_t],he=[Z,tt,mt,gt],me=[9,10,7],ge=[...[H,M,3,4,F,P],...pe,...he,...me],_e=[...pe,...he,...me],we=[...he,...me],ve=[ie,se,Zt,te],ye=[wt,vt,yt,bt,Zt,te,ee,ne,re,le,oe,521,522,ie,se,ae,526,528],be={0:null,[H]:[0,B,j],[M]:[0,B,j],3:[K,V],4:[108],5:[0,104,G],[F]:[0],7:null,[P]:null,9:null,10:null,108:[108],[j]:null,[B]:null,[K]:null,[V]:null,104:[0],[G]:[0],[X]:[P,4],[q]:[0,J,..._e],[J]:[0,...ge],[Y]:[0,J,...ge,4,P],[Q]:[0,...he],[Z]:[0,J,...pe,...me],[tt]:[0,J,...pe,...me],[et]:[0,Q,...we],[nt]:[0,...pe,...he],[rt]:[0,...he],[lt]:[0,ce,fe],[ot]:[0,...we],[it]:[0,...we],[st]:[0,...we],[at]:[0,...we],[ut]:[0,...we],[ct]:[0,...we],[ft]:[0,..._e],[dt]:[0],[pt]:[0,...he],[ht]:[0,...he],[mt]:[0,..._e],[gt]:[0,..._e],[_t]:[0,...he],[wt]:[0,J,...ge,ce,fe],[vt]:[0,J,...ge,ce,fe],[yt]:[0,J,...ge,ce,fe],[bt]:[0,J,..._e],[xt]:[0,J,...ge,ce,fe],[Et]:[0,J,..._e,4,P,fe],[Tt]:[0,J,..._e,4,P,fe],[Ct]:[0,J,..._e,4,P,fe],[Nt]:[0,J,..._e,4,P,fe],[St]:[0,J,..._e,4,P,fe],[$t]:[0,J,..._e,4,P,fe],[At]:[0,J,..._e,fe],[kt]:[0,J,..._e,fe],[Ot]:[0,J,..._e,fe],[It]:[0,J,..._e,4,P,fe],[Rt]:[0,J,...ge],[zt]:[0,J,...ge],[Lt]:[0,J,...ge],[Ut]:[0,J,...ge],[Dt]:[Lt,Ut],415:[Dt],416:[Dt],417:[Dt],[Ht]:[lt],[Mt]:[J],[Ft]:[J],[Pt]:[Nt,Zt],[jt]:[Nt,te],[Bt]:[Ft,te],424:[Mt,Bt],425:[P,4,q,X],500:[Et,Ct],[qt]:[Nt,wt,...ve],507:[Nt,424],508:[Nt,te],509:[Nt,Zt],[Jt]:[Nt,wt,yt,vt,...ve,ne,re],[Yt]:[Nt,wt,yt,vt,...ve,xt],[Zt]:[Rt,Mt],[te]:[Rt,Mt],[ee]:[Ht],[ne]:[Rt,Mt,Pt,jt],[re]:[Rt,Mt,Pt,jt],[le]:[Rt,Mt,jt,Bt],[oe]:[It,zt],521:[Ot,415,416,417],522:[kt,425],[ie]:[Nt,wt,...ve,521],[se]:[Nt,wt,...ve,521],[ae]:[At,wt,...ve,521],526:[lt],[ue]:null,528:null,[ce]:[0,J],[fe]:[0,J],[-10]:[Et,500,qt,507,512,508,509,Yt]};t.each(be,((t,e,n)=>n[e]=t&&new Set(t)));const xe={512:[Jt,Yt,ue,Kt],[Kt]:[Tt,Jt,Yt,ue,Vt],[Vt]:[Tt,Jt,Yt,ue,Wt],[Wt]:[Tt,Jt,Yt,ue,Gt],[Gt]:[Tt,Jt,Yt,ue,Xt],[Xt]:[Tt,Jt,Yt,ue,Qt],[Qt]:[Tt,Jt,Yt,ue,Qt]};function Ee(t){return!!(128&de[t])}function Te(t){return!!(64&de[t])}function Ce(t){return!!(256&de[t])}function Ne(t){return!!(1024&de[t])}function Se(t){return!!(2048&de[t])}function $e(t){return!!(1024&de[t]&&2048&de[t])}function Ae(t){return!!(512&de[t])}function ke(t){return!!(32&de[t])}function Oe(t){return!!(16&de[t])}function Re(t){return!!(4096&de[t])}function Ie(t){return!!(8&de[t])}function ze(t){return!!(4&de[t])}function Le(t){return!!(1&de[t])}function Ue(t){let e=be[t];return!!e&&1===e.size&&e.has(0)}function De(e){let n=t.not(t.children(e),"h2,header,footer,hr"),r=t.filter(n,"section");return n.length?r.length?n.length===r.length?2:3:1:0}function He(t,e){switch(De(t)){case 1:return e.slice(0,-1).concat(ye);case 2:return e}return e.concat(ye)}var Me=Object.freeze({__proto__:null,$TEXT:0,AUDIO:H,VIDEO:M,PICTURE:3,SVG:4,RUBY:5,METER:F,SPACE:7,IMG:P,BR:9,WBR:10,TRACK:j,SOURCE1:B,SOURCE2:K,PIMG:V,RT:104,RP:G,FCONA:X,EXPLAIN:q,SVGITEM:108,A:J,Q:Y,ABBR:Q,DEL:Z,INS:tt,DFN:et,BDO:nt,TIME:rt,CODE:lt,STRONG:ot,EM:it,CITE:st,SMALL:at,SUB:ut,SUP:ct,MARK:ft,ORZ:dt,SAMP:pt,KBD:ht,S:mt,U:gt,VAR:_t,P:wt,NOTE:vt,TIPS:yt,PRE:bt,ADDRESS:xt,H1:Et,H2:Tt,H3:Ct,H4:Nt,H5:St,H6:$t,SUMMARY:At,FIGCAPTION:kt,CAPTION:Ot,LI:Rt,DT:It,DD:zt,TH:Lt,TD:Ut,TR:Dt,THEAD:415,TBODY:416,TFOOT:417,CODELI:Ht,ALI:Mt,AH5:Ft,XH5LI:Pt,XOLH5LI:jt,XOLAH5LI:Bt,TOCCASCADE:424,FIGCONBOX:425,HGROUP:500,S1:Kt,S2:Vt,S3:Wt,S4:Gt,S5:Xt,ABSTRACT:qt,TOC:507,REFERENCE:508,SEEALSO:509,HEADER:Jt,FOOTER:Yt,ARTICLE:512,SECTION:Qt,UL:Zt,OL:te,CODELIST:ee,ULX:ne,OLX:re,CASCADE:le,DL:oe,TABLE:521,FIGURE:522,BLOCKQUOTE:ie,ASIDE:se,DETAILS:ae,CODEBLOCK:526,HR:ue,BLANK:528,B:ce,I:fe,MAIN:-10,ChildTypes:be,ChildTypesX:xe,isEmpty:Ee,isSingle:Te,isCovert:Ce,isFixed1:Ne,isFixed2:Se,isFixed:$e,isFixedAny:function(t){return!!(1024&de[t]||2048&de[t])},isSealed:Ae,isBlocks:ke,isInlines:Oe,isRangeX:Re,isContent:Ie,isStruct:function(t){return!!(2&de[t])},isStructX:ze,isSpecial:Le,onlyText:Ue,sectionState:De,sectionSubs:He});
//! $ID: base.js 2020.05.10 Cooljed.Libs $
const Fe=Symbol("type-value"),Pe=new WeakMap,je=new Set(["abstract","toc","seealso","reference","s1","s2","s3","s4","s5","codelist","ulx","olx","cascade","codeblock","note","tips","blank","orz","space","explain"]),Be=new Set([415,417,Et,At,qt,507,424,508,512,q,V]),Ke={LI(e,n){let r=e.firstElementChild;return e.childElementCount<=1?n&&function(e,n){if(!e||t.siblingNodes(e,!1,!0).length)return;if("A"===e.tagName)return Mt;return"CODE"===e.tagName&&"OL"===n.tagName&&rn(n)===ee&&Ht}(r,n)||Rt:2===e.childElementCount&&"H5"===r.tagName?en(r):Rt},H5:t=>nn(t,"A")?Ft:St,SPAN:(t,e)=>e&&"FIGURE"===e.tagName?425:t.hasAttribute("space")&&!t.childNodes.length?7:null,IMG:(t,e)=>3===(e&&rn(e))?V:P,SOURCE:(t,e)=>"PICTURE"===e.tagName?K:B,A:(t,e)=>e&&425===rn(e)?X:J},Ve={LI:[{type:Ht,check:t=>nn(t,"CODE")},{type:Mt,check:t=>nn(t,"A")},{type:Bt,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&en(e)===Bt}},{type:jt,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&en(e)===jt}},{type:Pt,check:function(t){let e=t.firstElementChild;return 2===t.childElementCount&&"H5"===e.tagName&&en(e)===Pt}},{type:Rt,check:()=>!0}],SPAN:[{type:7,check:t=>0===t.childNodes.length},{type:425,check:()=>!0}],A:[{type:X,check:t=>nn(t,"IMG")||nn(t,"svg")},{type:J,check:()=>!0}],IMG:[V,P]},We=Symbol("normal-list"),Ge=Symbol("small-block"),Xe=Symbol("blockcode-item"),qe={[Jt]:Ge,[Yt]:Ge,[ie]:Ge,[se]:Ge,[ae]:Ge,[Ht]:Xe,526:Xe,[Zt]:We,[te]:We,[ne]:We,[re]:We,[le]:We};function Je(t,e){if(3===t.nodeType)return 0;if("http://www.w3.org/2000/svg"===t.namespaceURI)return"svg"===t.tagName?4:108;let n=Ke[t.tagName];return n?n(t,e):function(t){let e=+Me[t];return isNaN(e)?null:e}(function(t){let e=t.getAttribute("role");return(je.has(e)?e:t.tagName).toUpperCase()}(t))}function Ye(t,e){if(t===e)return null;let n=rn(t);return Oe(n)?Ye(t.parentElement):Ie(n)?t:Qe(t,e)}function Qe(t,e){return t===e?null:function(t){let e=rn(t);return ke(e)||Oe(e)}(t)?t:Qe(t.parentElement)}function Ze(e,n){return 3===e.nodeType||t.find("*",e,!0).every((t=>n.has(rn(t))))}function tn(e){return 3==e.nodeType?null:dn(e)?e:t.children(e).map((t=>tn(t))).flat()}function en(t){switch(t.nextElementSibling.tagName){case"UL":return Pt;case"OL":return nn(t,"A")?Bt:jt}return Rt}function nn(e,n){let r=e.firstElementChild;return 1===e.childElementCount&&!t.siblingNodes(r,!1,!0).length&&r.tagName===n}function rn(t,e=t.parentElement){if(3===t.nodeType)return 0;if(1!==t.nodeType)return null;let n=t[Fe];return void 0===n&&ln(t,n=Je(t,e)),n}function ln(t,e){return Reflect.defineProperty(t,Fe,{value:e,enumerable:!1,configurable:!0}),t}function on(t,e){let n=sn(t);return!!n&&n.has(e)}function sn(t){if("number"==typeof t)return be[t];let e=rn(t),n=xe[e];return n?new Set(He(t,n)):be[e]||""}function an(e){let n=t.clone(e,!0,!0,!0),r=t.find("*",e);return t.find("*",n).forEach(((t,e)=>ln(t,rn(r[e])))),ln(n,rn(e))}function un(e){return fn(e)?[e]:t.contents(e).map((t=>1===t.nodeType?un(t):t)).flat()}function cn(t){return Ce(rn(t))}function fn(t){return Oe(rn(t))}function dn(t){return Ie(rn(t))||0===t.childElementCount&&t.innerText&&t.innerText.trim()}function pn(t){return Ne(rn(t))}function hn(t){return Se(rn(t))}function mn(t){return $e(rn(t))}function gn(t){let e=rn(t);return e>=Kt&&e<=Xt}function _n(t){return Be.has(rn(t))}function wn(e,n){return n?Pe.set(e,n)&&null:(n=Pe.get(e)||Pe.set(e,new t.Table(e)).get(e)).checkCols()}function vn(e){let n=tn(e);return n?t.isArray(n)?n:[n]:[]}function yn(t,e){return fn(t)?Ye(t.parentElement,e):Qe(t.parentElement,e)}function bn(e){let n=t.attr(e,"role");return n?+n.substring(1):e.parentElement?t.parentsUntil(e,"section[role=s5]").length+6:6}function xn(e,n){let r=(n+=bn(e))<6?`s${n}`:null;if(0===n)return!1;Reflect.deleteProperty(t.attr(e,"role",r),Fe)}function En(t,e){let n=qe[rn(t)];if(void 0===n)return function(t,e){let n=rn(t);for(const t of e)if(n!==rn(t))return t;return null}(t,e);for(const t of e)if(n!==qe[rn(t)])return t;return null}function Tn(t,e){let n=Ve[t.tagName];return n?n.some((n=>function(t,e,n){return"number"==typeof n?e.has(n)&&!!ln(t,n):e.has(n.type)&&n.check(t)&&!!ln(t,n.type)}(t,e,n))):e.has(rn(t))}
//! $ID: common.js 2019.09.07 Cooljed.Libs $
const Cn=new $(";",new A,new k),Nn=new R;class Sn extends Set{constructor(t){super(),this._cls=t,this._n2=null,this._p2=null}add(e){return super.add(t.addClass(e,this._cls)),e}delete(e){return super.delete(t.removeClass(e,this._cls)),e===this._n2&&(this._n2=null),e===this._p2&&(this._p2=null),e}clear(){return this.forEach((e=>t.removeClass(e,this._cls))),super.clear(),this._n2=null,this._p2=null,this}first(){for(const t of this)return t}next(t){let e=[...this],n=this._next(e,t)||this._n2||e[0];return this._n2=this._next(e,n),this._p2=this._prev(e,n),n}prev(t){let e=[...this],n=this._prev(e,t)||this._p2||e[e.length-1];return this._p2=this._prev(e,n),this._n2=this._next(e,n),n}pushes(t){return t.forEach((t=>this.add(t))),this}removes(t){return t.forEach((t=>this.delete(t))),this}cruise(t){if(void 0===t)return[this._p2,this._n2];[this._p2,this._n2]=t||[null,null]}_next(t,e){let n=t.indexOf(e);return n<0?null:t[n+1]}_prev(t,e){let n=t.indexOf(e);return n<0?null:t[n-1]}}class $n extends Map{add(t,e){super.set(e,t)}top(){let t;for(t of this);return t?t[1]:null}}class An{constructor(t=""){this._fix=t}get(t){return window.localStorage.getItem(this._fix+t)}set(t,e){return window.localStorage.setItem(this._fix+t,e),this}del(t){window.localStorage.removeItem(this._fix+t)}has(t){return!!window.localStorage.getItem(this._fix+t)}clear(){window.localStorage.clear()}keys(){let t=Object.keys(window.localStorage),e=this._fix.length;return t.filter((t=>t.startsWith(this._fix))).map((t=>t.substring(e)))}}class kn{constructor(t,e){this._max=t,this._buf=[],this._idx=-1,this._hist=e}push(...t){if(!t.length)return;return this._buf.length=++this._idx,this._buf.push(t)-this._max>0&&this._shift()}pop(){let t=this._buf.pop();this._idx--,t.slice().reverse().forEach((t=>t.undo()))}undo(){if(this._idx<0)return Ln("[undo] overflow.");let t=this._buf[this._idx];this._confirm(t)&&(this._idx--,t.slice().reverse().forEach((t=>t.undo())))}redo(){if(this._idx>=this._buf.length-1)return Ln("[redo] overflow.");this._buf[++this._idx].forEach((t=>t.redo()))}clear(){this._buf.length=0,this._idx=-1,this._hist.clear()}canUndo(){return this._idx>=0}canRedo(){return this._idx<this._buf.length-1}_confirm(t){let e=!0;for(const n of t)if(n.warn&&(e=window.confirm(n.warn()),!e))break;return e}_shift(){let t=this._buf.shift();this._idx--,t.forEach((t=>t.count&&this._hist.prune(t.count)))}}class On{constructor(t,e){this._data=t,this._size=e,this._idx=0}next(){let t=this.pages()-1;return this._idx<t?this.page(this._idx+1):null}prev(){return this._idx>0?this.page(this._idx-1):null}first(){return this.page(0)}last(){return this.page(this.pages()-1)}page(t){let e=t*this._size;return this._idx=t,this._data.slice(e,e+this._size)}index(t){if(void 0===t)return this._idx;this._idx=t}reset(t){return this._idx=0,this._data=t,this}pages(){return Math.ceil(this._data.length/this._size)}}class Rn{constructor(t){this._tpl=t,this._pool=[]}page(t,e){return this._pool[t]||this._render(t,this._clone(this._tpl),e)}reset(){return this._pool.length=0,this}_render(t,e,n){return this._pool[t]=S.update(e,n)}_clone(e){return S.clone(e,t.clone(e,!0,!0,!0))}}class In extends Set{constructor(t){super(),this._make=t}pick(...t){return this._pick()||this._make(...t)}_pick(){let t;for(t of this)break;return void 0!==t&&this.delete(t),t}}const zn=new In(m);function Ln(t,e){window.console.warn(t,e||"")}function Un(e,n,r,l){let o=e.tagName.toLowerCase(),i=`<${o}${function(t,e,n){let r="",l=new Map([["on"],["by"],["to"]]);for(let e=0;e<t.length;e++){let n=t[e];l.has(n.name)?l.set(n.name,n.value):r+=` ${n.name}`+(""===n.value?"":`="${Dn(n.value)}"`)}return r+function(t,e,n){let r=[];n=`${n}${e}`;for(const[l,o]of t)o&&r.push(`${l}="${Hn(o,e,n)}"`);return r.length?`\n${n}`+r.join(`\n${n}`):""}(l,e,n)}(e.attributes,r,l)}`,s="";if(function(t){return Ee(rn(t))}(e))return i+" />";i+=">";for(const t of e.childNodes)s+=Bn(t,n,r,l+r);return i+s+function(e,n){return 3===e.nodeType||fn(e)||dn(e)||function(e){let n=t.contents(e,-1,!1,!0);return 3===n.nodeType||fn(n)}(e)?"":"\n"+n}(e,l)+`</${o}>`}function Dn(t){return t.replace(/"/g,"&quot;")}function Hn(t,e,n){return Cn.reset(),[...Cn.split(t)].map((t=>Dn(t.trim()))).join(`;\n${n}${e}`)}function Mn(t){let e=zn.pick();return new Promise((n=>{e.onmessage=t=>{if(e.onmessage=null,zn.add(e),t.data.error)throw t.data.error;n(t.data.result)},e.postMessage(`return ${t}`)}))}function Fn(e,n=1){let r=t.prevNodes(e,!1,!0),l=0;for(;l<r.length;l++){let t=r[l];if(--n<0||pn(t))break}return r[l-1]||null}function Pn(e,n=1){let r=t.nextNodes(e,!1,!0),l=0;for(;l<r.length;l++){let t=r[l];if(--n<0||hn(t))break}return r[l-1]||null}function jn(e,n){let r=n.parentNode,l=n.previousSibling;return t.replace(e,n),l?t.after(l,e):t.prepend(r,e)}function Bn(e,n,r,l=""){let o=e.nodeType,i=(a=l,3===(s=e).nodeType||1===s.nodeType&&fn(s)?"":"\n"+a);var s,a;return 1===o?i+(function(e){let n=e.nodeName;return"CODE"==n||"PRE"==n?t.prop(e,"outerHTML"):""}(e)||Un(e,n,r,l)):3===o?e.textContent.trim()&&t.html(n?function(t){let e=t.textContent.replace(/\s+/g," ");return t.nextSibling||(e=e.trimEnd()),t.previousSibling||(e=e.trimStart()),e}(e):e.textContent):8===o?i+`\x3c!--${e.data}--\x3e`:e.outerHTML||e+""}function Kn(t){return Nn.parse(t).map((t=>{return e=t.type,n=t.text,e?`<${e}>${n}</${e}>`:n;var e,n})).join("")}function Vn(e){let n=[];for(const t of e.childNodes){let e=t.nodeType;1===e?n.push(Vn(t)):3!==e&&8!==e||n.push(t)}return n.length&&t.fill(e,n),function(t){let e=rn(t);return Oe(e)||"CODE"===t.parentElement.tagName&&Le(e)}(e)?e:e.textContent}
//! $ID: coding.js 2020.02.07 Cooljed.Libs $
const Wn=new Set("ೠൕ൘൙൚൛൜൝൞ൟൠ൧൨൩൪൫൬൭൮൯൰൱൲൳൴൵൶൷൸൹ൺൻർൽൾൿᳩᳪᳫ⁇※‱℃".split(""));function Gn(t){let e=t.indexOf("\t");return e<0?[t]:[t.substring(0,e),t.substring(e+1)||!0]}function Xn(t,e,n){let r=t.innerText||t.textContent,l=r.lastIndexOf(n,e-1);return l<0?[r.substring(0,e)]:[r.substring(l+1,e),!0]}function qn(t,e,n){let r=t.innerText||t.textContent,l=r.indexOf(n,e);return l<0?[r]:[r.substring(e,l),!0]}function Jn(t,e,n){let r=[];for(;t;){let[l,o]=Xn(t,e,n);if(r.push(l),e=1/0,o)break;t=t.previousSibling}return[r.reverse().join(""),!!t]}function Yn(t,e,n){let r=[];for(;t;){let[l,o]=qn(t,e,n);if(r.push(l),e=0,o)break;t=t.nextSibling}return[r.join(""),!!t]}function Qn(t,e){let n=0;for(;n<e&&/[ \t]/.test(t[n]);n++);return n}function Zn(t){let e=0;for(const n of t)e+="\t"!==n?n.codePointAt(0)>=8527||Wn.has(n)?2:1:8-e%8;return e}function tr(e,n,r){let l=e.startContainer,o=e.startOffset;return l===r&&(l=t.contents(l,o)),n?Jn(l,o,"\n")[0]:!1===n?Yn(l,o,"\n")[0]:Jn(l,o,"\n")[0]+Yn(l,o,"\n")[0]}function er(e,n,r){return r>0&&(e=e.map((t=>function(t,e=4){let n=[],r="",l=t;for(;l;)[r,l]=Gn(l),l&&(r+=" ".repeat(e-Zn(r)%e),!0===l&&(l=null)),n.push(r);return n.join("")}(t,r)))),e=e.join("\n"),n?new I(e,n).effect():[{text:t.html(e)}]}
//! $ID: create.js 2019.09.07 Cooljed.Libs $
const nr={[H]:"audio",[M]:"video",3:"picture",4:"svg",5:"ruby",[F]:"meter",7:"span\\space",[P]:"img",9:"br",10:"wbr",108:null,[j]:"track",[B]:"source",[K]:"source",[V]:"img",104:"rt",[G]:"rp",[X]:"a",[q]:"i\\explain",[J]:"a",[ot]:"strong",[it]:"em",[Y]:"q",[Q]:"abbr",[st]:"cite",[rt]:"time",[at]:"small",[Z]:"del",[tt]:"ins",[ut]:"sub",[ct]:"sup",[ft]:"mark",[lt]:"code",[dt]:"code\\orz",[et]:"dfn",[pt]:"samp",[ht]:"kbd",[mt]:"s",[gt]:"u",[_t]:"var",[nt]:"bdo",[wt]:"p",[vt]:"p\\note",[yt]:"p\\tips",[xt]:"address",[bt]:"pre",[Et]:"h1",[Tt]:"h2",[Ct]:"h3",[Nt]:"h4",[St]:"h5",[$t]:"h6",[At]:"summary",[kt]:"figcaption",[Ot]:"caption",[Rt]:"li",[It]:"dt",[zt]:"dd",[Dt]:"tr",[Lt]:"th",[Ut]:"td",416:"tbody",415:"thead",417:"tfoot",[Ht]:"li",[Mt]:"li",[Ft]:"h5",[Pt]:"li",[jt]:"li",[Bt]:"li",424:"ol\\cascade",425:"span",500:"hgroup",[qt]:"header\\abstract",507:"nav\\toc",508:"nav\\reference",509:"aside\\seealso",[Jt]:"header",[Yt]:"footer",512:"article",[Kt]:"section\\s1",[Vt]:"section\\s2",[Wt]:"section\\s3",[Gt]:"section\\s4",[Xt]:"section\\s5",[Qt]:"section",[Zt]:"ul",[te]:"ol",[ee]:"ol\\codelist",[ne]:"ul\\ulx",[re]:"ol\\olx",[le]:"ol\\cascade",[oe]:"dl",521:"table",522:"figure",[ie]:"blockquote",[se]:"aside",[ae]:"details",526:"pre\\codeblock",[ue]:"hr",528:"div\\blank",[ce]:"b",[fe]:"i"},rr={[H]:function(){return t.elem("audio","Sorry, your browser doesn't support embedded audios.")},[M]:function(){return t.elem("video","Sorry, your browser doesn't support embedded videos.")},4:function(){return t.svg()},108:function(){return t.fragment("","svg")}},lr={4:function(t,e,n,r){return Sr(null,br(t,e,r),!0)},108:function(t,e,n,r){return Sr(null,br(t,e,r),!0)},5:function(e,n,{rt:r,rpl:l,rpr:o},i){return t.append(n,function(e,n,r,l){let o=[t.Text(l)];n&&o.push(Ar(G,e||_.rpLeft),Ar(W,n),Ar(G,r||_.rpRight));return o}(l,r,o,vr(i))),Sr(null,n,!0)},[lt]:function(e,n,r,l){return l&&(l="string"==typeof l?t.fragment(l,!1):function(e){let n=sn(lt);return t.isArray(e)?e.every((t=>Ze(t,n))):Ze(e,n)}(l)?l:vr(l),t.append(n,l)),Sr(null,n,!0)},[Dt]:function(e,n,{tsec:r},l){let o=t(n.cells);return 0===o.length&&(o=t(function(e,n){let r=wn((n=n||e.parentElement).parentElement);return t.append(e,r.newTR("THEAD"===n.tagName).children)}(n,r))),l&&l.nodeType?(o.append(vn(l).map((e=>t.contents(e)))),Sr(null,o,!0)):Sr(null,o)},416:function(t,e,n,r){let{th0:l,head:o,foot:i}=n,s=wn(e.parentElement||n.table),[a,u]=mr(t,s,e,r);return l&&s.rows()>0&&s.insertColumn(s.newColumn(!0),0),o&&function(t,e,n){fr(t,dr(t,e,!0),n)}(s,o,s.head()),i&&function(t,e,n){fr(t,dr(t,e),n)}(s,i,s.foot()),Er(n,"th0","head","foot"),Sr(null,a,u)},415:function(t,e,n,r){let[l,o]=mr(t,wn(e.parentElement||n.table),e,r,!0);return Sr(null,l,o)},417:function(t,e,n,r){let[l,o]=mr(t,wn(e.parentElement||n.table),e,r);return Sr(null,l,o)},[Pt]:function(e,n,{h5:r},l){if(!l)return Sr(null,l,!0);let o=t.empty(n),[i,s]=pr(e,n,l,(()=>Ar(Zt)));return Sr(ur(n,St,r||o),i,s)},[jt]:function(e,n,{h5:r},l){let o=t.empty(n),[i,s]=pr(e,n,l,(()=>Ar(te)));return Sr(ur(n,St,r||o),i,s)},[Bt]:function(t,e,{h5a:n},r){let[l,o]=pr(t,e,r,(()=>Ar(te)));return Sr(n&&ur(e,Ft,n),l,o)},424:function(e,n,r,l){let o=t.children(l,"section");return Sr(null,t.append(n,wr(o)),!0)},425:function(e,n,{explain:r},l){let[o,i]=pr(e,n,l,(()=>Ar(P)));return"string"==typeof r&&(r=function(e,n){let r=n;t.isArray(n)||(r=[n]);if(r.some((t=>!on(e,rn(t)))))return null;return t.append(e,n)}(n,Rr(q,null,r))),Sr(r,o,i)},[X]:function(t,e,n,r){let[l,o]=pr(t,e,r,(()=>Ar(P)));return Sr(null,l,o)},500:function(t,e,n,r){let{h1:l}=n,[o,i]=pr(t,e,r,(()=>Ar(Ct)));return Er(n,"h1"),Sr(l&&ur(e,Et,l),o,i)},507:function(t,e,{h4:n},r){let[l,o]=pr(t,e,r,(()=>Ar(424)));return Sr(n&&ur(e,Nt,n),l,o)},508:function(t,e,{h4:n},r){let[l,o]=pr(t,e,r,(()=>Ar(te)));return Sr(n&&ur(e,Nt,n),l,o)},509:function(t,e,{h4:n},r){let[l,o]=pr(t,e,r,(()=>Ar(Zt)));return Sr(n&&ur(e,Nt,n),l,o)},512:function(t,e,n,r){let{header:l}=n,[o]=pr(t,e,r,_r(t,e,r));return Er(n,"header"),Sr(l&&cr(e,l),o,!0)},[ee]:function(t,e,n,r){let[l,o]=pr(t,e,r,(()=>Ar(Ht)));return Sr(null,l,o)},526:function(t,e,n,r){let[l,o]=pr(t,e,r,(()=>Ar(lt)));return Sr(null,l,o)},[oe]:function(t,e,n,r){let{dt:l}=n,[o,i]=pr(t,e,r,(()=>Ar(zt)));return Er(n,"dt"),Sr(l&&hr(o||t,e,Ar(It,l)),o,i)},521:function(t,e,n,r){let l,o=wn(e),i=[];return function(t,e,n){if(!e)return t.caption(null);n.push(t.caption(e))}(o,n.caption,i),function(t,e){null===e&&t.head(null);e&&t.head(!0)}(o,n.head),function(t,e){null===e&&t.foot(null);e&&t.foot(!0)}(o,n.foot),r&&"TBODY"===r.tagName&&(l=o.bodies(0,r)),Er(n,"caption"),Sr(i,l||o.body(!0),!!l)},522:function(t,e,n,r){let{figcaption:l}=n,[o,i]=pr(t,e,r,(()=>Ar(425)));return Er(n,"figcaption"),Sr(l&&ur(e,kt,l),o,i)},[ae]:function(t,e,n,r){let{summary:l}=n,[o,i]=pr(t,e,r,(()=>Ar(wt)));return Er(n,"summary"),Sr(l&&ur(e,At,l),o,i)},3:function(e,n,r,l){return l&&("IMG"===l.tagName&&ln(l,V),on(n,rn(l))&&t.append(n,l)),Sr(null,n,!0)}};[H,M].forEach((function(e){lr[e]=function(e,n,r,l){return l&&on(n,rn(l))&&t.append(n,l),Sr(null,n,!0)}})),[[Ht,lt],[Mt,J],[Ft,J]].forEach((function(t){lr[t[0]]=function(e,n,r,l){if(n.childElementCount>0)return Sr(null,n.firstElementChild);let[o,i]=pr(null,n,l,(()=>Ar(t[1])));return Sr(null,o,i)}})),[qt,Jt,Yt,ie,se].forEach((function(t){lr[t]=function(t,e,n,r){let{h4:l}=n,[o,i]=pr(t,e,r,(()=>Ar(wt)));return Er(n,"h4"),Sr(l&&ur(e,Nt,l),o,i)}})),[Zt,te,ne,re,le].forEach((function(t){lr[t]=function(t,e,n,r){let[l,o]=pr(t,e,r,(()=>Ar(Rt)));return Sr(null,l,o)}})),[Kt,Vt,Wt,Gt,Xt,Qt].forEach((function(t){lr[t]=function(t,e,n,r){let{h2:l,header:o}=n,i=[l&&ur(e,Tt,l),o&&cr(e,o)],[s]=pr(t,e,r,_r(t,e,r));return Er(n,"h2","header"),Sr(i.filter((t=>t)),s,!0)}})),[F,q,J,Y,Q,Z,tt,et,nt,rt,ot,it,st,at,ut,ct,ft,dt,pt,ht,mt,gt,_t,ce,fe,wt,vt,yt,bt,xt,Et,Tt,Ct,Nt,St,$t,At,kt,Ot,Rt,It,zt,Lt,Ut].forEach((function(e){lr[e]=function(e,n,r,l){return l=t.isArray(l)?t.map(l,(t=>xr(n,t))).flat():xr(n,l),hr(e,n,l),Sr(null,l,!0)}}));const or={4:function(e,n){return t.attribute(e,n)},[rt]:function(e,{date:n,time:r}){return t.attr(e,"datetime",yr(n,r))},[Z]:function(e,{date:n,time:r,cite:l}){return t.attribute(e,"datetime cite",[yr(n,r),l||null])},[tt]:function(e,{date:n,time:r,cite:l}){return t.attribute(e,"datetime cite",[yr(n,r),l||null])},7:function(e,{width:n}){return n&&t.css(e,"width",n),e},[ue]:function(e,{role:n,thick:r,length:l,space:o}){return n&&t.attr(e,"role",n),t.cssSets(e,"borderWidth width height",[r,l,o])},521:function(e,{cols:n,border:r}){let l=new t.Table(e,n);return r&&t.attr(e,"border",r),wn(e,l)||e}};[[H,["src","autoplay","loop","controls"]],[M,["src","autoplay","loop","controls","poster","width","height"]],[P,["src","alt","width","height"]],[V,["src","alt","width","height"]],[B,["src","type"]],[K,["srcset","media"]],[j,["kind","src","srclang","label","default"]],[F,["value","max","min","high","low","optimum"]],[Rt,["value"]],[Ht,["value"]],[Mt,["value"]],[Pt,["value"]],[jt,["value"]],[Bt,["value"]],[ie,["cite"]],[ae,["open"]],[J,["href","target","title"]],[X,["href","target","title"]],[Y,["cite"]],[Q,["title"]],[et,["title"]],[nt,["dir"]],[ee,["lang:-lang","start"]],[lt,["lang:-lang"]],[q,["fix:-pba"]]].forEach((function(e){or[e[0]]=(n,r)=>t.attribute(n,function(t,e){let n={};for(const r of e){let[e,l]=r.split(":");void 0!==t[e]&&(n[l||e]=t[e])}return n}(r,e[1]))}));const ir={[Y]:function(e,n={}){return n.cite=t.attr(e,"cite"),[n,t.Text(e)]},[Q]:Tr,[Z]:Cr,[tt]:Cr,[et]:Tr,[nt]:function(e,n={}){return n.dir=t.attr(e,"dir"),[n,t.Text(e)]},[rt]:Cr};[J,lt,ot,it,st,at,ut,ct,ft,dt,pt,ht,mt,gt,_t].forEach((function(e){ir[e]=(e,n)=>[n||{},t.Text(e)]}));const sr={[ie]:Nr,[se]:Nr,[ae]:function(e,n={}){let r=t.get("summary",e),l=t.children(e);return r&&(n.h4=r.textContent,l.splice(l.indexOf(r),1)),n.open=!0,[n,l.map(an)]}};[Zt,te,ne,re,le,oe].forEach((function(e){sr[e]=function(e,n={}){return n.open=!0,[n,t.children(e).map(an)]}}));const ar={};function ur(e,n,r){let l=e.firstElementChild;return l===r?l:(l&&rn(l)===n||(l=t.prepend(e,Ar(n))),r.nodeType&&rn(r)===n?t.replace(l,r):(t.fill(l,r.nodeType?t.contents(r):r),l))}function cr(e,n){let r=t.get(">header",e);if(r)return r===n?r:t.replace(r,n);let l=t.get(">h2",e);return l?t.after(l,n):t.prepend(e,n)}function fr(t,e,n){return e.forEach((e=>t.insertTR(e,null,n))),n}function dr(e,n,r){let l=[];for(const o of n)l.push(e.newTR(r)),t("th,td",l[l.length-1]).fill(o);return l}function pr(t,e,n,r){if(!n)return[null,!0];let l=n.nodeType?rn(n):0;return on(e,l)&&!Te(l)?[hr(t,e,n),!0]:[hr(t,e,r()),!1]}function hr(e,n,r){return e?t.before(e,r):t.append(n,r)}function mr(t,e,n,r,l){if(!r)return[null,!0];let o=t?e.trIndex(t,n):null;return"TR"!==r.tagName||!function(t,e){return function(t){return[...t.cells].reduce(((t,e)=>t+e.colSpan),0)}(t)===e.cols()}(r,e)||l&&![...r.cells].every((t=>"TH"===t.tagName))?[e.insertTR(e.newTR(l),o,n),!1]:[e.insertTR(r,o,n),!0]}function gr(e,n,r){if("SECTION"!==r.tagName)throw new Error(`<${r.tagName}> not a SECTION`);hr(e,n,function(e,n){return t.find("section",e,!0).forEach((t=>xn(t,n))),e}(r,("ARTICLE"===n.tagName?0:bn(n))-bn(r)+1))}function _r(t,e,n){switch(De(e)){case 0:case 1:return()=>Rr(wt,null,n);case 2:return()=>gr(t,e,n)}return null}function wr(e){return e.map((e=>function(e){let n=t.get(">h2",e),r=t.children(e,"section");n||function(t,e){e&&window.console.info(e);throw new Error(t)}("<H2> is missed...!!",e);if(!r.length)return l=n,kr(Ar(Mt),{href:l.id?`#${l.id}`:null},l.innerText);var l;let o=function(t){let e=kr(Ar(J),{href:t.id?`#${t.id}`:null},t.innerText);return kr(Ar(Bt),{h5a:[e]},Ar(te))}(n);return t.append(o.lastElementChild,wr(r)),o}(e)))}function vr(e){return t.isArray(e)?e.map((t=>t.textContent)).join(""):e.nodeType?e.textContent:e+""}function yr(t,e){return e&&(t=t?`${t} ${e}`:`${e}`),t||null}function br(e,n,r){return"string"==typeof r&&(r=function(e){return t.find("*",e).forEach((t=>ln(t,108))),e}(t.fragment(r,"svg"))),hr(e,n,r)}function xr(e,n){return!n||n.nodeType>1?n||null:"string"==typeof n?t.Text(n,!0):Ue(rn(e))?t.Text(n):un(n).map((n=>on(e,rn(n))?n:t.Text(n)))}function Er(t,...e){e.forEach((e=>delete t[e]))}function Tr(e,n={}){return n.title=t.attr(e,"title"),[n,t.Text(e)]}function Cr(e,n={}){let r=t.attr(e,"datetime");return r&&([n.date,n.time]=r.split(/\s+/)),n.cite=t.attr(e,"cite"),n.datetime=r,[n,t.Text(e)]}function Nr(e,n={}){let r=t.get("h4",e),l=t.children(e);return r&&(n.h4=r.textContent,n.summary=r.textContent,l.splice(l.indexOf(r),1)),n.open=!0,[n,t(l).clone()]}function Sr(t,e,n=!1){return{head:t||null,body:e,end:n}}function $r(e,n){return e?(t.isArray(e)?e:[e]).concat(n):t.isArray(n)?n:[n]}function Ar(e,n){let r=rr[e],l=r?r():function(e,n){let r=t.elem(e);return n&&r.setAttribute("role",n)||r}(...nr[e].split("\\"));return n&&t.append(l,n),ln(l,e)}function kr(t,e,n,r){let l=rn(t),o=or[l];return o&&(t=o(t,e)),lr[l]&&function(t,e,n,r){if(r)return n.forEach((n=>Or(null,t,e,n)));Or(null,t,e,n)}(t,e,n,r),t}function Or(e,n,r,l){let o=rn(n),i=lr[o](e,n,r,l);return i.end?$r(i.head,i.body):t.isArray(i.body)?$r(i.head,i.body.map(((e,n)=>kr(e,r,function(e,n){return t.isArray(e)?e[n]:e}(l,n))))):$r(i.head,kr(i.body,r,l))}function Rr(t,e,n,r){if("string"==typeof t&&(t=Me[t.toUpperCase()]),null==t)throw new Error("invalid target name.");return kr(Ar(t),e||{},n||"",r)}function Ir(t){let e=rn(t);return sr[e]?_.convBlocks:ar[e]?_.convLines:ir[e]&&!function(t){let e=rn(t.parentElement);return 526===e||e===Ht}(t)?_.convInlines:null}function zr(t){let e=rn(t),n=ir[e]||ar[e]||sr[e];if(!n)throw new Error(`[${t}] convert is not supported.`);return n(t)}[wt,vt,yt,bt,xt].forEach((function(t){ar[t]=(t,e={})=>[(e.open=!0,e),an(t)]})),i(g,"New",(function(t){let e=Me[t.toUpperCase()];if(null==e)throw new Error("invalid target name.");return(t,n,r)=>kr(Ar(e),n||{},t.data,r)}),1),i(g,"New2",(function(t){let e=Me[t.toUpperCase()];if(null==e)throw new Error("invalid target name.");return(t,n)=>t.data.map((t=>kr(Ar(e),n||{},t)))}),1);
//! $ID: templates.js 2020.05.09 Cooljed.Config $
const Lr={0:"option:text",[H]:"option:audio",[M]:"option:video",3:"option:picture",4:"option:svg",5:"option:ruby",[F]:"option:meter",7:"option:space",[P]:"option:img",9:"option:br",10:"option:wbr",[j]:"option:track",[B]:"option:source1",[K]:"option:source2",[V]:"option:pimg",[q]:"option:explain",108:"option:svgitem",[J]:"option:a",[Y]:"option:q",[Q]:"option:abbr",[Z]:"option:del",[tt]:"option:ins",[et]:"option:dfn",[nt]:"option:bdo",[rt]:"option:times",[lt]:"option:code",[ot]:"option:strong",[it]:"option:em",[st]:"option:cite",[at]:"option:small",[ut]:"option:sub",[ct]:"option:sup",[ft]:"option:mark",[dt]:"option:orz",[pt]:"option:samp",[ht]:"option:kbd",[mt]:"option:s",[gt]:"option:u",[_t]:"option:var",[wt]:"option:p",[vt]:"option:note",[yt]:"option:tips",[bt]:"option:pre",[xt]:"option:address",[Et]:"option:h1",[Tt]:"option:h2",[Ct]:"option:h3",[Nt]:"option:h4",[St]:"option:h5",[$t]:"option:h6",[At]:"option:summary",[kt]:"option:figcaption",[Ot]:"option:caption",[Rt]:"option:li",[It]:"option:dt",[zt]:"option:dd",[Dt]:"option:tr",415:"option:thead",416:"option:tbody",417:"option:tfoot",[Ht]:"option:codeli",[Mt]:"option:ali",[Ft]:"option:ah5",[Pt]:"option:xh5li",[jt]:"option:xolh5li",[Bt]:"option:xolah5li",425:"option:figconbox",500:"option:hgroup",512:"option:article",[Kt]:"option:s1",[Vt]:"option:s2",[Wt]:"option:s3",[Gt]:"option:s4",[Xt]:"option:s5",[qt]:"option:abstract",509:"option:seealso",508:"option:reference",[Jt]:"option:header",[Yt]:"option:footer",[Qt]:"option:section",[Zt]:"option:ul",[te]:"option:ol",[ee]:"option:codelist",[ne]:"option:ulx",[re]:"option:olx",[le]:"option:cascade",[oe]:"option:dl",521:"option:table",522:"option:figure",[ie]:"option:blockquote",[se]:"option:aside",[ae]:"option:details",526:"option:codeblock",[ue]:"option:hr",528:"option:blank"},Ur={[H]:"property:audio",[M]:"property:video",3:"property:picture",[P]:"property:img",[V]:"property:img",4:"property:svg",5:"property:ruby",[rt]:"property:times",[F]:"property:meter",7:"property:space",[J]:"property:a",[X]:"property:a",[Y]:"property:q",[Q]:"property:abbr",[Z]:"property:del",[tt]:"property:ins",[lt]:"property:code",[et]:"property:dfn",[nt]:"property:bdo",[ie]:"property:blockquote",[ae]:"property:details",[ee]:"property:codelist",[te]:"property:ol",[re]:"property:olx",[Rt]:"property:li",[Ht]:"property:li",[Mt]:"property:li",[Pt]:"property:li",[jt]:"property:li",[Bt]:"property:li",521:"property:table",[ue]:"property:hr",528:"property:blank",[q]:"property:explain",[Et]:"property:h1",[Tt]:"property:h2",[Ct]:"property:h3",[Nt]:"property:h4",[St]:"property:h5",[$t]:"property:h6"},Dr=new Set([W,G,Lt,Ut,V,10,-10]);
//! $ID: shedit.js 2021.04.08 Cooljed.Libs $
const Hr=new t.Fx.History,Mr=new An(`${_.nameEditor}_${_.scriptList}`),Fr=new kn(w.shEdits,Hr),Pr=Symbol("sh:dpage"),jr=Symbol("sh:pager");let Br=null,Kr=null,Vr=!1;class Wr{constructor(e){this.$els=t(e),this.count=null,this.redo()}undo(){this.count>0&&Hr.back(this.count)}redo(){let t=Hr.size();this.$els.remove(),this.count=Hr.size()-t}}class Gr{constructor(t){this._sid=t,this._old=Mr.get(t),this.redo()}undo(){Mr.set(this._sid,this._old)}redo(){Mr.del(this._sid)}}class Xr{constructor(t,e){let n=t[Pr];this._idx=n.index();let r=Yr(n[e]()),l=n.index();this._nav=t,this._new=t[jr].page(l,r),this._pgn=l+1,this._pgs=n.pages(),this.count=null,this.redo()}undo(){this.count>0&&Hr.back(this.count),this._nav[Pr].index(this._idx)}redo(){let t=Hr.size();Qr(this._nav,"page",this._new,"state",this._pgn,this._pgs),this.count=Hr.size()-t}}function qr(...e){t.trigger(Kr,"state",!0),Fr.push(...e.filter((t=>t)))}function Jr(t){let e=Mr.get(t);return e?JSON.parse(e):null}function Yr(e){return(e=t.map(e,Jr)).edit=Vr,e.cmax=w.shCodelen,e}function Qr(e,n,r,l,o,i){var s,a;t.trigger(e,n,r),t.trigger(e,l,[[o,i],(s=o,a=i,a<=1?[!0,!0,!0,!0]:[1===s,1===s,s===a,s===a])])}function Zr(t,e){let n=t.index();return e.page(n,Yr(t.page(n)))}function tl(t,e=0){let n=Date.now()+e;return t.has(n)?tl(t,parseInt(240*Math.random()*3600*1e3)):n}function el(t){if(!t||function(t){return Mr.keys().some((e=>Jr(e).code===t))}(t))return;let e=tl(Mr),n={shid:e,code:t,time:Date.now()};Mr.set(e,JSON.stringify(n))}const nl={spinit(t){Br=t.data},__spinit:1,shUndo:()=>(Fr.undo(),!Fr.canUndo()),shRedo:()=>(Fr.redo(),!Fr.canRedo()),shinit(t,e,n,r,l){Kr=t.data,r[Pr]=new On(null,w.shListTop),r[jr]=new Rn(e),l[Pr]=new On(null,w.shListAll),l[jr]=new Rn(n)},__shinit:1,delsh(t,e){Vr&&qr(new Wr(t.data),new Gr(e))},__delsh:1,topsh(t){let e=Jr(t.data);return e&&(e.top=!0,Mr.set(t.data,JSON.stringify(e))),e&&t.data},__topsh:1,untop(t){let e=Jr(t.data);return e&&(e.top=!1,Mr.set(t.data,JSON.stringify(e))),e&&t.data},__untop:1,shlabel(t,e){let n=Jr(t.data);return n&&(n.name=e,Mr.set(t.data,JSON.stringify(n))),n&&[e,t.data]},__shlabel:1,shpage(t,e){let n=new Xr(t.data,e);Vr&&qr(n)},__shpage:1,shtops(t){let e=t.data,n=e[Pr].reset(function(){let t=[];for(const e of Mr.keys()){let n=Jr(e);n&&n.top&&n.code&&t.push({id:n.shid,tm:n.time})}return t.sort(((t,e)=>e.tm-t.tm)).map((t=>t.id))}()),r=Zr(n,e[jr].reset());Qr(e,"page",r,"state",n.index()+1,n.pages())},__shtops:1,shIndex:t=>(Vr=!0,t.data.map((t=>Zr(t[Pr],t[jr].reset())))),__shIndex:1,shEdin(e){Fr.clear(),t.on(e.data,"nodeok emptied detach",null,Hr),t.on(e.data,"attrdone","nav >b",Hr)},__shEdin:1,shEdok(e){Vr=!1,Fr.clear(),t.off(e.data,"nodeok emptied detach attrdone",!1,Hr)},__shEdok:1,sh2panel(e,n,r,l,o){let i=t.outerHeight(r,!0)+t.outerHeight(l,!0),s=t.outerHeight(o,!0)-t.height(o);return[t.height(r)+e.data,t.height(n)-(i+s+e.data)]},__sh2panel:1,shsearch(t,e){let n=e[Pr].reset(function(t){let e=function(...t){return e=>t.some((t=>t.every((t=>e.includes(t)))))}(...t.split(",").map((t=>t.trim().split(/\s+/)))),n=[];for(const t of Mr.keys().reverse()){let r=Jr(t);r&&r.code&&e(r.code)&&n.push({id:r.shid,tm:r.time})}return n.sort(((t,e)=>e.tm-t.tm)).map((t=>t.id))}(t.data)),r=Zr(n,e[jr].reset());Qr(e,"page",r,"state",n.index()+1,n.pages())},__shsearch:1,shcode(e){t.trigger(Br,"shcode",e.data)},__shcode:1,shsave(t){el(t.data)},__shsave:1};s(g,"Kit",nl,["spinit","shUndo","shRedo","shinit","delsh","topsh","untop","shlabel","shpage","shtops","shEdin","shEdok","shIndex","sh2panel","shsearch","shcode","shsave"]);
//! $ID: highlight.js 2020.02.07 Cooljed.Libs $
const rl={keyword:"kw",literal:"lit",number:"num",function:"fn",operator:"op",builtin:"bin",datatype:"dt",xmltag:"tag",attribute:"atn",regex:"re",selector:"slr",rgba:"rgb",unit:"un",important:"imp",doctype:"doc",error:"err",comments:null};function ll(t,e){return null==e?t:"string"==e?`<s>${t}</s>`:"comments"==e?`<i>${t}</i>`:`<b role="${rl[e]||"non"}">${t}</b>`}function ol(e,n,r){return t.html(e,ll(n,r),"append"),e}function il(t){return t.map((t=>"string"==typeof t?t:ll(t.text,t.type))).join("")}function sl(t){let e=t[0],n=t[t.length-1];return e.text&&e.text.startsWith("\n")&&(e.text=e.text.substring(1)),n.text&&n.text.endsWith("\n")&&(n.text=n.text.slice(0,-1)),t}function al(e,n){let{text:r,type:l}=e;return t.isArray(r)&&(r=il(r)),[ol(n,r,l)]}function ul(e,n){let{text:r,type:l}=e,o=(t.isArray(r)?il(r):r).split("\n");return[ol(n,o.shift(),l),...o.map((t=>ol(n.cloneNode(),t,l)))]}function cl(t,e,n,r=!0){let l=[],o=Rr(lt,{lang:t});for(const i of e)void 0===i.text?(l.push(...cl(i.lang,r?sl(i.data):i.data,n)),o=Rr(lt,{lang:t})):(l.push(...n(i,o)),o=l[l.length-1]);return[...new Set(l)].filter((t=>!t.normalize()))}
//! $ID: property.js 2021.06.16 Cooljed.Libs $
const fl=/\s+/g,dl=t([_.rpLeft,_.rpRight]).elem("rp"),pl={[H]:function(e,n,r,l){t.attribute(e,r),void 0!==l&&xl(e,"source",l)},[M]:function(e,n,r,l,o){t.attribute(e,r),void 0!==l&&xl(e,"source",l);void 0!==o&&xl(e,"track",o)},3:function(e,n,r,l){let o=t.get("img",e);void 0!==l&&(t.fill(e,l),t.append(e,o));t.attribute(o,r)},[P]:_l,[V]:_l,4:_l,5:function(e,n,r,l,o,i){let s=t("rp",e),a=t.get("rt",e);void 0!==l&&(t.fill(e,l),a&&t.append(e,[s[0],a,s[1]]));if(void 0===r)return;a?t.fill(a,r):t.append(e,[o,t.elem("rt",r),i])},[F]:_l,7:gl,[J]:_l,[X]:_l,[Z]:_l,[tt]:_l,[lt]:function(e,n,r,l){void 0!==r&&t.attr(e,"-lang",function(e,n){let r=e.parentElement.parentElement;if(rn(r)!==ee)return n;return t.attr(r,"-lang")===n?null:n}(e,r));void 0!==l&&t.fill(e,l)},[ee]:function(e,n,r,l){t.attribute(e,r),void 0!==l&&t.fill(e,t(l).elem("li"))},[te]:_l,[re]:_l,[Rt]:_l,[Ht]:_l,[Mt]:_l,[Pt]:_l,[jt]:_l,[Bt]:_l,521:function(e,n,r,l,o){let i=new t.Table(e);void 0!==r&&t.attr(e,"border",r);void 0!==l&&bl(i,l,0);void 0!==o&&bl(i,o,null)},[ue]:function(e,n,r,l){t.cssSets(e,n,r),t.attr(e,"role",l)},528:gl,[q]:function(e,n,r){t.attr(e,n,r),t.cssSets(e,"top right bottom left",null)}},hl={[H]:function(t,e,n,r){return e.autoplay=n[0],e.loop=n[1],e.controls=n[2],[Tl(e,"",null),r]},[M]:function(t,e,n,[r,l]){return e.autoplay=n[0],e.loop=n[1],e.controls=n[2],[Tl(e,"",null),r,l]},3:function(t,e,n){return[Tl(e,"",null),n]},5:function(e,n,r){let l=t.get("rt",e);return t([n,r]).Text().concat(l?[]:dl.clone())},521:El,[rt]:wl,[Z]:wl,[tt]:wl,[lt]:yl,[ee]:function(e,n,r,l){let o={"-lang":n,start:r},i=t.attr(e,"-lang")||"";if(Tl(o,"",null),!l&&n===i)return[o];return[o,Sl(e,n)]}},ml={[H]:function(e,n,r,l){let o=l&&t(l);return n.autoplay=r[0],n.loop=r[1],n.controls=r[2],Tl(n,"",void 0),Tl(n,null,void 0),e.map((()=>[n,o?o.clone():void 0]))},[M]:function(e,n,r,[l,o]){let i=l&&t(l),s=o&&t(o);return n.autoplay=r[0],n.loop=r[1],n.controls=r[2],Tl(n,"",void 0),Tl(n,null,void 0),e.map((()=>[n,i?i.clone():void 0,s?s.clone():void 0]))},3:function(e,n,r){let l=r&&t(r);return Tl(n,"",void 0),e.map((()=>[n,l?l.clone():void 0]))},5:function(e,n,r){let l=[void 0,void 0];n&&(l[0]=t.Text(n));r&&(l[1]=t.Text(r));return e.map((e=>l.concat(t.get("rt",e)?[]:dl.clone())))},521:function(t,e,n,r){return t.map((t=>El(t,e,n,r)))},[rt]:vl,[Z]:vl,[tt]:vl,[lt]:function(t,e){return t.map((t=>yl(t,e)))},[ee]:function(e,n,r){return e.map((e=>function(e,n,r){let l={"-lang":n,start:r},o=t.attr(e,"-lang")||"";if(Tl(l,"",void 0),Tl(l,null,void 0),n===o||null===n)return[l];return[l,Sl(e,n)]}(e,n,r)))}};function gl(e,n,...r){t.cssSets(e,n,r)}function _l(e,n,...r){t.attribute(e,n,r)}function wl(t,e,n,r){return n&&(e=e?`${e} ${n}`:`${n}`),[e||null,r||null]}function vl(t,e,n,r){return n&&(e=e?`${e} ${n}`:`${n}`),Cl(t,[e||void 0,r||void 0])}function yl(e,n){let r=e.textContent;if(""===n)return[null,t.Text(r)];let l=cl(null,er([r],n),al,!1);return[n,(o=l,o.map((t=>[...t.childNodes])).flat())];var o}function bl(t,e,n){let r=t.hasVth(null==n);e?r||t.insertColumn(e,n):r&&t.removeColumn(null==n?-1:n)}function xl(e,n,r){t.find(n,e).forEach((e=>t.remove(e))),t.append(e,r)}function El(e,n,r,l){let o=new t.Table(e),i=o.hasVth(),s=o.hasVth(!0);return[n,r?i||o.newColumn(!0):null===r?void 0:null,l?s||o.newColumn(!0):null===l?void 0:null]}function Tl(t,e,n){for(const r of Object.keys(t))t[r]===e&&(t[r]=n);return t}function Cl(t,e){return new Array(t.length).fill(e)}function Nl(t,e){let n=t.map((t=>t.hasVth(!!e)));return 1===n.length||1===new Set(n).size?[n[0],!1]:[null,!0]}function Sl(e,n){let r=t.children(e).map((t=>t.textContent));return""===n?t(r).elem("code"):cl(null,er(r,n),ul)}const $l={vals1:t=>1===t.data.length||1===new Set(t.data).size?t.data[0]||"":null,__vals1:1,vals2:t=>1===t.data.length||1===new Set(t.data).size?[t.data[0],!1]:[null,!0],__vals2:1,tableVth(e){let n=e.data.map((e=>new t.Table(e)));return[Nl(n),Nl(n,!0)]},__tableVth:1,attrVal:(e,n)=>n.split(fl).map((n=>function(e,n){let r=e.map((e=>t.attr(e,n)));return 1===r.length||1===new Set(r).size?r[0]||"":null}(e.data,n))),__attrVal:1,attrBool:(e,n)=>n.split(fl).map((n=>function(e,n){let r=e.map((e=>t.attr(e,n)));return 1===r.length||1===new Set(r).size?[null!==r[0],!1]:[null,!0]}(e.data,n))),__attrBool:1};a(v,"p",$l,Object.keys($l).filter((t=>"_"!==t[0])));
//! $ID: plugins.js 2021.09.23 Cooljed.Plugins $
const Al=Object.create(u),kl=Object.create(c),Ol=new U(y),Rl=new Map,Il=new Map,zl=new WeakMap;function Ll(e,n=b.plugConf){return Ol.json(`${e}/${n}`).then((n=>function(e,n){if(n.style)return t.style({href:`${y}${e}/${n.style}`}).then((t=>Il.set(e,t)&&n));return n}(e,n))).then((t=>function(t,e){if(!e.extend)return e;return import(`${y}${t}/${e.extend}`).then((t=>function(t,e){return t.on=e.On||null,t.by=e.By||null,t}(e,t)))}(e,t))).then((t=>function(t,e){if(!e.root)return null;let n=new L(d(e.on,e.by),new D(t,Ol));return n.config(e.maps).then((()=>Ol.node(`${t}/${e.root}`))).then((t=>n.build(t,e.root)))}(e,t)))}function Ul(e,n=null){if(Rl.has(e))return Promise.resolve(null);let r=`${b.plugRoot}/${e}`,l=t.Element("img",{src:`${y}${r}/${b.plugLogo}`}),o=t.wrap(l,t.Element("button",{title:n}));return Ll(r).then((t=>Rl.set(e,o)&&f.templater(e,t)||zl.set(o,e)&&o))}
//! $ID: cmdline.js 2021.08.08 Cooljed.Libs $
const Dl=/^\(\s*\/(.*)\/([imsu]*)\s*\)$/,Hl=/^\(([^]*?)\)$/,Ml=/^\[([\d:,\s]*)\]$/,Fl=/\s*:\s*/,Pl=/^\{(.*)\}$/,jl=/^\/(.*)\/([imsugy]*)$/,Bl=/^(['"`])(.*)\1$/,Kl=new $("|",new A,new O("[","]"),new O("{","}"));let Vl=null,Wl=null;class Gl{constructor(t,e){this._set=t,this._ctx=e}exec(t,e){let n=[...Kl.reset().split(t.trim())],r=n.shift();return no(n,this._set.size>0?this._finds(r,e,[...this._set]):this._find(r,e,this._ctx))}_find(t,e,n){return z.find(t,e,!1,n)}_finds(t,e,n){return n.map((n=>z.find(t,e,!1,n))).flat()}}class Xl{constructor(t){this._set=t}exec(e){return no([...Kl.reset().split(e.trim())],t(this._set))}execOne(e,n){return this._handle(e.trim())(t(n))}_handle(t){return Dl.test(t)?this._texter(t):Hl.test(t)?this._exclude(t.match(Hl)[1]):Ml.test(t)?this._number(t.match(Ml)[1]):Pl.test(t)?this._filter(t.match(Pl)[1]):e=>e.filter(t)}_exclude(e){return n=>n.filter((n=>!t.is(n,e)))}_number(t){let e=t.split(Fl);return e.length>1?this._range(e):(e=JSON.parse(`[${t}]`),t=>e.map((e=>t[e])).filter((t=>t)))}_range([t,e]){return t=Math.trunc(t)||0,e=e.trim()?Math.trunc(e):void 0,n=>n.slice(t,e)}_texter(t){return e=>e.filter(new RegExp(...t.match(Dl).slice(1)))}_filter(t){let e=new Function("v","i","c",`return ${t};`);return t=>t.filter(e)}}class ql{constructor(t){this._ctx=t,this._doc=t.ownerDocument}exec(t,e){return t=jl.test(t)?this._regexp(t):ro(t),e.map((e=>this._ranges(e,t))).flat()}_ranges(t,e){let n=[],r=0,l=0;for(;[r,l]=this._search(t.textContent,e,r),!(r<0||0===l);)n.push(this._range(t,r,l)),r+=l;return n}_search(t,e,n){if("string"==typeof e)return[t.indexOf(e,n),e.length];let r=t.substring(n),l=r&&r.match(e);return l?[n+l.index,l[0].length]:[-1,0]}_range(t,e,n){let r=this._doc.createRange();return r.setStart(t,e),r.setEnd(t,e+n),r}_regexp(t){let[e,n]=t.match(jl).slice(1);return n&&(n=n.split("").filter((t=>"g"!==t)).join("")),new RegExp(e,n)}}class Jl{constructor(t){this._cmds=new Map([["plug-ins",this._plugIns],["plug-del",this._plugDel],["help",this._help],["config",this._config],["replace",this._replace.bind(this)]]),this._eset=t}exec(t){let[e,n]=this._cmdArgs(t),r=this._cmds.get(e);if(!e)return E.commandInvalid;try{return r(...n)||""}catch(t){return`[${t.name}]: ${t.message}`}}_cmdArgs(t){for(const e of this._cmds.keys())if(t===e||t.startsWith(e+" "))return[e,this._args(t.substring(e.length+1))];return[]}_args(e){return t.split(e," ",1/0,!0).filter((t=>t)).map(ro)}_help(e){t.trigger(Vl,"open"),t.trigger(Vl,"help",e)}_plugIns(e,n){t.trigger(Wl,_.plugIns,Ul(e,n))}_plugDel(e){t.trigger(Wl,_.plugDel,function(e){let n=Rl.get(e),r=`${b.plugRoot}/${e}`,l=Il.get(r);return n&&(Rl.delete(e),f.templater(e,null)),l&&(t.remove(l),Il.delete(r)),n||null}(e))}_config(t,e){if(void 0===e)return w[t].toString()||E.configNothing;if(void 0===T[t])throw new Error(`${t} option is not supported`);return`Fx.${t}=${T[t]=e&&JSON.parse(e)}`}_replace(...t){return t.length?this._eset.size?[new eo([...this._eset],...t)]:E.selectNone:E.missContent}}class Yl{constructor(t,e){this._set=t,this._ctx=e}exec(e,n){let r=new Function("$$","$","_",`return ${e};`),l=null;try{l=r(t(this._set),n,this._ctx)}catch(t){l=`[${t.name}]: ${t.message}`}return""+l}}class Ql{constructor(){this._buf=[]}add(t){this._buf[this._buf.length-1]!==t&&this._buf.push(t)}find(t){let e=this._buf.slice().reverse(),n=[],r=0;for(;r>=0;)r=this._indexOf(t,e,r),r>=0&&n.push(e[r++]);return n}size(){return this._buf.length}_indexOf(t,e,n=0){for(;n<e.length;n++)if(e[n].startsWith(t))return n;return-1}}class Zl{constructor(t){this._buf=t,this._idx=0}next(){let t=this.size()-1;return this._idx<t?this._buf[++this._idx]:null}prev(){return this._idx>0?this._buf[--this._idx]:null}first(){return this._idx=0,this._buf[0]||null}last(){return this._idx=this._buf.length-1,this._buf[this._idx]||null}reset(){return this._idx=0,this}size(){return this._buf.length}}const to={[x.select]:new Ql,[x.filter]:new Ql,[x.search]:new Ql,[x.command]:new Ql,[x.calcuate]:new Ql};class eo{constructor(e,n,r){if(!this._checks(e))throw new Error(E.needContent);void 0===r?[n,r]=[/[^]+/,n]:n=this._regstr(n),this._tts=t(e).map((t=>t.textContent.replace(n,r))).Text(),this._els=e,this._old=e.map(((t,e)=>this._fill(t,this._tts[e])))}undo(){this._els.forEach(((t,e)=>this._fill(t,this._old[e])))}redo(){this._els.forEach(((t,e)=>this._fill(t,this._tts[e])))}_checks(t){return t.every((t=>dn(t)))}_regstr(t){return jl.test(t)?new RegExp(...t.match(jl).slice(1)):t}_fill(e,n){let r=[...e.childNodes];return e.textContent="",e.append(...t.isArray(n)?n:[n]),r}}function no(t,e){return t.reduce(((t,e)=>(new Xl).execOne(e,t)),e)}function ro(t){return Bl.test(t)?t.match(Bl)[2]:t}function lo(e,n){Vl=e,Wl=n,t.trigger(n,_.plugInit,b.plugList.reduce(((t,e)=>t.then((t=>Ul(e[0],e[1]).then((e=>t.push(e)&&t))))),Promise.resolve([])))}function oo(t){return to[t]}
//! $ID: edit.js 2019.09.07 Cooljed.Libs $
const io=t.Fx.History.Normalize,so=`${_.selectedClass} ${_.focusClass} ${_.hoverClass} ${_.pointClass}`,ao=`.${_.selectedClass}, .${_.focusClass}, .${_.hoverClass}, .${_.pointClass}`,uo=Symbol(),co=/\s+/g,fo=/\n\s*\n/,po=/(\s)\s*/g,ho=/\r\n|\n|\r/,mo=/section|article/i,go=/\sclass="[\w\s]+"/,_o={[It]:["dd",oe],[At]:["p",ae],[Ct]:["p",qt],[Ct]:["p",Jt],[Ct]:["p",Yt],[Ct]:["p",ie],[Ct]:["p",se]},wo=new Set([Rt,It,zt,wt,yt,vt,xt]),vo={minied:"miniedIn",toup:"indentReduce",todown:"indentIncrease",delete:"deletes",range:"elementRange",property:"properties"},yo={children:os,siblings:function(t){return os([...rs(t)])}},bo=new Set(["a","ruby","bdo","fcona"]),xo=`${e.on} ${e.by} ${e.to}`,Eo=new Set([e.on,e.by,e.to,xo]),To=new Sn(_.selectedClass),Co=new class{constructor(t){this._cls=t,this._its=null}set(t){let e=this._its;return e!==t&&this._set(t),e}get(){return this._its||null}is(t){return!!t&&t===this._its}cancel(){return this._its&&t.removeClass(this._its,this._cls),this._its=null}_set(e){if(null==e)return this.cancel();this._its&&t.removeClass(this._its,this._cls),this._its=t.addClass(e,this._cls)}}(_.focusClass),No=new class{constructor(t){this._set=t,this._np2=null,this._tmp=null}pickback(t){return this._tmp?this._restore():this._pick(t)}cando(t){return!!(this._tmp||this._set.size>1)||1===this._set.size&&!this._set.has(t)}reset(){this._tmp=null,this._np2=null}_pick(t){return this._tmp=[...this._set],this._np2=this._set.cruise(),this._set.clear().add(t)}_restore(){return this._set.clear().pushes(this._tmp.filter((t=>t.isConnected))),this._set.cruise(this._np2.map((t=>t&&t.isConnected?t:null))),this._np2=null,this._tmp=null,[...this._set]}}(To),So=new class{constructor(e="_cursor_"){let n=e+(Date.now()%4294967295).toString(16);this._cel=t.attr(t.elem("i"),n,""),this._slr=`[${n}]`}cursor(e,n){let r=n.commonAncestorContainer,l=t.contains(e,r);return l&&(3===r.nodeType&&0===n.endOffset&&n.setEnd(n.endContainer,1),n.collapse(!1),n.insertNode(this._cel)),n.detach(),l&&e}active(e){let n=t.get(this._slr,e),r=document.createRange();return n?(r.selectNode(n),r.deleteContents(),e.normalize()):r.selectNodeContents(e),this._active(r,e)}active2(e,n=!1){let r=t.get(this._slr,e),l=document.createRange();return r&&(r.remove(),e.normalize()),l.selectNodeContents(e),l.collapse(n),this._active(l,e)}clean(e){let n=t.get(this._slr,e);return n&&(n.remove(),e.normalize()),n&&e}_active(t,e){let n=window.getSelection();return n.removeAllRanges(),n.addRange(t),t.detach(),e.focus(),e}},$o=new t.Fx.History,Ao=new An(`${_.nameEditor}_`),ko=new $(";",new A,new k);class Oo{constructor(t,...e){this._fun=t,this._vals=e,this.count=null,this.redo()}undo(){this.count>0&&$o.back(this.count)}redo(){let t=$o.size();this._fun(...this._vals),this.count=$o.size()-t}changed(){return this.count>0}}class Ro{constructor(t,...e){this._fun=t,this._args=e,this._data,this.count=null,this.redo()}undo(){this.count>0&&$o.back(this.count)}redo(){let t=$o.size();this._data=this._fun(...this._args),this.count=$o.size()-t}changed(){return this.count>0}result(){return this._data}warn(t){if(void 0===t)return this._msg;this._msg=t}}class Io{constructor(t,e){this._nds=t,this._old=t.map((t=>t.textContent)),this._tts=this._old.map(e),this.redo()}undo(){this._nds.forEach(((t,e)=>t.textContent=this._old[e]))}redo(){this._nds.forEach(((t,e)=>t.textContent=this._tts[e]))}}class zo{constructor(t,...e){this._fun=t,this._vals=e,this._old=[...To],this._np2=To.cruise(),this._newsel()}undo(){To.clear().pushes(this._old),To.cruise(this._np2),ls(ti,_.evnFollow)}redo(){To.cruise(null),this._newsel()}_newsel(){this._fun(...this._vals),ls(ti,_.evnFollow)}}class Lo{constructor(t){this._old=[...To],this._np2=To.cruise(),this._new=Po.pickBack(t)}undo(){To.clear().pushes(this._old),To.cruise(this._np2),No.reset(),ls(ti,_.evnFollow)}redo(){To.cruise(null),To.clear().pushes(xs(this._new)),ls(ti,_.evnFollow)}}class Uo{constructor(t=Co.get()){this._hot=t,this._old=ii(t)}undo(){ii(this._old)}redo(){ii(this._hot)}}class Do{constructor(t){t&&this.redo()}undo(){ls(ti,_.evnFollow)}redo(){ls(ti,_.evnFollow)}}class Ho{constructor(t,e){this._el=Rr(e,...this._optData(e,t)),this._old=[...t.extractContents().childNodes],t.insertNode(this._el),t.collapse(),t.detach(),this._tmp=null}undo(){let t=this._el.parentElement;this._el.replaceWith(...this._old),this._tmp=new io(t)}redo(){this._tmp.back(),this._old.slice(1).forEach((t=>t.remove())),this._old[0].replaceWith(this._el)}elem(){return this._el}completed(){return this._whole}_optData(t,e){let n=this[`_${t}`],r=e.cloneContents();return n?n(this,e.toString(),r):[null,r]}_a(t,e,n){return t._whole=Ho.url.test(e.trim()),[t._whole&&{href:e},n]}_fcona(e,n,r){return[{},t.contents(r,null,!1,!0),!0]}_ruby(t,e,n){let r=e.trim().match(Ho.ruby),l=r?r[2]:_.rtHolder,o=r?r[1]:n;return t._whole=r,[{rt:l},o]}}Ho.url=/^(?:http|https|ftp|email):\/\/\w[\w.-]+\/\S+$/i,Ho.ruby=RegExp(`^([\\S\\x20]+)\\${_.rpLeft}([\\w\\u00c0-\\u017e\\u3105-\\u312d ]+)\\${_.rpRight}$`,"i");class Mo{constructor(e){this._el=t.attr(t.elem("mark",e.toString()),"role","tmp"),this._old=[...e.extractContents().childNodes],e.insertNode(this._el),e.detach(),this._tmp=null}undo(){let t=this._el.parentElement;this._el.replaceWith(...this._old),this._tmp=new io(t)}redo(){this._tmp.back(),this._old.slice(1).forEach((t=>t.remove())),this._old[0].replaceWith(this._el)}elem(){return this._el}}class Fo{constructor(t,e){this._cp=this._clone(t,e),this._el=t,t.replaceWith(this._cp),this._cp.setAttribute("contenteditable",!0)}active(){So.active(this._cp)}activeEnd(){So.active2(this._cp,!1)}done(){let e=this._clean(t.clone(this._cp),rn(this._cp));Ns((()=>t.fill(t.removeAttr(this._cp,"contenteditable"),e)))}elem(){return this._cp}original(){return this._el}undo(){this._cp.replaceWith(this._el)}redo(){this._el.replaceWith(this._cp)}_clone(e,n){So.cursor(e,n);let r=t.clone(e,!0,!0,!0);return So.clean(e),r}_clean(e,n){return t.fill(e,this._inlines(e.childNodes)),n===bt?t("br",e).replace("\n"):n===lt&&this._codeparse(e),[...t.normalize(e).childNodes]}_inlines(t){let e=[];for(const n of t){let t=n.nodeType;3===t||8===t?e.push(n):1===t&&e.push(Vn(n))}return e}_codeparse(e){let n=t.attr(e,"-lang");if(!n)return t("br",e).replace("\n");t.html(e,cl(null,er([e.textContent],n),al,!1).map((t=>t.innerHTML)).join(""))}}class Po{only(t){if(1==To.size&&To.has(t))return!1;To.clear(),To.add(t)}turn(t){To.has(t)?To.delete(t):this.clean(t).add(t)}reverse(t){for(const e of t)To.has(e)?To.delete(e):this._parentAdd(e)}expand(t,e){return To.has(e)?this.adds(t):this.removes(t)}adds(t){t.forEach((t=>To.has(t)||this._parentAdd(t)))}removes(t){t.forEach((t=>To.has(t)&&To.delete(t)))}empty(){if(0==To.size)return!1;To.clear()}add(t){To.has(t)||this.clean(t).add(t)}safeAdd(t){To.has(t)||To.add(t)}safeAdds(t){To.pushes(t)}delete(t){return To.has(t)&&To.delete(t)}unshift(t){let e=[...To];e.length&&To.clear(),this.adds(t.concat(e))}cleanUp(t){let e=this._parentItem(t);return!!e&&(To.delete(e),To)}cleanDown(t){let e=this._contains(t);return!!e.length&&(e.forEach((t=>To.delete(t))),To)}clean(t){return this.cleanUp(t)||this.cleanDown(t)||To}_parentAdd(t){this.cleanDown(t),To.add(t)}_parentItem(e){for(const n of To)if(t.contains(n,e,!0))return n;return null}_contains(e){let n=[];return To.forEach((r=>t.contains(e,r,!0)&&n.push(r))),n}}Po.pickBack=No.pickback.bind(No);const jo=new Po,Bo=new class{toText(t){t.text(t.text())}unWrap(e){let n=new Set;e.forEach((t=>n.add(t.parentElement))),e.unwrap(),t(n).normalize()}newAfter(e,n){t.after(e,n)}newBefore(e,n){t.before(e,n)}newPrepend(e,n){t.prepend(e,n)}newAppend(e,n){t.append(e,n)}cloneAfter(e,n){e.forEach(((e,r)=>t.after(e,n[r])))}appends(e,n){e.forEach((e=>t.append(e,n)))}fills(e,n){e.forEach((e=>t.fill(e,n)))}replaces(e,n){e.forEach(((e,r)=>t.replace(e,n[r])))}replacex(e,n){t.replace(e[0],n),e.slice(1).forEach((e=>t.remove(e)))}insert(e,n,r){e?t.before(e,r):t.append(n,r)}alignInsert(e,n,r){e.forEach(((e,l)=>t[n](e,r[l])))}reverses(t){for(const e of t){let t=e.length-1;for(let n=0;n<parseInt(e.length/2);n++)jn(e[n],e[t-n])}}merges(e,n,r){t.append(e,n),r.filter(Yi).remove()}movePrev(e,n){for(const r of e)0===n?t.before(Fn(r[0],1/0),r):r.forEach((e=>t.before(Fn(e,n),e)))}moveNext(e,n){for(const r of e)0===n?t.after(Pn(Ts(r),1/0),r):r.reverse().forEach((e=>t.after(Pn(e,n),e)))}sectionsUp(e){e.forEach((e=>function(e){let n=e.parentElement;if("s1"===t.attr(e,"role"))return $s(E.sectionNotUp,e);t.after(n,function(e){return t.find("section",e).forEach((t=>xn(t,-1))),xn(e,-1)}(e)||e)}(e))),si()}sectionsDown(e){e.forEach((e=>{return n=e[0],r=e[1],function(e){t.find("section",e).forEach((t=>xn(t,1))),xn(e,1)}(n),void t.append(t.replace(n,r),n);var n,r})),si()}styles(e,n,r){for(const l of e)t.cssSets(l,n,r)}attrs(e,n,r){for(const l of e)t.attribute(l,n,r)}},Ko=new kn(w.history,$o);let Vo=null,Wo=null,Go=null,Xo=null,qo=null,Jo=null,Yo=null,Qo=null,Zo=null,ti=null,ei=null,ni=null;function ri(...t){li(),Cs(null),Ko.push(...t.filter((t=>t)))}function li(){t.trigger(Vo,_.redoEvent,!1,!0)}function oi(t,e){return void 0===e?t[uo]:(t[uo]=e,t)}function ii(e){try{return null==e?t.empty(Go):(t.intoView(e,0),t.fill(Go,function(e,n){return[e].concat(t.parentsUntil(e,(t=>t===n))).reverse().map((e=>oi(t.elem("b",function(t){let e=t.tagName.toLowerCase();return t.hasAttribute("role")&&(e+=":"+t.getAttribute("role")),e}(e)),e)))}(e,Vo))),Co.set(e)}finally{!function(e){t.trigger(Wo,_.covert,e&&cn(e)&&us(e)||"")}(e)}}function si(){let t=Co.get();To.has(t)&&ii(t)}function ai(t,e){jo.cleanUp(e),jo.expand(t,e)}function ui(t,e){t.forEach((t=>jo.cleanUp(t))),jo.expand(t,e)}function ci(t,e){t.forEach((t=>jo.cleanUp(t))),jo[e](t)}function fi(t,e,n){n&&jo.cleanUp(t),jo[e](t)}function di(t,e){return[new zo(fi,t,e),new Uo(t)]}function pi(t,e){for(const n of t)jo.cleanUp(n),jo.adds(e(n))}function hi(t){jo.empty(),jo.safeAdds(t)}function mi(t){jo.empty(),t.forEach((t=>jo.add(t)))}function gi(t){jo.cleanUp(t),jo.reverse(t.parentElement.children)}function _i(){return To.size>0&&new zo((()=>To.clear()))}function wi(t){return(t=xs(t)).length>0&&new zo((()=>To.pushes(t)))}function vi(e,n){let r=Co.get();return r&&e.length?e.some((e=>t.contains(e,r,!n)))&&new Uo(null):null}function yi(e,n){if(0!==e.length)return n&&!e.every(Yi)?(Cs("has_cannot_del",Bi(e)),null):new Oo((()=>t(e).remove()))}function bi(t,e,n){return t.length>0&&new Oo(Bo[n],t,e)}function xi(e,n,r,l){if(!ts(n))return Cs("cannot_append",n);if(!e.every(Yi))return Cs("has_cannot_del",Bi(e));let o=Ci(r,n,e.clone(!0,!0,!0)),i=_i(),s=l&&new Oo((()=>t.empty(n)));return[new Uo,i,s,new Oo((()=>e.remove())),o.length&&new Oo(Bo.insert,r,n,o),...Ti(n,o)]}function Ei(e,n,r,l){if(!ts(n))return Cs("cannot_append",n);let o=Ci(r,n,e),i=_i(),s=l&&new Oo((()=>t.empty(n)));return[new Uo,i,s,o.length&&new Oo(Bo.insert,r,n,o),...Ti(n,o)]}function Ti(t,e){return dn(t)?[new zo((()=>To.add(t)))]:[wi(e),new Uo(e[0])]}function Ci(e,n,r){try{return Ns((()=>r.map((t=>Or(e,n,{},t))).flat().map((e=>e&&t.remove(e))).filter((t=>t))))}catch(t){throw $s(t,n)}}function Ni(e,n,r){if(n=isNaN(n)?1:n||1/0,!e||n<0)return;let l=t.prevAll(e,((t,e)=>e<=n));return l.length&&r(l,e)}function Si(e,n,r){if(n=isNaN(n)?1:n||1/0,!e||n<0)return;let l=t.nextAll(e,((t,e)=>e<=n));return l.length&&r(l,e)}function $i(e,n,r){if(n=isNaN(n)?1:n,!e||n<=0)return;let l=t.closest(e,((t,e)=>e==n||t===Vo));return l&&l!==Vo&&r(l)}function Ai(e,n,r){if(n=n||0,!e||n<0)return;let l=t.children(e,n);return l&&r(l)}function ki(t,e){let n=yn(t,Vo);return n&&e(n)}function Oi(e,n){return e.size===n.length&&t.every(e,((t,e)=>n[e]===t))}function Ri(t,e,n){if(!t.length||t.some(zi))return;return new Oo(Bo.styles,t,e,(t=>`${(parseFloat(t)||0)+n}px`))}function Ii(t,e){return new Oo(Bo.styles,t,e,"auto")}function zi(e){return 108===rn(e)||"absolute"!==t.css(e,"position")}function Li(e){let n=new Uo(null),r=null,l=new Oo((()=>t.normalize(e)));return To.has(e)&&(r=new zo(jo.delete,e)),ei=new Fo(e,window.getSelection().getRangeAt(0)),t.trigger(Vo,_.medIn,null,!0),t.trigger(Yo,"hide"),t.trigger(Zo,_.insType,_.miniedTpl),[n,r,l,ei,new Uo(ei.elem())]}function Ui(e){let n=t.attr(t.elem(e.tagName),"role",t.attr(e,"role"));return[new Oo(Bo.newAfter,e,n),...Li(n)]}function Di(e,n){let r=rn(n),l=_o[r];return Mi(e,N.Keys.miniedSameLine)?wo.has(r)&&Ui(n):!!Mi(e,N.Keys.miniedLogicLine)&&(function(t,e){return t&&t[1]===rn(e.parentElement)}(l,n)?function(e,n){let r=t.elem(n);return[new Oo(Bo.newAfter,e,r),...Li(r)]}(n,l[0]):wo.has(r)&&Ui(n))}const Hi={[_.levelName1]:[Bo.newAfter,Bo.newBefore],[_.levelName2]:[Bo.newAppend,Bo.newPrepend]};function Mi(t,e){let n=e.split(co);return n.length===t.size&&n.every((e=>t.has(e.toLowerCase())))}function Fi(t){let e=new Map;for(const n of t){let t=n.parentElement;(e.get(t)||e.set(t,[]).get(t)).push(n)}return[...e.values()]}function Pi(e){let n=Co.get(),r=t.contains(e,n);try{return r&&Co.cancel(),an(e)}finally{r&&Co.set(n)}}function ji(t,e){return e=isNaN(e)?1:e,new Array(e).fill().map((()=>an(t)))}function Bi(t){for(const e of t)if(!Yi(e))return e}function Ki(t){for(const e of t)if(!gn(e))return e}function Vi(t){for(const e of t)if(_n(e))return e}function Wi(e,n,r){let l=n.cellIndex(e);return t.isArray(l)?function(t,[e,n],r){let l=new Set;for(let o=e;o<n;o++)t.column(o,r).forEach((t=>l.add(t)));return[...l]}(n,l,r):n.column(l,r)}function Gi(e,n){if(!e)return;let r=e.parentElement;if(!t.contains(r,n,!0))return null;for(;n.parentElement!==r;)n=n.parentElement;return n}function Xi(t){return(t=t.parentElement)!==Vo&&t}function qi(t){let e=new Set,n=0;for(const[r,l]of t.entries()){let t=l.parentElement;if(n+=t.childElementCount,e.add(t).size===r)throw $s("repeat sibling",l)}if(n===t.size)throw $s("no more sibling")}function Ji(t,e){return e=e||t[0].tagName,t.every((t=>t.tagName===e))}function Yi(t){let e=rn(t);return ke(e)||Oe(e)||ze(e)}function Qi(t){let e=rn(t);return Ie(e)||Oe(e)&&!Ee(e)}function Zi(t){let e=rn(t);return dn(t.parentElement)&&Ie(e)||e===X}function ts(t){let e=rn(t);return!Ee(e)&&!Ae(e)}function es(t,e){return ts({prepend:t,append:t,fill:t,before:t.parentElement,after:t.parentElement,replace:t.parentElement}[e])}function ns(t){return t.reduce(((t,e)=>t.add(rn(e))),new Set)}function rs(t){let e=new Set;for(const n of t)n.parentElement&&e.add(n.parentElement);return e}function ls(e,n,r=1,...l){setTimeout((()=>e.isConnected&&t.trigger(e,n,...l)),r)}function os(e){return function(e){let n=e.shift();if(!n||"TABLE"===n.tagName&&e.length>0)return[];let r=[...sn(n)];return e.length>0&&(r=r.filter((t=>e.every((e=>on(e,t)))))),t.map(r.filter((t=>!Dr.has(t))),(t=>Lr[t]))}(e.filter((t=>!Ae(rn(t)))))}function is(e,n,r="text"){return e?t("tr",e).find(n)[r]():null}function ss(t,e){return t&&Mn(t).then((t=>t?xs(t).map((t=>Rr(e,t))):[]))}function as(t){let e=t.commonAncestorContainer;return 3===e.nodeType?e.parentElement:e}function us(t){let e=[...t.attributes].map((t=>`${t.name}="${t.value}"`)).join(" ");return e?`<${t.tagName} ${e}>`:`<${t.tagName}>`}function cs(t){return fs(t).outerHTML}function fs(e){let n=t.clone(e);return t.find(ao,n,!0).forEach((e=>t.removeClass(e,so))),n}function ds(t,e,n,r){let l=[...t];return l.length||(l=[...Vo.children]),n&&(e.TEXT=l.map((t=>t.textContent))),r&&(e.HTML=l.map(cs)),e}function ps(t,e){let n,r=new Function("$$","$","_",t);try{n=r(e,hs,Vo)}catch(t){return{type:"error",data:t}}return void 0===n?null:{type:"value",data:n,code:t}}const hs=new Proxy(t,{apply:(t,e,n)=>t(n[0],n[1]||Vo)});function ms(t,e){return e.some((e=>""!==t.style[e]))}function gs(t,e){let n=t[0].style[e];for(const r of t.slice(1))if(r.style[e]!==n)return null;return n}function _s(e,n){let r=sn(e),l=[];for(const t of n)(3!==t.nodeType||t.textContent.trim())&&(Tn(t,r)||l.push(t));return l.length?l:function(e){for(const n of e){if(1!==n.nodeType)continue;let e=_s(n,t.contents(n));if(e)return e}}(n)}function ws(t){return 3===t.nodeType?t.textContent:t.cloneNode().outerHTML.replace(RegExp(`</${t.tagName}>$`,"i"),"")}function vs(t,...e){for(const n of e)[n[t],n[t-1]]=[n[t-1],n[t]]}function ys(t){return ko.reset(),[...ko.split(t)].join(" ").trim()}function bs(t,e="-"){let n=t.length;for(;n--&&(!t[n]||t[n]===e););return n+1}function xs(e){return t.isArray(e)?e:[e]}function Es(t){for(const e of t.values())return e}function Ts(t){return t[t.length-1]}function Cs(e,n=null){if(null===e)return t.trigger(Xo,"off");let[r,l]=C[e];t.trigger(oi(Xo,n),"on"),t.trigger(t.get("a",Xo),"setv",[r,l,l]),T.beeptip&&ni.play()}function Ns(e){let n=t.config({varyevent:!1,bindevent:!1});try{return e()}finally{t.config(n)}}function Ss(t){ls(qo,_.info,10,t)}function $s(e,n){return t.trigger(oi(Xo,n),"on"),t.trigger(t.get("a",Xo),"setv",[null,e,e]),T.beeptip&&ni.play(),new Error(e)}const As={[x.select]:null,[x.filter]:null,[x.search]:null,[x.command]:null,[x.calcuate]:null},ks={[x.select]:function(t,e){if(!t.exec(e,Co.get()).length)return E.selectNone;return Os([],t.exec(e,Co.get()))},[x.filter]:function(t,e){return Os([],t.exec(e))},[x.search]:function(e,n){let r=(To.size?t(To):t(Vo.children)).textNodes(!0,!0).flat(),l=r.length&&e.exec(n,r);if(!l.length)return`${E.searchNothing} ${n}`;let o=l.map((t=>new Mo(t)));return Os(o,o.map((t=>t.elem())))},[x.command]:function(t,e){return t.exec(e)},[x.calcuate]:function(t,e){let n=t.exec.bind(t),r=new Ro(n,e,Co.get());r.changed()&&(r.warn(E.undoWarn),ri(r));return r.result()}};function Os(t,e){return t.concat(_i(),wi(e),new Uo(e[0]))}function Rs(e){let n={},r=[];for(const l of e){let[e,o]=zr(l);r.push(o),t.assign(n,e)}return[n,r]}function Is(e,n){let r=function(t){let e=Me[t.toUpperCase()];return sr[e]?_.convBlocks:ar[e]?_.convLines:ir[e]?_.convInlines:null}(e);switch(r){case _.convInlines:return function(t,e){let[n,r]=Rs(e),l=r.map((e=>Rr(t,n,e)));return[new Oo(Bo.replaces,e,l),l]}(e,n);case _.convLines:return function(e,n){let[r,l]=Rs(n),o=l.map((n=>t.isArray(n)?n.map((t=>Rr(e,r,t))):Rr(e,r,n)));return[new Oo(Bo.replaces,n,o),o.flat()]}(e,n);case _.convBlocks:return function(t,e){let[n,r]=Rs(e),l=null;return Ir(e[0])===_.convLines?(l=Rr(t,n,r,!0),[new Oo(Bo.replacex,e,l),[l]]):(l=r.map((e=>Rr(t,n,e,!0))),[new Oo(Bo.replaces,e,l),l])}(e,n)}throw new Error(`[${e}] convert is not supported.`)}const zs={[Et]:{self:">h1, >hgroup",prev:null},500:{self:">h1, >hgroup",prev:null},[qt]:{self:">header[role=abstract]",prev:[Et]},507:{self:">nav[role=toc]",prev:[qt,Et]},512:{self:">article",prev:[507,qt,Et]},508:{self:">nav[role=reference]",prev:[512,507,qt,Et]},509:{self:">aside[role=seealso]",prev:[508,512,507,qt,Et]},[Yt]:{self:">footer",prev:[509,508,512,507,qt,Et]}},Ls={[Et]:{self:">h1",prev:null},[Tt]:{self:">h2",prev:null},[Nt]:{self:">h4",prev:null},[Ft]:{self:">h5",prev:null},[At]:{self:">summary",prev:null},[kt]:{self:">figcaption",prev:null},[Ot]:{self:">caption",prev:null},415:{self:">thead",prev:[Ot]},416:{self:">tbody:last-of-type",prev:[415,Ot]},417:{self:">tfoot",prev:[416,415,Ot]},[Jt]:{self:">header",prev:[Tt]},[Yt]:{self:">footer",prev:["LastChild"]},[V]:{self:">img",prev:["LastChild"]},LastChild:{self:">:last-child",prev:null}};function Us(e,n,r){let l=null;if(!n)return l;for(const o of n)if(l=t.get(r[o].self,e),l)break;return l}function Ds(e,n,r){let l=r[rn(n)],o=t.get(l.self,e);return o?new Oo((()=>t.replace(o,n))):(o=Us(e,l.prev,r),new Oo(o?()=>t.after(o,n):()=>t.prepend(e,n)))}function Hs(e,n,r=Vo){let l=zs[e],o=t.get(l.self,r);if(o)return t.replace(o,n);let i=Us(r,l.prev,zs);return i?t.after(i,n):t.prepend(r,n)}function Ms(){Ko.clear(),t.trigger(Vo,_.undoEvent,!1,!0),t.trigger(Vo,_.redoEvent,!1,!0)}function Fs(t){return Ji(t,"SECTION")&&t.some((t=>rn(t)!==Kt))}function Ps(t){return Ji(t,"SECTION")}function js(t){return 1===t.length&&Re(rn(t[0]))}function Bs(t){let e=[...ns(t)];return e.length>1||e[0]===Rt&&"OL"!==t[0].parentElement.tagName?null:Ur[e[0]]||null}const Ks=[function(t){return dn(t[0])},function(){return null!==ea.convtype()},Fs,Ps,function(t){return t.every(Yi)},js,Bs],Vs={[Kt]:qs,[Vt]:qs,[Wt]:qs,[Gt]:qs,[Xt]:qs,[Qt]:qs,521:function(t){return Js(t,">caption, >thead, >tfoot")},[Dt]:null,[Jt]:Xs,[Yt]:Xs,[ie]:Xs,[se]:Xs,[ae]:function(t){return Js(t,">summary")}};function Ws(t){let e=Vs[t];return null===e?null:e||Gs}function Gs(e){return t.children(e)}function Xs(t){return Js(t,">h4")}function qs(t){return Js(t,">h2")}function Js(e,n){let r=t.children(e);for(const l of t.find(n,e)){let t=r.indexOf(l);t>=0&&r.splice(t,1)}return r}function Ys(e,n){let r=rn(e);if(Ie(r))return!$e(r)&&n.every(dn)&&t(n).contents().flat();let l=[...ns(n)];return 521===r?1===l.length&&521===l[0]&&function(t,e){let n=wn(t).cols();return e.every((t=>n===wn(t).cols()))}(e,n)&&Qs(n):function(t,e){let n=qe[t];return void 0===n?!Ee(t)&&!Ae(t)&&e.every((e=>e===t)):e.every((t=>n===qe[t]))}(r,l)&&Qs(n)}function Qs(t){let e=[];for(const n of t){let t=Ws(rn(n));t&&e.push(...t(n))}return e}function Zs(t,e){let n=rn(t);return Ie(n)?$e(n)?t:function(t){for(const e of t)if(!dn(e))return e}(e):521===n?function(t,e){let n=wn(t).cols();for(const t of e)if("TABLE"!==t.tagName||n!==wn(t).cols())return t;return null}(t,e):Ee(n)||Ae(n)?t:En(t,e)}const ta={focusPrevious(t){Ni(Co.get(),t,(t=>ii(Ts(t))))},focusNext(t){Si(Co.get(),t,(t=>ii(Ts(t))))},focusParent(t){$i(Co.get(),t,(t=>ii(t)))},focusChild(t){Ai(Co.get(),t,(t=>ii(t)))},focusItemTop(){ki(Co.get(),(t=>ii(t)))},focusSetNext(){let t=Co.get(),e=To.next(t);e&&e!==t&&ii(e)},focusSetPrev(){let t=Co.get(),e=To.prev(t);e&&e!==t&&ii(e)},focusPick2(){let t=Co.get();t&&No.cando(t)&&ri(new Uo(null),new Lo(t),new Uo(t))},click(e,n){let r=Co.get(),l=e.data;if(Mi(n,N.Keys.elemFocus))return ii(l);if(Mi(n,N.Keys.acrossSelect)){let e=Gi(r,l),n=e&&((o=r)===(i=e)?[]:[o,...t.next(o,i,!0)?t.nextUntil(o,i):t.prevUntil(o,i),i]);return e&&n.length&&ri(new zo(ai,n,r),new Uo(e))}var o,i;if(Mi(n,N.Keys.smartSelect)){let t=Gi(r,l);return t&&ri(...di(t,"turn"))}if(Mi(n,N.Keys.parentFocus)){let t=Xi(l);return t&&ii(t)}if(Mi(n,N.Keys.parentSelect)){let t=Xi(l);return t&&ri(...di(t,"turn"))}if(Mi(n,N.Keys.turnSelect))return ri(...di(l,"turn"));Mi(n,N.Keys.onlyParent)&&(l=Xi(l)),To.has(l)&&r===l&&1===To.size||ri(...di(l,"only"))},__click:1,pathTo(e,n){if(t.intoView(e.data,0),!Mi(n,N.Keys.elemFocus))return Mi(n,N.Keys.turnSelect)?ri(...di(e.data,"turn")):void(To.has(e.data)||ri(...di(e.data,"add")));Co.set(e.data)},__pathTo:1,turn(){let t=Co.get();t&&ri(...di(t,"turn"))},only(){let t=Co.get();!t||1===To.size&&To.first()===t||ri(...di(t,"only"))},reverse(){let t=Co.get();t&&ri(new zo(gi,t))},siblings(){let e=Co.get();if(!e)return;let n=t.siblings(e);n.length&&ri(new zo(ai,n,e))},tagsame(){let e=Co.get();if(!e)return;let n=t.siblings(e,e.tagName);n.length&&ri(new zo(ai,n,e))},tagsame2(){let e=Co.get();if(!e)return;let n=t.find(`>* >${e.tagName}`,e.parentElement.parentElement);n.splice(n.indexOf(e),1),n.length&&ri(new zo(ui,n,e))},tagsame2x(){let e=Co.get();if(!e)return;let n=e.parentElement,r=null;if("TR"===n.tagName){let t=n.parentElement;r=Wi(e,wn(t.parentElement),t)}else r=t.find(">* >"+`${(l=e).tagName}:nth-child(${t.prevAll(l).length+1})`,n.parentElement);var l;r.splice(r.indexOf(e),1),r.length&&ri(new zo(ui,r,e))},cleanSiblings(){let e=Co.get();if(!e||1===To.size&&To.has(e))return;let n=t.children(e.parentElement).filter((t=>To.has(t)));ri(new zo(jo.removes,n),new zo(di,e,"add"))},cleanOthers(){let t=Co.get();!t||1===To.size&&To.has(t)||ri(new zo(jo.empty),new zo(di,t,"safeAdd"))},contentBoxes(){let t=Co.get();if(!t)return;let e=vn(t);e.some((t=>!To.has(t)))&&ri(new zo(ci,e,"adds"),new Uo(e[0]))},contentBoxesStart(){let t=Co.get();if(!t)return;let e=vn(t);e.some((t=>!To.has(t)))&&ri(new zo(ci,e,"unshift"),new Uo(e[0]))},previous(t){Ni(Co.get(),t,((t,e)=>ri(new zo(ai,t,e),new Uo(Ts(t)))))},next(t){Si(Co.get(),t,((t,e)=>ri(new zo(ai,t,e),new Uo(Ts(t)))))},parent:t=>$i(Co.get(),t,(t=>To.has(t)||ri(...di(t,"add")))),child:t=>Ai(Co.get(),t,(t=>To.has(t)||ri(new zo(fi,t,"safeAdd",!0),new Uo(t)))),itemTop(){ki(Co.get(),(t=>To.has(t)||ri(...di(t,"add"))))},onlyPrevious(t){Ni(Co.get(),t,(t=>ri(...di(Ts(t),"only"))))},onlyNext(t){Si(Co.get(),t,(t=>ri(...di(Ts(t),"only"))))},onlyParent(t){$i(Co.get(),t,(t=>ri(...di(t,"only"))))},onlyChild(t){Ai(Co.get(),t,(t=>ri(...di(t,"only"))))},onlyItemTop(){ki(Co.get(),(t=>ri(...di(t,"only"))))},siblingsVF(){qi(To),ri(new zo(pi,To,(e=>t.siblings(e))))},tagsameVF(){qi(To),ri(new zo(pi,To,(e=>t.find(`>${e.tagName}`,e.parentElement))))},previousVF(e){qi(To),e=isNaN(e)?1:e,ri(new zo(pi,To,(n=>t.prevAll(n,((t,n)=>n<=e)))))},nextVF(e){qi(To),e=isNaN(e)?1:e,ri(new zo(pi,To,(n=>t.nextAll(n,((t,n)=>n<=e)))))},contentBoxesVF(){let t=[...To].map((t=>vn(t))).flat();Oi(To,t)||ri(new zo(hi,t),new Uo(t[0]))},childVF(e){e=e||0;let n=t.map(To,(n=>t.children(n,e)));Oi(To,n)||ri(new zo(hi,n),new Uo(n[0]))},parentVF(t){let e=new Set;for(const n of To)$i(n,t,(t=>e.add(t)));e=[...e],Oi(To,e)||ri(new zo(mi,e),new Uo(e[0]))},itemTopVF(){let t=new Set;for(const e of To)ki(e,(e=>t.add(e)));t=[...t],Oi(To,t)||ri(new zo(mi,t),new Uo(t[0]))},selectSort(){let e=t(To).sort().item();e.length<2||ri(new zo(hi,e),new Uo(e[0]))||Ss(E.sortCompleted)},selectReverse(){let e=t(To).sort().item().reverse();e.length<2||ri(new zo(hi,e),new Uo(e[0]))||Ss(E.sortCompleted)},toText(){let e=t(To);if(0!==e.length&&function(t){for(const e of t)if(e.childElementCount>0)return!0;return!1}(e))return e.every(Qi)?void ri(vi(e),new Oo(Bo.toText,e)):Cs("need_conelem",function(t){for(const e of t)if(!Qi(e))return e}(e))},__toText:null,unWrap(){let e=t(To);if(0!==e.length)return e.every(Zi)?void ri(vi(e,!0),_i(),new Oo(Bo.unWrap,e)):Cs("both_conelem",function(t){for(const e of t)if(!Zi(e))return e}(e))},__unWrap:null,deletes(){let e=t(To),n=yi(e,!0);return n&&ri(vi(e,!0),_i(),n),!!n},deleteForce(){let e=t(To),n=yi(e);n&&ri(vi(e,!0),_i(),n)},deleteContents(){let e=t(To).map((t=>vn(t))).flat(),n=function(e){if(0!==e.length)return new Oo((()=>t(e).empty()))}(e);n&&ri(_i(),vi(e),n,wi(e))},elementCloneSelf(e){let n=t(To);if(!n.length)return;if(n.some(_n))return Cs("only_child",Vi(n));let r=n.map((t=>Pi(t)));1===r.length&&(r=[ji(r[0],e)]),ri(new Uo,vi(n,!0),_i(),new Oo(Bo.cloneAfter,n,r),wi(r.flat()))},elementCloneTeam(e){let n=t(To);if(!n.length)return;if(n.some(_n))return Cs("only_child",Vi(n));let r=function(t){let e=[t.shift()],n=[e];for(const r of t)r.previousElementSibling===Ts(e)?e.push(r):n.push(e=[r]);return n}(n.sort()),l=r.map((t=>Ts(t))),o=r.map((t=>t.map((t=>Pi(t)))));1===o.length&&1===o[0].length&&(o[0]=ji(o[0][0],e)),ri(new Uo,_i(),new Oo(Bo.cloneAfter,l,o),wi(o.flat()))},toUpperCase(){if(!To.size)return;let e=t(To).textNodes(!0,!0).flat();e.length&&ri(new Io(e,(t=>t.toUpperCase())))},toUpperCase1(){if(!To.size)return;let e=t(To).textNodes(!0,!0).map((t=>t[0]));e.length&&ri(new Io(e,(t=>t.replace(/[a-z]/,(t=>t.toUpperCase())))))},toLowerCase(){if(!To.size)return;let e=t(To).textNodes(!0,!0).flat();e.length&&ri(new Io(e,(t=>t.toLowerCase())))},elementFill(){let e=Co.get();if(!e||!To.size)return;if(To.has(e))return Cs("cannot_selected",e);let n=xi(t(To),e,null,!0);n&&ri(...n)},elementCloneFill(){let e=Co.get();if(!e||!To.size)return;if(1===To.size&&To.has(e))return;let n=Ei(t(To).clone(),e,null,!0);n&&ri(...n)},elementAppend(){let e=Co.get();if(!e||!To.size)return;if(To.has(e))return Cs("cannot_selected",e);let n=xi(t(To),e);n&&ri(...n)},elementCloneAppend(){let e=Co.get();if(!e||!To.size)return;let n=Ei(t(To).clone(),e);n&&ri(...n)},elementBefore(){let e=Co.get();if(!e||!To.size)return;if(To.has(e))return Cs("cannot_selected",e);let n=xi(t(To),e.parentElement,e);n&&ri(...n)},elementCloneBefore(){let e=Co.get();if(!e||!To.size)return;let n=Ei(t(To).clone(),e.parentElement,e);n&&ri(...n)},elementAfter(){let e=Co.get();if(!e||!To.size)return;if(To.has(e))return Cs("cannot_selected",e);let n=xi(t(To),e.parentElement,t.nextNode(e));n&&ri(...n)},elementCloneAfter(){let e=Co.get();if(!e||!To.size)return;let n=Ei(t(To).clone(),e.parentElement,t.nextNode(e));n&&ri(...n)},movePrevious(e){let n=t(To).sort(),r=n[0];if(!((e=isNaN(e)?1:e)<0||!n.length||function(e){let n=t.prevNode(e,!1,!0);return!n||pn(n)}(r)))return n.some(hn)?Cs("has_fixed2",function(t){for(const e of t)if(hn(e))return e}(n)):void ri(new Oo(Bo.movePrev,Fi(n),e))},moveNext(e){let n=t(To).sort(),r=Ts(n);if(!((e=isNaN(e)?1:e)<0||!n.length||function(e){let n=t.nextNode(e,!1,!0);return!n||hn(n)}(r)))return n.some(pn)?Cs("has_fixed1",function(t){for(const e of t)if(pn(e))return e}(n)):void ri(new Oo(Bo.moveNext,Fi(n),e))},indentReduce(){let e=t(To);if(e.length)return Fs(e)?void ri(new Oo(Bo.sectionsUp,e)):Cs("only_section",Ki(e))},indentIncrease(){let e=t(To);if(!e.length)return;if(!Ps(e))return Cs("only_section",Ki(e));let n=function(t){let e=[];for(const n of t){let t=rn(n);e.push([n,Rr(t,{h2:E.sectionH2})])}return!!e.length&&e}(e);ri(new Oo(Bo.sectionsDown,n))},reversePlaces(){let e=t(To).sort(),n=Fi(e);if(!(e.length<2||n.every((t=>t.length<2))))return e.some(mn)?Cs("has_fixed",function(t){for(const e of t)if(mn(e))return e}(e)):void ri(new Oo(Bo.reverses,n))},contentsMerge(){let e=t(To),n=e.shift();if(!e.length)return;let r=Ys(n,e);if(!r)return Cs("merge_types",Zs(n,e));ri(vi(e,!0),_i(),new Oo(Bo.merges,n,r,e),...di(n,"safeAdd"))},normalize(){let e=new Oo((()=>t.normalize(Vo)));e.changed()&&ri(e)},moveToLeft(){let t=[...To],e=Ri(t,"left",-1);e&&ri(e,Ii(t,"right"),new Do(!0))},moveToLeftTen(){let t=[...To],e=Ri(t,"left",-10);e&&ri(e,Ii(t,"right"),new Do(!0))},moveToRight(){let t=[...To],e=Ri(t,"left",1);e&&ri(e,Ii(t,"right"),new Do(!0))},moveToRightTen(){let t=[...To],e=Ri(t,"left",10);e&&ri(e,Ii(t,"right"),new Do(!0))},moveToUp(){let t=[...To],e=Ri(t,"top",-1);e&&ri(e,Ii(t,"bottom"),new Do(!0))},moveToUpTen(){let t=[...To],e=Ri(t,"top",-10);e&&ri(e,Ii(t,"bottom"),new Do(!0))},moveToDown(){let t=[...To],e=Ri(t,"top",1);e&&ri(e,Ii(t,"bottom"),new Do(!0))},moveToDownTen(){let t=[...To],e=Ri(t,"top",10);e&&ri(e,Ii(t,"bottom"),new Do(!0))},paste(t,e){let n=[...To].map((t=>vn(t))),r=n.flat(),l=e?"appends":"fills";r.length&&ri(vi(r),...function(t,e,n){return 1===t.length?[bi(t[0],e.join("\n"),n)]:(1===e.length&&(e=new Array(t.length).fill(e[0])),t.map(((t,r)=>bi(t,e[r],n))))}(n,t.data,l))},__paste:1,setStyle(e,n,r){(function(e,n,r){return t.isArray(n)?e.some((t=>n.some((e=>t.style[e]!==r)))):e.some((t=>t.style[n]!==r))})(e.data,n,r)&&ri(new Oo(Bo.styles,e.data,n,r),new Do)},__setStyle:1,eraseStyle(t,e){let n=null;e=e.split(co);for(const r of t.data)if(ms(r,e)){n=!0;break}n&&ri(new Oo(Bo.styles,t.data,e,null),new Do)},__eraseStyle:1,brushStyle(e){let n=e.data,r=t.attr(n,"style"),l=To.size,o=null;!r||!l||1===l&&To.has(n)||(To.has(n)&&(o=new zo(jo.delete,n)),ri(o,new Oo(Bo.attrs,[...To],"style",r),new Do))},__brushStyle:1,clearStyle(e){let n=null;for(const r of e.data)if(null!==t.attr(r,"style")){n=!0;break}n&&ri(new Oo(Bo.styles,e.data,null),new Do)},__clearStyle:1,attrUpdate(t,e){1===To.size&&ri(new Oo(Bo.attrs,[...To],e,t.data),new Do)},__attrUpdate:1,deleteAttr(t){ri(new Oo(Bo.attrs,[...To],t.data,null),new Do)},__deleteAttr:1,htmlUpdate(e){if(1!==To.size||!e.data.length)return;let n=[...To],r=function(e){let n=t.fragment(e);for(const e of t.find(ao,n))t.removeClass(e,so);return t.contents(n)}(e.data);ri(vi(n,!0),_i(),new Oo((()=>t.replace(n[0],r))))},__htmlUpdate:1,runScript(e,n,r,l){let o=e.data.trim();if(!o)return null;if("editor"===n){let e=new Ro(ps,o,t(To));return e.changed()&&(e.warn(E.undoWarn),ri(e)),e.result()||el(o)||null}return function(t){let e=zn.pick();return new Promise(((n,r)=>{e.onmessage=t=>{e.onmessage=null,zn.add(e),t.data.error?r(t.data.error):n(t.data.result)},e.postMessage(t)}))}(ds(To,{code:o},r,l)).then((t=>({type:"value",data:t,code:o}))).catch((t=>({type:"error",data:t,code:""})))},__runScript:1,insResult(e,n,r){let l=e.data.trim(),o=[...To];if(!o.length||!r||!l)return;let i=function(t,e){for(const n of t)if(!es(n,e))return n;return null}(o,r);if(i)return Cs("cannot_append",i);let s=function(e,n){switch(e){case"text":return t(t.Text(n,!0));case"html":return t(t.fragment(n).children)}throw new Error("can't to here.")}(n,l),a=_i(),u=o.map((t=>function(t,e,n){return Ci(...{prepend:[null,t],append:[null,t],fill:[null,t],before:[t,t.parentElement],after:[t,t.parentElement],replace:[t,t.parentElement]}[e],n)}(t,r,s.clone())));ri(new Uo,a,new Oo(Bo.alignInsert,o,r,u))},__insResult:1,propUpdate(e,...n){let r=[...To],l=(o=rn(r[0]),pl[o]||((e,n,r)=>t.attr(e,n,r)));var o;if(1===r.length)return ri(new Oo(l,r[0],e.data,...function(t,...e){let n=hl[rn(t)];return n?n(t,...e):function(t){return t.map((t=>""===t?null:t))}(e)}(r[0],...n)),new Do(!0));let i=function(t,...e){let n=rn(t[0]),r=ml[n];return r?r(t,...e):Cl(t,function(t){return t.map((t=>""===t||null===t?void 0:t))}(e))}(r,...n);ri(...r.map(((t,n)=>new Oo(l,t,e.data,...i[n]))))},__propUpdate:1,cmdRun(e,n){let r=e.data,l=r.trim()&&ks[n](As[n],r);return oo(n).add(e.data),t.isArray(l)?(ls(Vo,"focus.content",1,null,!0),ri(...l)||null):l},__cmdRun:1,pluginsRun(e){let l=(i=e.data,zl.get(i)||null),o=t.attr(e.data,"title")||"";var i;if(!l)throw new Error("not found the plugins.");return function(t,e){let n=new Worker(t);return new Promise(((t,r)=>{n.onmessage=e=>{n.terminate(),e.data.error?r(e.data.error):t(e.data)},n.postMessage(e)}))}(`${y}${b.plugRoot}/${l}/${b.plugMain}`,ds(To,{INFO:{}},!0,!0)).then((t=>function(t,e,l){let o=n.get(e);return l=t.title||l,t.node&&!t.error?[t.result,o.node(t.node),l]:(o=n.get(r),[t.error||t.result,o.node(b.plugResult),l])}(t,l,o)))},__pluginsRun:1,editUndo(){t.trigger(Vo,_.undoEvent,ei?(document.execCommand("undo"),document.queryCommandEnabled("undo")):(Ko.undo(),Ko.canUndo()),!0)},editRedo(){t.trigger(Vo,_.redoEvent,ei?(document.execCommand("redo"),document.queryCommandEnabled("redo")):(Ko.redo(),Ko.canRedo()),!0)},miniedIn(){let t=To.first();if(t){if(!dn(t))return ii(t),Cs("need_conelem",t);ri(...Li(t)),ei.active()}},miniedInEnd(){let t=To.first();if(t){if(!dn(t))return ii(t),Cs("need_conelem",t);ri(...Li(t)),ei.activeEnd()}},properties(){let e=t(To),l=Bs(e);if(!l)return Cs("not_property",e[0]);!function(e){n.get(r).get(_.modalProp).then((n=>t.trigger(Qo,"open",[e,n])))}(l)},elementRange(){let e=[...To];if(!js(e))return Cs("not_elrange",e[0]);t.select(e[0],!0),ls(e[0],"_mouseup",10,null,!0)}},ea={undo(){ta.editUndo()},redo(){ta.editRedo()},sels:()=>t(To),esize:()=>To.size,sel0:()=>Es(To)||null,efocus:()=>Co.get(),tobj:()=>To.size?wn(function(t){switch(t.tagName){case"TR":return t.parentElement.parentElement;case"TBODY":case"THEAD":case"TFOOT":case"CAPTION":return t.parentElement;case"TH":case"TD":return t.parentElement.parentElement.parentElement;case"TABLE":return t}throw new Error("not in table element.")}(To.first())):null,trbox(){let t=To.first();return"TR"===t.tagName?t.parentElement:t},tsecbox(){let t=To.first();return"TABLE"===t.tagName?t:t.parentElement},codebox(){let t=To.first();if(!t)return null;switch(rn(t)){case 526:return t.firstElementChild;case lt:case ee:return t;case Ht:return t.parentElement}throw new Error("bad type of element.")},attrns:t=>[...t.data.attributes].map((t=>t.name)),__attrns:1,obtname(e){let n=e.data,r=t=>Eo.has(t)?xo:t.replace(co,"");return t.isArray(n)?[...new Set(n.map(r))]:r(n)},__obtname:1,obtsplit:t=>(ko.reset(),t.data.map((t=>t?[...ko.split(t)].map((t=>t.trim())):[]))),__obtsplit:1,obtval:t=>function([t,e,n]){return e.length=bs(e),n.length=bs(n),t.length=Math.max(bs(t),e.length,n.length),[t,e,n]}(t.data.map((t=>t.map(ys).map((t=>t||"-"))))).map((t=>t.join(";\n")||null)),__obtval:1,source:t=>oi(t.data),__source:1,rngok(t){let e=rn(as(t.data));return t.data.detach(),Ie(e)&&e!==lt||425===e},__rngok:1,menupos(e,n,[r,l]){let o=t.outerWidth(e.data),i=t.offset(n),s=t.innerWidth(n),a=l-i.top+t.scrollTop(n)+w.popupGapTop;return r+o<s+i.left?[r-i.left+"px",`${a}px`]:[s-o-w.popupGapRight+"px",`${a}px`]},__menupos:1,submenu(e){let n=t.parent(e.data),r=t.outerWidth(n)-1+"px",l=t.children(e.data,-1),o=parseFloat(t.css(n,"right"));return t.outerWidth(l)>o?{left:"auto",right:r}:{left:r,right:"auto"}},__submenu:1,convtype(){let t=new Set;for(const e of To)t.add(Ir(e));if(t.size>1)return null;let e=Es(t);return e===_.convLines?_.convBlocks:e},__convtype:null,roleinfo(e,n){let r=t.attr(e.data,"role");return r?`${n}:${r}`:n},__roleinfo:1,elemSelf(t){let e=t.data;return e?us(e).replace(go,""):null},__elemSelf:1,cmable(e){let n=[...To];return 0===n.length?[]:t.map(Ks,((t,r)=>t(n)?e.data[r]:null))},__cmable:1,inlable(e,n,r){let l=[...r.cloneContents().childNodes];return 0===l.length?[]:e.data.filter((e=>function(t,e,n){"a"===t&&425===rn(n)&&(t="fcona");let r=Rr(t),l=rn(r,n),o=sn(l);return e.every((t=>o.has(rn(t,r))))&&on(n,l)}(t.attr(e,n),l,as(r))))},__inlable:1,inslist(t,e){if(!t.data.length)return null;let l=yo[e](t.data),o=n.get(r);return l.length?l.map((t=>o.node(t))):null},__inslist:1,ismixed:t=>(t.data===_.levelName1?[...rs(To)]:[...To]).some((t=>mo.test(t.tagName)&&3===De(t))),__ismixed:1,pretreat2(t,e,n){let r=t.data;return r=n?r.trim().split(fo):[r],e?r.map((t=>t.trim().replace(po,"$1"))):r},__pretreat2:1,pretreat1(e,n){let r=e.data;return t.isArray(r)?n?r.map((t=>t.replace(po,"$1"))):r:n?r.trim().replace(po,"$1"):r},__pretreat1:1,splitx:(t,e)=>t.data.trim().split(e?fo:ho),__splitx:1,k3edit(e,n,r,l,o){let i=tr(r,!0,e.data),s=l&&+t.val(l);switch(n){case"Enter":return`\n${a=i,a.substring(0,Qn(a,1/0))||" "}`;case"Tab":return function(t,e){return e>0?" ".repeat(e-Zn(t)%e):"\t"}(i,s)}var a;return s>0&&!r.toString()&&i.endsWith(" ".repeat(s))&&(o&&(s=i.length),r.setStart(r.endContainer,r.endOffset-s),r.setEnd(r.endContainer,r.endOffset)),null},__k3edit:1,indentcut(t,e){if(e)return t.data;let n=t.data.split(ho).filter((t=>!!t)),r=function(t){let e=1/0;for(const n of t)if(e=Qn(n,e),!e)return 0;return e}(n);return r?n.map((t=>t.substring(r))).join("\n"):t.data},__indentcut:1,hlcode:(t,e,n)=>er(t.data.split(ho),n,e),__hlcode:1,codels:t=>cl(null,t.data,ul),__codels:1,codeblo:(t,{lang:e})=>cl(e,t.data,al),__codeblo:1,image3:(e,n)=>"svg"===n?t.svg({html:e.data}):Mn(e.data).then((t=>Rr(P,function(t){let[e,n]=t;return"string"!=typeof e&&([n,e]=[e,n]),Object.assign({src:e},n)}(t)))),__image3:1,mediasubs(t,e){let n=ss(t.data.trim(),B);return void 0===e?n:Promise.all([n,ss(e.trim(),j)])},__mediasubs:1,picsubs:t=>ss(t.data.trim(),K),__picsubs:1,cbstate(t,e,n){if(!t.data.length)return null;let r=t.data[0].style[e]===n;for(const l of t.data.slice(1)){if(l.style[e]===n!==r)return[!1,!0]}return[r,!1]},__cbstate:1,styVal:(e,n)=>e.data.length?t.isArray(n)?n.map((t=>gs(e.data,t))):gs(e.data,n):null,__styVal:1,unitVal(t){let e=t.data[0].value,n=t.data[1].value;return isNaN(parseFloat(e)-e)?e:e+n},__unitVal:1,styName:(t,e)=>t.data.length?e.split(co).filter((e=>function(t,e){return t.every((t=>""!==t.style[e]))}(t.data,e))):null,__styName:1,styKey:(t,e)=>t.data.length?e.split(co).filter((e=>function(t,e){return e+=":",t.every((t=>t.style.cssText.includes(e)))}(t.data,e))):null,__styKey:1,cleanHTML:t=>cs(t.data),__cleanHTML:1,mdline:e=>T.mdline&&e.data?t.isArray(e.data)?e.data.map((e=>t.fragment(Kn(e)))):t.fragment(Kn(e.data)):e.data,__mdline:1,cmdclear(){this.cmdNavTemp=null},ecancel(){(To.size||Co.get())&&ri(new Uo(null),new zo(jo.empty))},puthtml(e){let n=t.fragment(e.data);ri(new Uo(null),_i(),new Oo((e=>t.fill(Vo,e)),[...n.childNodes]))},__puthtml:1,heading(e){if(Vo.childElementCount>0)return;ri(new Oo((e=>t.prepend(Vo,e)),t.elem("h1",e.data)))},__heading:1,errmsg(t,e){Mi(e,N.Keys.elemFocus)&&ii(t.data)},__errmsg:1,chapter(e){let n=t.get(e.data.map((t=>`>section:nth-of-type(${+t})`)).join(" ")+" >h2",t.get("article",Vo));n&&t.intoView(n,1,1)},__chapter:1,save(e){let n=t(e.data.children).map(cs).join("");return _.saver(n)||Ao.set(_.storeMain,n),E.localStoreDone},__save:1,export:e=>(e.data.length?e.data:t.children(Vo)).map(cs).join(""),__export:1,export2(e){let n=fs(Vo),r=t.get("article",n);return Hs(507,Rr(507,{h4:e.data},r),n),t.html(n)},__export2:1,nicehtml(e,n,r){let l=isNaN(n)?"\t":" ".repeat(n),o=[...t.fragment(e.data).children];try{return o.map((t=>Bn(t,r,l))).join("").trim()}catch(e){t.trigger(t.get(`#${b.sourceTips}`),"show")}},__nicehtml:1,blankline(t,e,n){if(!e)return;let r=tr(n,!0,t.data);r.length>1||" "!==r[0]||(n.setStart(n.endContainer,n.endOffset-1),n.setEnd(n.endContainer,n.endOffset))},__blankline:1,toclist:e=>wr(t.find(">section",e.data)),__toclist:1,medpass(e,n){let r=function(){ei.done();let e=ei.elem();return li(),"H2"===e.tagName&&t.trigger(Jo,_.medOk,e),t.trigger(Vo,_.medOk,null,!0),t.trigger(Yo,"show"),t.trigger(Zo,_.insType,_.normalTpl),ls(ti,_.evnFollow),ei=null,e}();if("Tab"===e.data)return ta.miniedIn();let l=Di(n,r);l&&(ri(...l),ei.active())},__medpass:1,medcancel(){Ko.pop(),li(),ei=null,t.trigger(Yo,"show"),t.trigger(Zo,_.insType,_.normalTpl)},__medcancel:null,rngelem(t,e){"a"===e&&425===rn(as(t.data))&&(e="fcona");let n=_i(),r=new Uo(null),l=new Ho(t.data,e),o=l.elem();ri(n,r,l,new zo(fi,o,"safeAdd"),new Uo(o)),function(t,e){return bo.has(t)&&!e.completed()}(e,l)&&ta.properties()},__rngelem:1,cmenudo(t){let e=vo[t.data];e&&ta[e]()},__cmenudo:1,convert(t){if(!To.size)return;let e=[...To],n=vi(e,!0),r=_i(),[l,o]=Is(t.data,e);ri(n,r,l,wi(o)),bo.has(t.data)&&ta.properties()},__convert:1,croptr(e,n){if(n<=0)return;let r=e.data,l=n-r.rows.length;l&&function(e,n,r){if(n<0)return e.removes(n,null,r);e.inserts(n,null,r).map((t=>[...t.children])).flat().forEach((e=>t.attr(e,"contenteditable",!0)))}(t.table(r.parentElement),l,r)},__croptr:1,colcrop(e,n){if(n<=0)return;let r=t.table(e.data),l=n-r.cols()+1;l&&function(e,n){if(n<0)for(;n++<0;)e.removeColumn(-1);else(function(t,e){let n=[];for(;e-- >0;)n.push(t.insertColumn(t.newColumn()));return n})(e,n).flat().forEach((e=>t.attr(e,"contenteditable",!0)))}(r,l)},__colcrop:1,inserts(e,n,r){let l=[...To],o=function(e,n){if(n<2)return[e];if(e.length>1)return e;let r=e[0];for(let l=0;l<n-1;l++)e.push(t.clone(r));return e}(t(e.data),l.length),i=_i(),s=function(t,e,n,r){return t.map(((t,l)=>null!=e[l]&&new Oo(Hi[r][+n],t,e[l])))}(l,o,n,r),a=o.flat().filter((t=>1===t.nodeType&&!cn(t)));ri(i,...s,wi(a),a[0]&&new Uo(a[0]))},__inserts:1,topinsert(t,e){let n=To.first(),r=e===_.levelName1?n.parentElement:n;ri(_i(),Ds(r,t.data,zs),...di(t.data,"safeAdd"))},__topinsert:1,fixinsert(e,n){let r=n===_.levelName1?[...rs(To)]:[...To],l=function(e,n){if(e=xs(e),n<2||e.length>1)return e;let r=e[0];for(let l=0;l<n-1;l++)e.push(t.clone(r));return e}(e.data,r.length);ri(vi(r),_i(),...function(t,e){let n=[];return t.forEach(((t,r)=>null!=e[r]&&n.push(Ds(t,e[r],Ls)))),n}(r,l),wi(l),new Uo(l[0]))},__fixinsert:1,instbody(e,n,r){let l=e.data,o=To.first(),i=r===_.levelName1?o.parentElement:o,s=wn(i),a=vi([i]),u=_i(),c=null;n?("TBODY"!==o.tagName&&(o=s.body(!0)),c=new Oo(Bo.newAppend,o,t.children(l)),l=null):("TBODY"!==o.tagName&&(o=t.get("tbody:last-of-type",i)),c=new Oo(Bo.newAfter,o,l)),ri(a,u,c,...di(l||o,"safeAdd"))},__instbody:1,table(t,e,[n,r,l,o]){let i=t.data,s=l?"":":not(:first-child)",a=l?"th,td":"td",u=is(r&&i.tHead,`th${s}`),c=is(i.tBodies[0],a),f=is(o&&i.tFoot,a);return Rr("table",{cols:c[0].length-!!l,border:n,caption:e,th0:l=!!l,head:u,foot:f},c,!0)},__table:1,codelang(e,n,r){let l=e.data;if(n===t.attr(r,"-lang"))return l;for(const e of l)t.attr(e,"-lang")||t.attr(e,"-lang",n);return l},__codelang:1,checkhtml(e,n){let r=t.fragment(n),l=_s(e.data.parentElement,t.contents(r));return l?l.map(ws):null},__checkhtml:1,attrlist(e,n){let r=new Set(n);for(const n of e.data){let e=t.prop(n,"value");r.has(e)?r.delete(e):t.remove(n)}return[...r]},__attrlist:1,obtline(e,n,r,l){let o=t.siblingNth(e.data);return o<n.length&&n.splice(o,0,""),o<r.length&&r.splice(o,0,""),o<l.length&&l.splice(o,0,""),t.prop(t.clone(e.data),"text",null)},__obtline:1,obtdel(e,n,r,l){let o=t.siblingNth(e.data)-1;return n.splice(o,1),r.splice(o,1),l.splice(o,1),e.data},__obtdel:1,obtswap(e,n,[r,l,o]){let i=e.data;return"ArrowUp"===n?function(e,n,r,l){let o=t.prev(e);return o?(vs(t.siblingNth(o),n,r,l),[o,"after"]):null}(i,r,l,o):function(e,n,r,l){let o=t.next(e);return o?(vs(t.siblingNth(e),n,r,l),[o,"before"]):null}(i,r,l,o)},__obtswap:1,cmdlast(e,n,r){let l=n.selectionStart,o=oo(e.data).find(n.value.substring(0,l));this.cmdNavTemp=new Zl(o);let i=r?this.cmdNavTemp.last():this.cmdNavTemp.first();i&&t.val(n,i).setSelectionRange(l,i.length)},__cmdlast:1,cmdnext(e){let n=e.data,r=n.selectionStart,l=this.cmdNavTemp&&this.cmdNavTemp.next();l&&t.val(n,l).setSelectionRange(r,l.length)},__cmdnext:1,cmdprev(e){let n=e.data,r=n.selectionStart,l=this.cmdNavTemp&&this.cmdNavTemp.prev();l&&t.val(n,l).setSelectionRange(r,l.length)},__cmdprev:1,cmdNavTemp:null};
//! $ID: api.js 2021.10.21 Cooljed.Base $
let na;s(g,"Ed",ta,["click","pathTo","toText","unWrap","setStyle","eraseStyle","brushStyle","clearStyle","attrUpdate","deleteAttr","htmlUpdate","runScript","insResult","propUpdate","cmdRun","pluginsRun","deletes","paste"]),s(g,"Kit",ea,["ecancel","puthtml","heading","errmsg","chapter","save","export","export2","nicehtml","blankline","toclist","medpass","medcancel","rngelem","cmenudo","convert","croptr","colcrop","inserts","topinsert","fixinsert","instbody","table","codelang","checkhtml","attrlist","obtline","obtdel","obtswap","cmdlast","cmdnext","cmdprev"]),a(v,null,ea,["sels","esize","sel0","efocus","elemSelf","tobj","trbox","tsecbox","codebox","attrns","obtname","obtsplit","obtval","source","rngok","menupos","submenu","convtype","roleinfo","cmable","inlable","inslist","ismixed","pretreat2","pretreat1","splitx","k3edit","indentcut","hlcode","codels","codeblo","image3","mediasubs","picsubs","cbstate","styVal","unitVal","styName","styKey","cleanHTML","mdline","cmdclear"]),a(v,"focusPick",ta.focusPick2),window.ESet=To,window.History=Ko;const ra={init(t){na=t},heading(e){let n=t.get("h1",na);if(void 0===e)return n&&t.html(n);Ms(),n||(n=t.prepend(t.get("hgroup",na)||na,t.elem("h1"))),t.html(n,e)},subtitle(e,n){let r=t.get("hgroup",na),l=r?t.find(">h3",r):[];if(void 0===e)return l.map((e=>t.html(e)));Ms(),r||(r=t.prepend(na,t.elem("hgroup"))),n||l.forEach((e=>t.remove(e))),t.append(r,t(la(e)).Element("h3"))},abstract(e,n){let r=t.get(">header[role=abstract]",na);if(void 0===e&&void 0===n)return r&&oa(r);Ms(),ia(e,n,r,qt)},article(e){let n=t.get("article",na);if(void 0===e)return n&&t.html(n);Ms(),Hs(512,t.Element("article",e))},seealso(e,n){let r=t.get(">aside[role=seealso]",na);if(void 0===e&&void 0===n)return r&&sa(r,"ul");Ms(),aa(e,n,r,"ul",509)},reference(e,n){let r=t.get(">nav[role=reference]",na);if(void 0===e&&void 0===n)return r&&sa(r,"ol");Ms(),aa(e,n,r,"ol",508)},footer(e,n){let r=t.get(">footer",na);if(void 0===e&&void 0===n)return r&&oa(r);Ms(),ia(e,n,r,Yt)},content(e){if(void 0===e)return t.html(na);Ms(),t.html(na,e)},toc:(e=E.tocLabel)=>Rr(507,{h4:e},t.get("article",na)).outerHTML,theme(e){let n=t.get(`#${b.styleTheme}`);return void 0===e?n.href:ua(n,e)},style(e){let n=t.get(`#${b.styleMain}`);return void 0===e?n.href:ua(n,e)},codes(e){let n=t.get(`#${b.styleCodes}`);return void 0===e?n.href:ua(n,e)},savedhtml:function(){return Ao.get(_.storeMain)}};function la(e){return t.isArray(e)?e:[e]}function oa(e){let n=t.get("h4",e);return[n&&t.html(n),t(">*",e).not("h4").prop("outerHTML").join("")]}function ia(e,n,r,l){let o=r&&t.get("h4",r),i=r&&t(">*",r).not("h4");Hs(l,Rr(l,{h4:e||o&&t.text(o)},n?[...t.fragment(n).children]:i,!0))}function sa(e,n){let r=t.get("h4",e),l=t.get(`>${n}`,e);return[r&&t.html(r),l&&t.children(l).map((e=>t.html(e)))]}function aa(e,n,r,l,o){let i=r&&t.get("h4",r),s=r&&t.get(`>${l}`,r);n&&(s=t.elem(l),t.append(s,t(la(n)).wrap("<li>"))),Hs(o,Rr(o,{h4:e||i&&t.text(i)},s))}function ua(e,n){return t.style({id:e.id,href:n},e).then((()=>t.remove(e)))}
//! $ID: main.js 2019.11.16 Cooljed.User $
window.GHK=(new p).config(N.Global),window.SHK=(new p).config(N.Slave),window.DHK=(new p).config(N.Modal),window.CHK=new h(ta).config(N.Content),window.Sys=_,window.Kit=ea,window.KM=N.Keys,window.edInit=function(e,l,o,i,s,a,u,c,f,d,p){Vo=t.get(e),Wo=t.get(l),ti=t.get(o),Go=t.get(i),Xo=t.get(s),qo=t.get(a),Jo=t.get(u),Yo=t.get(c),Qo=t.get(f),Zo=t.get(d),ni=t.get(p),Object.assign(As,{[x.select]:new Gl(To,Vo),[x.filter]:new Xl(To),[x.search]:new ql(Vo),[x.command]:new Jl(To),[x.calcuate]:new Yl(To,Vo)}),lo(t.get("#x-help"),n.get(r).node(_.modalPlug)),t.on(Vo,"attrdone styledone nodesdone emptied detach normalize propdone",null,$o)},window.Api=ra,window.ESC=new $n,t.config({varyevent:!0}),f.init(v,g).config(l).then((t=>t.build(document))).then((()=>t.trigger(document.body,"finish"))).then((()=>ra.init(t.get("main.content")))).then((()=>_.contenter())).then((e=>null!=e&&t.html(t.get("main.content"),e))).then((()=>_.readyCall())).catch((t=>_.failCall(t))),o&&(window.On=v,window.By=g,window.Tpls=n.get(r));export{kl as PlugBy,Al as PlugOn};
